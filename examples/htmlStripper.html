<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="robots" content="index,nofollow">

<title>PythonDecoratorLibrary - Python Wiki</title>
<script type="text/javascript" src="/wiki/common/js/common.js"></script>

<script type="text/javascript">
<!--
var search_hint = "Search";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/wiki/europython/css/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="/wiki/europython/css/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="/wiki/europython/css/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="/wiki/europython/css/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/wiki/europython/css/msie.css">
<![endif]-->


<link rel="alternate" title="Python Wiki: PythonDecoratorLibrary" href="/moin/PythonDecoratorLibrary?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=PythonDecoratorLibrary&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="/moin/FrontPage">
<link rel="Alternate" title="Wiki Markup" href="/moin/PythonDecoratorLibrary?action=raw">
<link rel="Alternate" media="print" title="Print View" href="/moin/PythonDecoratorLibrary?action=print">
<link rel="Appendix" title="memoize.py" href="/moin/PythonDecoratorLibrary?action=AttachFile&amp;do=view&amp;target=memoize.py">
<link rel="Search" href="/moin/FindPage">
<link rel="Index" href="/moin/TitleIndex">
<link rel="Glossary" href="/moin/WordIndex">
<link rel="Help" href="/moin/HelpOnFormatting">
</head>

<body  lang="en" dir="ltr">

<div id="header">

<form id="searchform" method="get" action="/moin/PythonDecoratorLibrary">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput">Search:</label>
<input id="searchinput" type="text" name="value" value="" size="20"
    onfocus="searchFocus(this)" onblur="searchBlur(this)"
    onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search">
<input id="titlesearch" name="titlesearch" type="submit"
    value="Titles" alt="Search Titles">
<input id="fullsearch" name="fullsearch" type="submit"
    value="Text" alt="Search Full Text">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<div id="logo"><a href="/moin/FrontPage"></a><a href="http://www.python.org"><img src="/wiki/europython/img/python-logo.gif" alt="Python" ></a><a name="logo"></a></div>
<div id="locationline">


<ul id="pagelocation">
<li><a href="/moin/PythonDecoratorLibrary">PythonDecoratorLibrary</a></li>
</ul>

</div>

<ul id="pagetrail">
<li><a href="/moin/PythonDecoratorLibrary">PythonDecoratorLibrary</a></li>
</ul>
</div>

<div id="sidebar">
<div id="star">

</div>
<div class="sidepanel">

<ul id="navibar">
<li class="wikilink"><a href="/moin/FrontPage">FrontPage</a></li><li class="wikilink"><a href="/moin/RecentChanges">RecentChanges</a></li><li class="wikilink"><a href="/moin/FindPage">FindPage</a></li><li class="wikilink"><a href="/moin/HelpContents">HelpContents</a></li><li class="current"><a href="/moin/PythonDecoratorLibrary">PythonDecoratorLibrary</a></li>
</ul>

</div>
<div class="sidepanel">
<h1>Page</h1>
<ul class="editbar"><li><span class="disabled">Immutable Page</span></li><li class="toggleCommentsButton" style="display:none;"><a href="#" class="nbcomment" onClick="toggleComments();return false;">Comments</a></li><li><a class="nbinfo" href="/moin/PythonDecoratorLibrary?action=info" rel="nofollow">Info</a></li><li><a class="nbattachments" href="/moin/PythonDecoratorLibrary?action=AttachFile" rel="nofollow">Attachments</a></li><li>
<form class="actionsmenu" method="GET" action="/moin/PythonDecoratorLibrary">
<div>
    <label>More Actions:</label>
    <select name="action"
        onchange="if ((this.selectedIndex != 0) &&
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="raw">Raw Text</option>
<option value="print">Print View</option>
<option value="refresh">Delete Cache</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="SpellCheck">Check Spelling</option>
<option value="LikePages">Like Pages</option>
<option value="LocalSiteMap">Local Site Map</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="RenamePage" disabled class="disabled">Rename Page</option>
<option value="DeletePage" disabled class="disabled">Delete Page</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="show" disabled class="disabled">Remove Spam</option>
<option value="show" disabled class="disabled">Revert to this revision</option>
<option value="show" disabled class="disabled">------------------------</option>
<option value="SlideShow">SlideShow</option>
    </select>
    <input type="submit" value="Do">
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('More Actions:');
//-->
</script>
</form>
</li></ul>

</div>
<div class="sidepanel">
<h1>User</h1>
<ul id="username"><li><a href="/moin/PythonDecoratorLibrary?action=login" id="login" rel="nofollow">Login</a></li></ul>
</div>
</div>

<div id="page" lang="en" dir="ltr">
<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><p class="line867"><strong>This page is meant to be a central repository of decorator code pieces</strong>, whether useful or not &lt;wink&gt;. It is NOT a page to discuss decorator syntax! <span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><p class="line862">Feel free to add your suggestions. Please make sure example code conforms with <a class="http" href="http://www.python.org/dev/peps/pep-0008">PEP 8</a>. <span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><p class="line867"><div class="table-of-contents"><p class="table-of-contents-heading">Contents<ol><li>
<a href="#Creating_Well-Behaved_Decorators_.2F_.22Decorator_decorator.22">Creating Well-Behaved Decorators / &quot;Decorator decorator&quot;</a></li><li>
<a href="#Property_Definition">Property Definition</a></li><li>
<a href="#Memoize">Memoize</a></li><li>
<a href="#Alternate_memoize_as_nested_functions">Alternate memoize as nested functions</a></li><li>
<a href="#Alternate_memoize_as_dict_subclass">Alternate memoize as dict subclass</a></li><li>
<a href="#Alternate_memoize_that_stores_cache_between_executions">Alternate memoize that stores cache between executions</a></li><li>
<a href="#Cached_Properties">Cached Properties</a></li><li>
<a href="#Retry">Retry</a></li><li>
<a href="#Pseudo-currying">Pseudo-currying</a></li><li>
<a href="#Creating_decorator_with_optional_arguments">Creating decorator with optional arguments</a></li><li>
<a href="#Controllable_DIY_debug">Controllable DIY debug</a></li><li>
<a href="#Easy_adding_methods_to_a_class_instance">Easy adding methods to a class instance</a></li><li>
<a href="#Counting_function_calls">Counting function calls</a></li><li>
<a href="#Alternate_Counting_function_calls">Alternate Counting function calls</a></li><li>
<a href="#Generating_Deprecation_Warnings">Generating Deprecation Warnings</a></li><li>
<a href="#Smart_deprecation_warnings_.28with_valid_filenames.2C_line_numbers.2C_etc..29">Smart deprecation warnings (with valid filenames, line numbers, etc.)</a></li><li>
<a href="#Ignoring_Deprecation_Warnings">Ignoring Deprecation Warnings</a></li><li>
<a href="#Enable.2FDisable_Decorators">Enable/Disable Decorators</a></li><li>
<a href="#Easy_Dump_of_Function_Arguments">Easy Dump of Function Arguments</a></li><li>
<a href="#Pre-.2FPost-Conditions">Pre-/Post-Conditions</a></li><li>
<a href="#Profiling.2FCoverage_Analysis">Profiling/Coverage Analysis</a></li><li>
<a href="#Line_Tracing_Individual_Functions">Line Tracing Individual Functions</a></li><li>
<a href="#Synchronization">Synchronization</a></li><li>
<a href="#Type_Enforcement_.28accepts.2Freturns.29">Type Enforcement (accepts/returns)</a></li><li>
<a href="#CGI_method_wrapper">CGI method wrapper</a></li><li>
<a href="#State_Machine_Implementaion">State Machine Implementaion</a></li><li>
<a href="#C.2B-.2B-.2FJava-keyword-like_function_decorators">C++/Java-keyword-like function decorators</a></li><li>
<a href="#Different_Decorator_Forms">Different Decorator Forms</a></li><li>
<a href="#Unimplemented_function_replacement">Unimplemented function replacement</a></li><li>
<a href="#Redirects_stdout_printing_to_python_standard_logging.">Redirects stdout printing to python standard logging.</a></li><li>
<a href="#Access_control">Access control</a></li><li>
<a href="#Events_rising_and_handling">Events rising and handling</a></li><li>
<a href="#Singleton">Singleton</a></li><li>
<a href="#Asynchronous_Call">Asynchronous Call</a></li><li>
<a href="#Class_method_decorator_using_instance">Class method decorator using instance</a></li><li>
<a href="#Another_Retrying_Decorator">Another Retrying Decorator</a></li><li>
<a href="#Logging_decorator_with_specified_logger_.28or_default.29">Logging decorator with specified logger (or default)</a></li><li>
<a href="#Lazy_Thunkify">Lazy Thunkify</a></li><li>
<a href="#Aggregative_decorators_for_generator_functions">Aggregative decorators for generator functions</a></li><li>
<a href="#Function_Timeout">Function Timeout</a></li><li>
<a href="#Collect_Data_Difference_Caused_by_Decorated_Function">Collect Data Difference Caused by Decorated Function</a></li></ol></li></ol></div> <span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line867">
<h2 id="Creating_Well-Behaved_Decorators_.2F_.22Decorator_decorator.22">Creating Well-Behaved Decorators / &quot;Decorator decorator&quot;</h2>
<span class="anchor" id="line-8"></span><p class="line862">Note: This is only one recipe. Others include inheritance from a standard decorator (link?), the <a class="http" href="http://docs.python.org/dev/library/functools.html">functools @wraps decorator</a>, and a factory function such as <a class="http" href="http://pypi.python.org/pypi/decorator">Michele Simionato's decorator module</a> which even preserves signature information. <span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><p class="line867"><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span><span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span><span class="anchor" id="line-36"></span><span class="anchor" id="line-37"></span><span class="anchor" id="line-38"></span><span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span><span class="anchor" id="line-41"></span><span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span><span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span><span class="anchor" id="line-46"></span><span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-1-1"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
function isnumbered(obj) {
  return obj.childNodes.length && obj.firstChild.childNodes.length && obj.firstChild.firstChild.className == 'LineNumber';
}
function nformat(num,chrs,add) {
  var nlen = Math.max(0,chrs-(''+num).length), res = '';
  while (nlen>0) { res += ' '; nlen-- }
  return res+num+add;
}
function addnumber(did, nstart, nstep) {
  var c = document.getElementById(did), l = c.firstChild, n = 1;
  if (!isnumbered(c)) {
    if (typeof nstart == 'undefined') nstart = 1;
    if (typeof nstep  == 'undefined') nstep = 1;
    var n = nstart;
    while (l != null) {
      if (l.tagName == 'SPAN') {
        var s = document.createElement('SPAN');
        var a = document.createElement('A');
        s.className = 'LineNumber';
        a.appendChild(document.createTextNode(nformat(n,4,'')));
        a.href = '#' + did + '_' + n;
        s.appendChild(a);
        s.appendChild(document.createTextNode(' '));
        n += nstep;
        if (l.childNodes.length) {
          l.insertBefore(s, l.firstChild);
        }
        else {
          l.appendChild(s);
        }
      }
      l = l.nextSibling;
    }
  }
  return false;
}
function remnumber(did) {
  var c = document.getElementById(did), l = c.firstChild;
  if (isnumbered(c)) {
    while (l != null) {
      if (l.tagName == 'SPAN' && l.firstChild.className == 'LineNumber') l.removeChild(l.firstChild);
      l = l.nextSibling;
    }
  }
  return false;
}
function togglenumber(did, nstart, nstep) {
  var c = document.getElementById(did);
  if (isnumbered(c)) {
    remnumber(did);
  } else {
    addnumber(did,nstart,nstep);
  }
  return false;
}
</script>

<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_1">   1</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_1"></span><span class="anchor" id="line-1-2"></span><span class="ResWord">def</span> <span class="ID">simple_decorator</span>(<span class="ID">decorator</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_2">   2</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_2"></span><span class="anchor" id="line-2-1"></span>    <span class="String">'''This decorator can be used to turn simple functions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_3">   3</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_3"></span><span class="anchor" id="line-3-1"></span><span class="String">    into well-behaved decorators, so long as the decorators</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_4">   4</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_4"></span><span class="anchor" id="line-4-1"></span><span class="String">    are fairly simple. If a decorator expects a function and</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_5">   5</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_5"></span><span class="anchor" id="line-5-1"></span><span class="String">    returns a function (no descriptors), and if it doesn't</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_6">   6</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_6"></span><span class="anchor" id="line-6-1"></span><span class="String">    modify function attributes or docstring, then it is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_7">   7</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_7"></span><span class="anchor" id="line-7-1"></span><span class="String">    eligible to use this. Simply apply @simple_decorator to</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_8">   8</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_8"></span><span class="anchor" id="line-8-1"></span><span class="String">    your decorator and it will automatically preserve the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_9">   9</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_9"></span><span class="anchor" id="line-9-1"></span><span class="String">    docstring and function attributes of functions to which</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_10">  10</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_10"></span><span class="anchor" id="line-10-1"></span><span class="String">    it is applied.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_11">  11</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_11"></span><span class="anchor" id="line-11-1"></span>    <span class="ResWord">def</span> <span class="ID">new_decorator</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_12">  12</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_12"></span><span class="anchor" id="line-12-1"></span>        <span class="ID">g</span> = <span class="ID">decorator</span>(<span class="ID">f</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_13">  13</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_13"></span><span class="anchor" id="line-13-1"></span>        <span class="ID">g</span>.<span class="ID">__name__</span> = <span class="ID">f</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_14">  14</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_14"></span><span class="anchor" id="line-14-1"></span>        <span class="ID">g</span>.<span class="ID">__doc__</span> = <span class="ID">f</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_15">  15</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_15"></span><span class="anchor" id="line-15-1"></span>        <span class="ID">g</span>.<span class="ID">__dict__</span>.<span class="ID">update</span>(<span class="ID">f</span>.<span class="ID">__dict__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_16">  16</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_16"></span><span class="anchor" id="line-16-1"></span>        <span class="ResWord">return</span> <span class="ID">g</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_17">  17</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_17"></span><span class="anchor" id="line-17-1"></span>    <span class="Comment"># Now a few lines needed to make simple_decorator itself</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_18">  18</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_18"></span><span class="anchor" id="line-18-1"></span>    <span class="Comment"># be a well-behaved decorator.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_19">  19</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_19"></span><span class="anchor" id="line-19-1"></span>    <span class="ID">new_decorator</span>.<span class="ID">__name__</span> = <span class="ID">decorator</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_20">  20</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_20"></span><span class="anchor" id="line-20-1"></span>    <span class="ID">new_decorator</span>.<span class="ID">__doc__</span> = <span class="ID">decorator</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_21">  21</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_21"></span><span class="anchor" id="line-21-1"></span>    <span class="ID">new_decorator</span>.<span class="ID">__dict__</span>.<span class="ID">update</span>(<span class="ID">decorator</span>.<span class="ID">__dict__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_22">  22</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_22"></span><span class="anchor" id="line-22-1"></span>    <span class="ResWord">return</span> <span class="ID">new_decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_23">  23</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_23"></span><span class="anchor" id="line-23-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_24">  24</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_24"></span><span class="anchor" id="line-24-1"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_25">  25</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_25"></span><span class="anchor" id="line-25-1"></span><span class="Comment"># Sample Use:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_26">  26</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_26"></span><span class="anchor" id="line-26-1"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_27">  27</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_27"></span><span class="anchor" id="line-27-1"></span><span class="ID">@simple_decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_28">  28</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_28"></span><span class="anchor" id="line-28-1"></span><span class="ResWord">def</span> <span class="ID">my_simple_logging_decorator</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_29">  29</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_29"></span><span class="anchor" id="line-29-1"></span>    <span class="ResWord">def</span> <span class="ID">you_will_never_see_this_name</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_30">  30</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_30"></span><span class="anchor" id="line-30-1"></span>        <span class="ResWord">print</span> <span class="String">'</span><span class="String">calling {}</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ID">func</span>.<span class="ID">__name__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_31">  31</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_31"></span><span class="anchor" id="line-31-1"></span>        <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_32">  32</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_32"></span><span class="anchor" id="line-32-1"></span>    <span class="ResWord">return</span> <span class="ID">you_will_never_see_this_name</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_33">  33</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_33"></span><span class="anchor" id="line-33-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_34">  34</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_34"></span><span class="anchor" id="line-34-1"></span><span class="ID">@my_simple_logging_decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_35">  35</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_35"></span><span class="anchor" id="line-35-1"></span><span class="ResWord">def</span> <span class="ID">double</span>(<span class="ID">x</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_36">  36</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_36"></span><span class="anchor" id="line-36-1"></span>    <span class="String">'</span><span class="String">Doubles a number.</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_37">  37</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_37"></span><span class="anchor" id="line-37-1"></span>    <span class="ResWord">return</span> <span class="Number">2</span> * <span class="ID">x</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_38">  38</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_38"></span><span class="anchor" id="line-38-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_39">  39</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_39"></span><span class="anchor" id="line-39-1"></span><span class="ResWord">assert</span> <span class="ID">double</span>.<span class="ID">__name__</span> == <span class="String">'</span><span class="String">double</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_40">  40</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_40"></span><span class="anchor" id="line-40-1"></span><span class="ResWord">assert</span> <span class="ID">double</span>.<span class="ID">__doc__</span> == <span class="String">'</span><span class="String">Doubles a number.</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_41">  41</a> </span><span class="LineAnchor" id="CA-e6b32ec67d709fe92640a7cc6caa6a033b9eae7d_41"></span><span class="anchor" id="line-41-1"></span><span class="ResWord">print</span> <span class="ID">double</span>(<span class="Number">155</span>)</span>
</pre></div></div><span class="anchor" id="line-53"></span><p class="line867">
<h2 id="Property_Definition">Property Definition</h2>
<span class="anchor" id="line-54"></span><p class="line874">These decorators provide a readable way to define properties: <span class="anchor" id="line-55"></span><span class="anchor" id="line-56"></span><p class="line867"><span class="anchor" id="line-57"></span><span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span><span class="anchor" id="line-66"></span><span class="anchor" id="line-67"></span><span class="anchor" id="line-68"></span><span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span><span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span><span class="anchor" id="line-74"></span><span class="anchor" id="line-75"></span><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span><span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span><span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span><span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span><span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span><span class="anchor" id="line-102"></span><span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span><span class="anchor" id="line-1-3"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_1">   1</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_1"></span><span class="anchor" id="line-1-4"></span><span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_2">   2</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_2"></span><span class="anchor" id="line-2-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_3">   3</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_3"></span><span class="anchor" id="line-3-2"></span><span class="ResWord">def</span> <span class="ID">propget</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_4">   4</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_4"></span><span class="anchor" id="line-4-2"></span>    <span class="ResWord">locals</span> = <span class="ID">sys</span>.<span class="ID">_getframe</span>(<span class="Number">1</span>).<span class="ID">f_locals</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_5">   5</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_5"></span><span class="anchor" id="line-5-2"></span>    <span class="ID">name</span> = <span class="ID">func</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_6">   6</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_6"></span><span class="anchor" id="line-6-2"></span>    <span class="ID">prop</span> = <span class="ResWord">locals</span>.<span class="ID">get</span>(<span class="ID">name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_7">   7</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_7"></span><span class="anchor" id="line-7-2"></span>    <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">isinstance</span>(<span class="ID">prop</span>, <span class="ResWord">property</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_8">   8</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_8"></span><span class="anchor" id="line-8-2"></span>        <span class="ID">prop</span> = <span class="ResWord">property</span>(<span class="ID">func</span>, <span class="ID">doc</span>=<span class="ID">func</span>.<span class="ID">__doc__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_9">   9</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_9"></span><span class="anchor" id="line-9-2"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_10">  10</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_10"></span><span class="anchor" id="line-10-2"></span>        <span class="ID">doc</span> = <span class="ID">prop</span>.<span class="ID">__doc__</span> <span class="ResWord">or</span> <span class="ID">func</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_11">  11</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_11"></span><span class="anchor" id="line-11-2"></span>        <span class="ID">prop</span> = <span class="ResWord">property</span>(<span class="ID">func</span>, <span class="ID">prop</span>.<span class="ID">fset</span>, <span class="ID">prop</span>.<span class="ID">fdel</span>, <span class="ID">doc</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_12">  12</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_12"></span><span class="anchor" id="line-12-2"></span>    <span class="ResWord">return</span> <span class="ID">prop</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_13">  13</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_13"></span><span class="anchor" id="line-13-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_14">  14</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_14"></span><span class="anchor" id="line-14-2"></span><span class="ResWord">def</span> <span class="ID">propset</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_15">  15</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_15"></span><span class="anchor" id="line-15-2"></span>    <span class="ResWord">locals</span> = <span class="ID">sys</span>.<span class="ID">_getframe</span>(<span class="Number">1</span>).<span class="ID">f_locals</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_16">  16</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_16"></span><span class="anchor" id="line-16-2"></span>    <span class="ID">name</span> = <span class="ID">func</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_17">  17</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_17"></span><span class="anchor" id="line-17-2"></span>    <span class="ID">prop</span> = <span class="ResWord">locals</span>.<span class="ID">get</span>(<span class="ID">name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_18">  18</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_18"></span><span class="anchor" id="line-18-2"></span>    <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">isinstance</span>(<span class="ID">prop</span>, <span class="ResWord">property</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_19">  19</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_19"></span><span class="anchor" id="line-19-2"></span>        <span class="ID">prop</span> = <span class="ResWord">property</span>(<span class="ResWord">None</span>, <span class="ID">func</span>, <span class="ID">doc</span>=<span class="ID">func</span>.<span class="ID">__doc__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_20">  20</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_20"></span><span class="anchor" id="line-20-2"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_21">  21</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_21"></span><span class="anchor" id="line-21-2"></span>        <span class="ID">doc</span> = <span class="ID">prop</span>.<span class="ID">__doc__</span> <span class="ResWord">or</span> <span class="ID">func</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_22">  22</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_22"></span><span class="anchor" id="line-22-2"></span>        <span class="ID">prop</span> = <span class="ResWord">property</span>(<span class="ID">prop</span>.<span class="ID">fget</span>, <span class="ID">func</span>, <span class="ID">prop</span>.<span class="ID">fdel</span>, <span class="ID">doc</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_23">  23</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_23"></span><span class="anchor" id="line-23-2"></span>    <span class="ResWord">return</span> <span class="ID">prop</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_24">  24</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_24"></span><span class="anchor" id="line-24-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_25">  25</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_25"></span><span class="anchor" id="line-25-2"></span><span class="ResWord">def</span> <span class="ID">propdel</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_26">  26</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_26"></span><span class="anchor" id="line-26-2"></span>    <span class="ResWord">locals</span> = <span class="ID">sys</span>.<span class="ID">_getframe</span>(<span class="Number">1</span>).<span class="ID">f_locals</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_27">  27</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_27"></span><span class="anchor" id="line-27-2"></span>    <span class="ID">name</span> = <span class="ID">func</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_28">  28</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_28"></span><span class="anchor" id="line-28-2"></span>    <span class="ID">prop</span> = <span class="ResWord">locals</span>.<span class="ID">get</span>(<span class="ID">name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_29">  29</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_29"></span><span class="anchor" id="line-29-2"></span>    <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">isinstance</span>(<span class="ID">prop</span>, <span class="ResWord">property</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_30">  30</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_30"></span><span class="anchor" id="line-30-2"></span>        <span class="ID">prop</span> = <span class="ResWord">property</span>(<span class="ResWord">None</span>, <span class="ResWord">None</span>, <span class="ID">func</span>, <span class="ID">doc</span>=<span class="ID">func</span>.<span class="ID">__doc__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_31">  31</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_31"></span><span class="anchor" id="line-31-2"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_32">  32</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_32"></span><span class="anchor" id="line-32-2"></span>        <span class="ID">prop</span> = <span class="ResWord">property</span>(<span class="ID">prop</span>.<span class="ID">fget</span>, <span class="ID">prop</span>.<span class="ID">fset</span>, <span class="ID">func</span>, <span class="ID">prop</span>.<span class="ID">__doc__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_33">  33</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_33"></span><span class="anchor" id="line-33-2"></span>    <span class="ResWord">return</span> <span class="ID">prop</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_34">  34</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_34"></span><span class="anchor" id="line-34-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_35">  35</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_35"></span><span class="anchor" id="line-35-2"></span><span class="Comment"># These can be used like this:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_36">  36</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_36"></span><span class="anchor" id="line-36-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_37">  37</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_37"></span><span class="anchor" id="line-37-2"></span><span class="ResWord">class</span> <span class="ID">Example</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_38">  38</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_38"></span><span class="anchor" id="line-38-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_39">  39</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_39"></span><span class="anchor" id="line-39-2"></span>    <span class="ID">@propget</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_40">  40</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_40"></span><span class="anchor" id="line-40-2"></span>    <span class="ResWord">def</span> <span class="ID">myattr</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_41">  41</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_41"></span><span class="anchor" id="line-41-2"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">_half</span> * <span class="Number">2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_42">  42</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_42"></span><span class="anchor" id="line-42-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_43">  43</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_43"></span><span class="anchor" id="line-43-1"></span>    <span class="ID">@propset</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_44">  44</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_44"></span><span class="anchor" id="line-44-1"></span>    <span class="ResWord">def</span> <span class="ID">myattr</span>(<span class="ResWord">self</span>, <span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_45">  45</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_45"></span><span class="anchor" id="line-45-1"></span>        <span class="ResWord">self</span>.<span class="ID">_half</span> = <span class="ID">value</span> / <span class="Number">2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_46">  46</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_46"></span><span class="anchor" id="line-46-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_47">  47</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_47"></span><span class="anchor" id="line-47-1"></span>    <span class="ID">@propdel</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_48">  48</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_48"></span><span class="anchor" id="line-48-1"></span>    <span class="ResWord">def</span> <span class="ID">myattr</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_49">  49</a> </span><span class="LineAnchor" id="CA-e0988fe5a4e607de1f88c6c68e7570e3be16939b_49"></span><span class="anchor" id="line-49-1"></span>        <span class="ResWord">del</span> <span class="ResWord">self</span>.<span class="ID">_half</span></span>
</pre></div></div><span class="anchor" id="line-107"></span><p class="line874">Here's a way that doesn't require any new decorators: <span class="anchor" id="line-108"></span><span class="anchor" id="line-109"></span><p class="line867"><span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span><span class="anchor" id="line-117"></span><span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span><span class="anchor" id="line-120"></span><span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span><span class="anchor" id="line-124"></span><span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><span class="anchor" id="line-1-5"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_1">   1</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_1"></span><span class="anchor" id="line-1-6"></span><span class="ResWord">class</span> <span class="ID">Example</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_2">   2</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_2"></span><span class="anchor" id="line-2-3"></span>    <span class="ID">@apply</span>  <span class="Comment"># doesn't exist in Python 3</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_3">   3</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_3"></span><span class="anchor" id="line-3-3"></span>    <span class="ResWord">def</span> <span class="ID">myattr</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_4">   4</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_4"></span><span class="anchor" id="line-4-3"></span>        <span class="ID">doc</span> = <span class="String">'''</span><span class="String">This is the doc string.</span><span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_5">   5</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_5"></span><span class="anchor" id="line-5-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_6">   6</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_6"></span><span class="anchor" id="line-6-3"></span>        <span class="ResWord">def</span> <span class="ID">fget</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_7">   7</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_7"></span><span class="anchor" id="line-7-3"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">_half</span> * <span class="Number">2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_8">   8</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_8"></span><span class="anchor" id="line-8-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_9">   9</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_9"></span><span class="anchor" id="line-9-3"></span>        <span class="ResWord">def</span> <span class="ID">fset</span>(<span class="ResWord">self</span>, <span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_10">  10</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_10"></span><span class="anchor" id="line-10-3"></span>            <span class="ResWord">self</span>.<span class="ID">_half</span> = <span class="ID">value</span> / <span class="Number">2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_11">  11</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_11"></span><span class="anchor" id="line-11-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_12">  12</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_12"></span><span class="anchor" id="line-12-3"></span>        <span class="ResWord">def</span> <span class="ID">fdel</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_13">  13</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_13"></span><span class="anchor" id="line-13-3"></span>            <span class="ResWord">del</span> <span class="ResWord">self</span>.<span class="ID">_half</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_14">  14</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_14"></span><span class="anchor" id="line-14-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_15">  15</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_15"></span><span class="anchor" id="line-15-3"></span>        <span class="ResWord">return</span> <span class="ResWord">property</span>(**<span class="ResWord">locals</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_16">  16</a> </span><span class="LineAnchor" id="CA-b1a77acd4ada6e29ca9363c151b9b6a0510a8d24_16"></span><span class="anchor" id="line-16-3"></span>    <span class="Comment">#myattr = myattr()  # works in Python 2 and 3</span></span>
</pre></div></div><span class="anchor" id="line-127"></span><p class="line874">Yet another property decorator: <span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span><p class="line867"><span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span><span class="anchor" id="line-135"></span><span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span><span class="anchor" id="line-138"></span><span class="anchor" id="line-139"></span><span class="anchor" id="line-140"></span><span class="anchor" id="line-141"></span><span class="anchor" id="line-142"></span><span class="anchor" id="line-143"></span><span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span><span class="anchor" id="line-150"></span><span class="anchor" id="line-151"></span><span class="anchor" id="line-152"></span><span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span><span class="anchor" id="line-155"></span><span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span><span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span><span class="anchor" id="line-162"></span><span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span><span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span><span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span><span class="anchor" id="line-170"></span><span class="anchor" id="line-171"></span><span class="anchor" id="line-172"></span><span class="anchor" id="line-173"></span><span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><span class="anchor" id="line-176"></span><span class="anchor" id="line-177"></span><span class="anchor" id="line-1-7"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-ed6a40190dc362f43781554318b37ebc1d30506a\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_1">   1</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_1"></span><span class="anchor" id="line-1-8"></span><span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_2">   2</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_2"></span><span class="anchor" id="line-2-4"></span>    <span class="Comment"># Python 2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_3">   3</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_3"></span><span class="anchor" id="line-3-4"></span>    <span class="ResWord">import</span> <span class="ID">__builtin__</span> <span class="ResWord">as</span> <span class="ID">builtins</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_4">   4</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_4"></span><span class="anchor" id="line-4-4"></span><span class="ResWord">except</span> <span class="ID">ImportError</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_5">   5</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_5"></span><span class="anchor" id="line-5-4"></span>    <span class="Comment"># Python 3</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_6">   6</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_6"></span><span class="anchor" id="line-6-4"></span>    <span class="ResWord">import</span> <span class="ID">builtins</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_7">   7</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_7"></span><span class="anchor" id="line-7-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_8">   8</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_8"></span><span class="anchor" id="line-8-4"></span><span class="ResWord">def</span> <span class="ID">property</span>(<span class="ID">function</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_9">   9</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_9"></span><span class="anchor" id="line-9-4"></span>    <span class="ID">keys</span> = <span class="String">'</span><span class="String">fget</span><span class="String">'</span>, <span class="String">'</span><span class="String">fset</span><span class="String">'</span>, <span class="String">'</span><span class="String">fdel</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_10">  10</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_10"></span><span class="anchor" id="line-10-4"></span>    <span class="ID">func_locals</span> = {<span class="String">'</span><span class="String">doc</span><span class="String">'</span>:<span class="ID">function</span>.<span class="ID">__doc__</span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_11">  11</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_11"></span><span class="anchor" id="line-11-4"></span>    <span class="ResWord">def</span> <span class="ID">probe_func</span>(<span class="ID">frame</span>, <span class="ID">event</span>, <span class="ID">arg</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_12">  12</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_12"></span><span class="anchor" id="line-12-4"></span>        <span class="ResWord">if</span> <span class="ID">event</span> == <span class="String">'</span><span class="String">return</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_13">  13</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_13"></span><span class="anchor" id="line-13-4"></span>            <span class="ResWord">locals</span> = <span class="ID">frame</span>.<span class="ID">f_locals</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_14">  14</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_14"></span><span class="anchor" id="line-14-4"></span>            <span class="ID">func_locals</span>.<span class="ID">update</span>(<span class="ResWord">dict</span>((<span class="ID">k</span>, <span class="ResWord">locals</span>.<span class="ID">get</span>(<span class="ID">k</span>)) <span class="ResWord">for</span> <span class="ID">k</span> <span class="ResWord">in</span> <span class="ID">keys</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_15">  15</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_15"></span><span class="anchor" id="line-15-4"></span>            <span class="ID">sys</span>.<span class="ID">settrace</span>(<span class="ResWord">None</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_16">  16</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_16"></span><span class="anchor" id="line-16-4"></span>        <span class="ResWord">return</span> <span class="ID">probe_func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_17">  17</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_17"></span><span class="anchor" id="line-17-3"></span>    <span class="ID">sys</span>.<span class="ID">settrace</span>(<span class="ID">probe_func</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_18">  18</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_18"></span><span class="anchor" id="line-18-3"></span>    <span class="ID">function</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_19">  19</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_19"></span><span class="anchor" id="line-19-3"></span>    <span class="ResWord">return</span> <span class="ID">builtins</span>.<span class="ID">property</span>(**<span class="ID">func_locals</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_20">  20</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_20"></span><span class="anchor" id="line-20-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_21">  21</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_21"></span><span class="anchor" id="line-21-3"></span><span class="Comment">#====== Example =======================================================</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_22">  22</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_22"></span><span class="anchor" id="line-22-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_23">  23</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_23"></span><span class="anchor" id="line-23-3"></span><span class="ResWord">from</span> <span class="ID">math</span> <span class="ResWord">import</span> <span class="ID">radians</span>, <span class="ID">degrees</span>, <span class="ID">pi</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_24">  24</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_24"></span><span class="anchor" id="line-24-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_25">  25</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_25"></span><span class="anchor" id="line-25-3"></span><span class="ResWord">class</span> <span class="ID">Angle</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_26">  26</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_26"></span><span class="anchor" id="line-26-3"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">rad</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_27">  27</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_27"></span><span class="anchor" id="line-27-3"></span>        <span class="ResWord">self</span>.<span class="ID">_rad</span> = <span class="ID">rad</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_28">  28</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_28"></span><span class="anchor" id="line-28-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_29">  29</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_29"></span><span class="anchor" id="line-29-3"></span>    <span class="ID">@property</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_30">  30</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_30"></span><span class="anchor" id="line-30-3"></span>    <span class="ResWord">def</span> <span class="ID">rad</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_31">  31</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_31"></span><span class="anchor" id="line-31-3"></span>        <span class="String">'''The angle in radians'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_32">  32</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_32"></span><span class="anchor" id="line-32-3"></span>        <span class="ResWord">def</span> <span class="ID">fget</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_33">  33</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_33"></span><span class="anchor" id="line-33-3"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">_rad</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_34">  34</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_34"></span><span class="anchor" id="line-34-3"></span>        <span class="ResWord">def</span> <span class="ID">fset</span>(<span class="ResWord">self</span>, <span class="ID">angle</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_35">  35</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_35"></span><span class="anchor" id="line-35-3"></span>            <span class="ResWord">if</span> <span class="ResWord">isinstance</span>(<span class="ID">angle</span>, <span class="ID">Angle</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_36">  36</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_36"></span><span class="anchor" id="line-36-3"></span>                <span class="ID">angle</span> = <span class="ID">angle</span>.<span class="ID">rad</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_37">  37</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_37"></span><span class="anchor" id="line-37-3"></span>            <span class="ResWord">self</span>.<span class="ID">_rad</span> = <span class="ResWord">float</span>(<span class="ID">angle</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_38">  38</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_38"></span><span class="anchor" id="line-38-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_39">  39</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_39"></span><span class="anchor" id="line-39-3"></span>    <span class="ID">@property</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_40">  40</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_40"></span><span class="anchor" id="line-40-3"></span>    <span class="ResWord">def</span> <span class="ID">deg</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_41">  41</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_41"></span><span class="anchor" id="line-41-3"></span>        <span class="String">'''The angle in degrees'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_42">  42</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_42"></span><span class="anchor" id="line-42-2"></span>        <span class="ResWord">def</span> <span class="ID">fget</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_43">  43</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_43"></span><span class="anchor" id="line-43-2"></span>            <span class="ResWord">return</span> <span class="ID">degrees</span>(<span class="ResWord">self</span>.<span class="ID">_rad</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_44">  44</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_44"></span><span class="anchor" id="line-44-2"></span>        <span class="ResWord">def</span> <span class="ID">fset</span>(<span class="ResWord">self</span>, <span class="ID">angle</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_45">  45</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_45"></span><span class="anchor" id="line-45-2"></span>            <span class="ResWord">if</span> <span class="ResWord">isinstance</span>(<span class="ID">angle</span>, <span class="ID">Angle</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_46">  46</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_46"></span><span class="anchor" id="line-46-2"></span>                <span class="ID">angle</span> = <span class="ID">angle</span>.<span class="ID">deg</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ed6a40190dc362f43781554318b37ebc1d30506a_47">  47</a> </span><span class="LineAnchor" id="CA-ed6a40190dc362f43781554318b37ebc1d30506a_47"></span><span class="anchor" id="line-47-2"></span>            <span class="ResWord">self</span>.<span class="ID">_rad</span> = <span class="ID">radians</span>(<span class="ID">angle</span>)</span>
</pre></div></div><span class="anchor" id="line-178"></span><p class="line867">
<h2 id="Memoize">Memoize</h2>
<span class="anchor" id="line-179"></span><p class="line874">Here's a memoizing class. <span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span><p class="line867"><span class="anchor" id="line-182"></span><span class="anchor" id="line-183"></span><span class="anchor" id="line-184"></span><span class="anchor" id="line-185"></span><span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span><span class="anchor" id="line-192"></span><span class="anchor" id="line-193"></span><span class="anchor" id="line-194"></span><span class="anchor" id="line-195"></span><span class="anchor" id="line-196"></span><span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span><span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span><span class="anchor" id="line-203"></span><span class="anchor" id="line-204"></span><span class="anchor" id="line-205"></span><span class="anchor" id="line-206"></span><span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span><span class="anchor" id="line-210"></span><span class="anchor" id="line-211"></span><span class="anchor" id="line-212"></span><span class="anchor" id="line-213"></span><span class="anchor" id="line-214"></span><span class="anchor" id="line-215"></span><span class="anchor" id="line-216"></span><span class="anchor" id="line-217"></span><span class="anchor" id="line-218"></span><span class="anchor" id="line-219"></span><span class="anchor" id="line-1-9"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-7f0e99ea942ab4cfe29b3964877c22f84954f660\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_1">   1</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_1"></span><span class="anchor" id="line-1-10"></span><span class="ResWord">import</span> <span class="ID">collections</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_2">   2</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_2"></span><span class="anchor" id="line-2-5"></span><span class="ResWord">import</span> <span class="ID">functools</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_3">   3</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_3"></span><span class="anchor" id="line-3-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_4">   4</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_4"></span><span class="anchor" id="line-4-5"></span><span class="ResWord">class</span> <span class="ID">memoized</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_5">   5</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_5"></span><span class="anchor" id="line-5-5"></span>   <span class="String">'''Decorator. Caches a function's return value each time it is called.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_6">   6</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_6"></span><span class="anchor" id="line-6-5"></span><span class="String">   If called later with the same arguments, the cached value is returned</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_7">   7</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_7"></span><span class="anchor" id="line-7-5"></span><span class="String">   (not reevaluated).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_8">   8</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_8"></span><span class="anchor" id="line-8-5"></span><span class="String">   '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_9">   9</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_9"></span><span class="anchor" id="line-9-5"></span>   <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_10">  10</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_10"></span><span class="anchor" id="line-10-5"></span>      <span class="ResWord">self</span>.<span class="ID">func</span> = <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_11">  11</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_11"></span><span class="anchor" id="line-11-5"></span>      <span class="ResWord">self</span>.<span class="ID">cache</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_12">  12</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_12"></span><span class="anchor" id="line-12-5"></span>   <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_13">  13</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_13"></span><span class="anchor" id="line-13-5"></span>      <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">isinstance</span>(<span class="ID">args</span>, <span class="ID">collections</span>.<span class="ID">Hashable</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_14">  14</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_14"></span><span class="anchor" id="line-14-5"></span>         <span class="Comment"># uncacheable. a list, for instance.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_15">  15</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_15"></span><span class="anchor" id="line-15-5"></span>         <span class="Comment"># better to not cache than blow up.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_16">  16</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_16"></span><span class="anchor" id="line-16-5"></span>         <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">func</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_17">  17</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_17"></span><span class="anchor" id="line-17-4"></span>      <span class="ResWord">if</span> <span class="ID">args</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">cache</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_18">  18</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_18"></span><span class="anchor" id="line-18-4"></span>         <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">cache</span>[<span class="ID">args</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_19">  19</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_19"></span><span class="anchor" id="line-19-4"></span>      <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_20">  20</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_20"></span><span class="anchor" id="line-20-4"></span>         <span class="ID">value</span> = <span class="ResWord">self</span>.<span class="ID">func</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_21">  21</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_21"></span><span class="anchor" id="line-21-4"></span>         <span class="ResWord">self</span>.<span class="ID">cache</span>[<span class="ID">args</span>] = <span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_22">  22</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_22"></span><span class="anchor" id="line-22-4"></span>         <span class="ResWord">return</span> <span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_23">  23</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_23"></span><span class="anchor" id="line-23-4"></span>   <span class="ResWord">def</span> <span class="ID">__repr__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_24">  24</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_24"></span><span class="anchor" id="line-24-4"></span>      <span class="String">'''Return the function's docstring.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_25">  25</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_25"></span><span class="anchor" id="line-25-4"></span>      <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">func</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_26">  26</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_26"></span><span class="anchor" id="line-26-4"></span>   <span class="ResWord">def</span> <span class="ID">__get__</span>(<span class="ResWord">self</span>, <span class="ID">obj</span>, <span class="ID">objtype</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_27">  27</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_27"></span><span class="anchor" id="line-27-4"></span>      <span class="String">'''Support instance methods.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_28">  28</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_28"></span><span class="anchor" id="line-28-4"></span>      <span class="ResWord">return</span> <span class="ID">functools</span>.<span class="ID">partial</span>(<span class="ResWord">self</span>.<span class="ID">__call__</span>, <span class="ID">obj</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_29">  29</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_29"></span><span class="anchor" id="line-29-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_30">  30</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_30"></span><span class="anchor" id="line-30-4"></span><span class="ID">@memoized</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_31">  31</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_31"></span><span class="anchor" id="line-31-4"></span><span class="ResWord">def</span> <span class="ID">fibonacci</span>(<span class="ID">n</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_32">  32</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_32"></span><span class="anchor" id="line-32-4"></span>   <span class="String">&quot;</span><span class="String">Return the nth fibonacci number.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_33">  33</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_33"></span><span class="anchor" id="line-33-4"></span>   <span class="ResWord">if</span> <span class="ID">n</span> <span class="ResWord">in</span> (<span class="Number">0</span>, <span class="Number">1</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_34">  34</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_34"></span><span class="anchor" id="line-34-4"></span>      <span class="ResWord">return</span> <span class="ID">n</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_35">  35</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_35"></span><span class="anchor" id="line-35-4"></span>   <span class="ResWord">return</span> <span class="ID">fibonacci</span>(<span class="ID">n</span>-<span class="Number">1</span>) + <span class="ID">fibonacci</span>(<span class="ID">n</span>-<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_36">  36</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_36"></span><span class="anchor" id="line-36-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_37">  37</a> </span><span class="LineAnchor" id="CA-7f0e99ea942ab4cfe29b3964877c22f84954f660_37"></span><span class="anchor" id="line-37-4"></span><span class="ResWord">print</span> <span class="ID">fibonacci</span>(<span class="Number">12</span>)</span>
</pre></div></div><span class="anchor" id="line-220"></span><p class="line867">
<h2 id="Alternate_memoize_as_nested_functions">Alternate memoize as nested functions</h2>
<span class="anchor" id="line-221"></span><p class="line874">Here's a memoizing function that works on functions, methods, or classes, and exposes the cache publicly. <span class="anchor" id="line-222"></span><span class="anchor" id="line-223"></span><p class="line867"><span class="anchor" id="line-224"></span><span class="anchor" id="line-225"></span><span class="anchor" id="line-226"></span><span class="anchor" id="line-227"></span><span class="anchor" id="line-228"></span><span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span><span class="anchor" id="line-231"></span><span class="anchor" id="line-232"></span><span class="anchor" id="line-233"></span><span class="anchor" id="line-234"></span><span class="anchor" id="line-1-11"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-6760e2a83d00c4cd9f685961b386614997a1683f\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_1">   1</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_1"></span><span class="anchor" id="line-1-12"></span><span class="Comment"># note that this decorator ignores **kwargs</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_2">   2</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_2"></span><span class="anchor" id="line-2-6"></span><span class="ResWord">def</span> <span class="ID">memoize</span>(<span class="ID">obj</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_3">   3</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_3"></span><span class="anchor" id="line-3-6"></span>    <span class="ID">cache</span> = <span class="ID">obj</span>.<span class="ID">cache</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_4">   4</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_4"></span><span class="anchor" id="line-4-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_5">   5</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_5"></span><span class="anchor" id="line-5-6"></span>    <span class="ID">@functools.wraps</span>(<span class="ID">obj</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_6">   6</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_6"></span><span class="anchor" id="line-6-6"></span>    <span class="ResWord">def</span> <span class="ID">memoizer</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_7">   7</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_7"></span><span class="anchor" id="line-7-6"></span>        <span class="ResWord">if</span> <span class="ID">args</span> <span class="ResWord">not</span> <span class="ResWord">in</span> <span class="ID">cache</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_8">   8</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_8"></span><span class="anchor" id="line-8-6"></span>            <span class="ID">cache</span>[<span class="ID">args</span>] = <span class="ID">obj</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_9">   9</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_9"></span><span class="anchor" id="line-9-6"></span>        <span class="ResWord">return</span> <span class="ID">cache</span>[<span class="ID">args</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-6760e2a83d00c4cd9f685961b386614997a1683f_10">  10</a> </span><span class="LineAnchor" id="CA-6760e2a83d00c4cd9f685961b386614997a1683f_10"></span><span class="anchor" id="line-10-6"></span>    <span class="ResWord">return</span> <span class="ID">memoizer</span></span>
</pre></div></div><span class="anchor" id="line-235"></span><p class="line874">Here's a modified version that also respects kwargs. <span class="anchor" id="line-236"></span><span class="anchor" id="line-237"></span><p class="line867"><span class="anchor" id="line-238"></span><span class="anchor" id="line-239"></span><span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span><span class="anchor" id="line-242"></span><span class="anchor" id="line-243"></span><span class="anchor" id="line-244"></span><span class="anchor" id="line-245"></span><span class="anchor" id="line-246"></span><span class="anchor" id="line-247"></span><span class="anchor" id="line-248"></span><span class="anchor" id="line-1-13"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-237e205c0d5bd1459c3663a3feb7f78236085e0a\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_1">   1</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_1"></span><span class="anchor" id="line-1-14"></span><span class="ResWord">def</span> <span class="ID">memoize</span>(<span class="ID">obj</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_2">   2</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_2"></span><span class="anchor" id="line-2-7"></span>    <span class="ID">cache</span> = <span class="ID">obj</span>.<span class="ID">cache</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_3">   3</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_3"></span><span class="anchor" id="line-3-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_4">   4</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_4"></span><span class="anchor" id="line-4-7"></span>    <span class="ID">@functools.wraps</span>(<span class="ID">obj</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_5">   5</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_5"></span><span class="anchor" id="line-5-7"></span>    <span class="ResWord">def</span> <span class="ID">memoizer</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_6">   6</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_6"></span><span class="anchor" id="line-6-7"></span>        <span class="ID">key</span> = <span class="ResWord">str</span>(<span class="ID">args</span>) + <span class="ResWord">str</span>(<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_7">   7</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_7"></span><span class="anchor" id="line-7-7"></span>        <span class="ResWord">if</span> <span class="ID">key</span> <span class="ResWord">not</span> <span class="ResWord">in</span> <span class="ID">cache</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_8">   8</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_8"></span><span class="anchor" id="line-8-7"></span>            <span class="ID">cache</span>[<span class="ID">key</span>] = <span class="ID">obj</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_9">   9</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_9"></span><span class="anchor" id="line-9-7"></span>        <span class="ResWord">return</span> <span class="ID">cache</span>[<span class="ID">key</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_10">  10</a> </span><span class="LineAnchor" id="CA-237e205c0d5bd1459c3663a3feb7f78236085e0a_10"></span><span class="anchor" id="line-10-7"></span>    <span class="ResWord">return</span> <span class="ID">memoizer</span></span>
</pre></div></div><span class="anchor" id="line-249"></span><p class="line867">
<h2 id="Alternate_memoize_as_dict_subclass">Alternate memoize as dict subclass</h2>
<span class="anchor" id="line-250"></span><p class="line874">This is an idea that interests me, but it only seems to work on functions: <span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><p class="line867"><span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span><span class="anchor" id="line-255"></span><span class="anchor" id="line-256"></span><span class="anchor" id="line-257"></span><span class="anchor" id="line-258"></span><span class="anchor" id="line-259"></span><span class="anchor" id="line-260"></span><span class="anchor" id="line-261"></span><span class="anchor" id="line-262"></span><span class="anchor" id="line-263"></span><span class="anchor" id="line-264"></span><span class="anchor" id="line-265"></span><span class="anchor" id="line-266"></span><span class="anchor" id="line-267"></span><span class="anchor" id="line-268"></span><span class="anchor" id="line-269"></span><span class="anchor" id="line-270"></span><span class="anchor" id="line-271"></span><span class="anchor" id="line-272"></span><span class="anchor" id="line-273"></span><span class="anchor" id="line-274"></span><span class="anchor" id="line-275"></span><span class="anchor" id="line-276"></span><span class="anchor" id="line-277"></span><span class="anchor" id="line-278"></span><span class="anchor" id="line-279"></span><span class="anchor" id="line-1-15"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-63970cc21d3037cc801ba34bde56dacf6a2c4261\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_1">   1</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_1"></span><span class="anchor" id="line-1-16"></span><span class="ResWord">class</span> <span class="ID">memoize</span>(<span class="ResWord">dict</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_2">   2</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_2"></span><span class="anchor" id="line-2-8"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_3">   3</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_3"></span><span class="anchor" id="line-3-8"></span>        <span class="ResWord">self</span>.<span class="ID">func</span> = <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_4">   4</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_4"></span><span class="anchor" id="line-4-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_5">   5</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_5"></span><span class="anchor" id="line-5-8"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_6">   6</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_6"></span><span class="anchor" id="line-6-8"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>[<span class="ID">args</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_7">   7</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_7"></span><span class="anchor" id="line-7-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_8">   8</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_8"></span><span class="anchor" id="line-8-8"></span>    <span class="ResWord">def</span> <span class="ID">__missing__</span>(<span class="ResWord">self</span>, <span class="ID">key</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_9">   9</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_9"></span><span class="anchor" id="line-9-8"></span>        <span class="ID">result</span> = <span class="ResWord">self</span>[<span class="ID">key</span>] = <span class="ResWord">self</span>.<span class="ID">func</span>(*<span class="ID">key</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_10">  10</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_10"></span><span class="anchor" id="line-10-8"></span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_11">  11</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_11"></span><span class="anchor" id="line-11-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_12">  12</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_12"></span><span class="anchor" id="line-12-6"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_13">  13</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_13"></span><span class="anchor" id="line-13-6"></span><span class="Comment"># Sample use</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_14">  14</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_14"></span><span class="anchor" id="line-14-6"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_15">  15</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_15"></span><span class="anchor" id="line-15-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_16">  16</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_16"></span><span class="anchor" id="line-16-6"></span>&gt;&gt;&gt; <span class="ID">@memoize</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_17">  17</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_17"></span><span class="anchor" id="line-17-5"></span>... <span class="ResWord">def</span> <span class="ID">foo</span>(<span class="ID">a</span>, <span class="ID">b</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_18">  18</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_18"></span><span class="anchor" id="line-18-5"></span>...     <span class="ResWord">return</span> <span class="ID">a</span> * <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_19">  19</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_19"></span><span class="anchor" id="line-19-5"></span>&gt;&gt;&gt; <span class="ID">foo</span>(<span class="Number">2</span>, <span class="Number">4</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_20">  20</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_20"></span><span class="anchor" id="line-20-5"></span><span class="Number">8</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_21">  21</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_21"></span><span class="anchor" id="line-21-5"></span>&gt;&gt;&gt; <span class="ID">foo</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_22">  22</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_22"></span><span class="anchor" id="line-22-5"></span>{(<span class="Number">2</span>, <span class="Number">4</span>): <span class="Number">8</span>}</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_23">  23</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_23"></span><span class="anchor" id="line-23-5"></span>&gt;&gt;&gt; <span class="ID">foo</span>(<span class="String">'</span><span class="String">hi</span><span class="String">'</span>, <span class="Number">3</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_24">  24</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_24"></span><span class="anchor" id="line-24-5"></span><span class="String">'</span><span class="String">hihihi</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_25">  25</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_25"></span><span class="anchor" id="line-25-5"></span>&gt;&gt;&gt; <span class="ID">foo</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_26">  26</a> </span><span class="LineAnchor" id="CA-63970cc21d3037cc801ba34bde56dacf6a2c4261_26"></span><span class="anchor" id="line-26-5"></span>{(<span class="Number">2</span>, <span class="Number">4</span>): <span class="Number">8</span>, (<span class="String">'</span><span class="String">hi</span><span class="String">'</span>, <span class="Number">3</span>): <span class="String">'</span><span class="String">hihihi</span><span class="String">'</span>}</span>
</pre></div></div><span class="anchor" id="line-280"></span><p class="line867">
<h2 id="Alternate_memoize_that_stores_cache_between_executions">Alternate memoize that stores cache between executions</h2>
<span class="anchor" id="line-281"></span><p class="line862">Additional information and documentation for this decorator is available on <a class="https" href="https://github.com/brmscheiner/memorize.py">Github</a>. <span class="anchor" id="line-282"></span><span class="anchor" id="line-283"></span><p class="line867"><span class="anchor" id="line-284"></span><span class="anchor" id="line-285"></span><span class="anchor" id="line-286"></span><span class="anchor" id="line-287"></span><span class="anchor" id="line-288"></span><span class="anchor" id="line-289"></span><span class="anchor" id="line-290"></span><span class="anchor" id="line-291"></span><span class="anchor" id="line-292"></span><span class="anchor" id="line-293"></span><span class="anchor" id="line-294"></span><span class="anchor" id="line-295"></span><span class="anchor" id="line-296"></span><span class="anchor" id="line-297"></span><span class="anchor" id="line-298"></span><span class="anchor" id="line-299"></span><span class="anchor" id="line-300"></span><span class="anchor" id="line-301"></span><span class="anchor" id="line-302"></span><span class="anchor" id="line-303"></span><span class="anchor" id="line-304"></span><span class="anchor" id="line-305"></span><span class="anchor" id="line-306"></span><span class="anchor" id="line-307"></span><span class="anchor" id="line-308"></span><span class="anchor" id="line-309"></span><span class="anchor" id="line-310"></span><span class="anchor" id="line-311"></span><span class="anchor" id="line-312"></span><span class="anchor" id="line-313"></span><span class="anchor" id="line-314"></span><span class="anchor" id="line-315"></span><span class="anchor" id="line-316"></span><span class="anchor" id="line-317"></span><span class="anchor" id="line-318"></span><span class="anchor" id="line-319"></span><span class="anchor" id="line-320"></span><span class="anchor" id="line-321"></span><span class="anchor" id="line-322"></span><span class="anchor" id="line-323"></span><span class="anchor" id="line-324"></span><span class="anchor" id="line-325"></span><span class="anchor" id="line-326"></span><span class="anchor" id="line-327"></span><span class="anchor" id="line-328"></span><span class="anchor" id="line-329"></span><span class="anchor" id="line-330"></span><span class="anchor" id="line-331"></span><span class="anchor" id="line-332"></span><span class="anchor" id="line-333"></span><span class="anchor" id="line-334"></span><span class="anchor" id="line-335"></span><span class="anchor" id="line-336"></span><span class="anchor" id="line-337"></span><span class="anchor" id="line-338"></span><span class="anchor" id="line-339"></span><span class="anchor" id="line-340"></span><span class="anchor" id="line-341"></span><span class="anchor" id="line-342"></span><span class="anchor" id="line-343"></span><span class="anchor" id="line-344"></span><span class="anchor" id="line-345"></span><span class="anchor" id="line-346"></span><span class="anchor" id="line-347"></span><span class="anchor" id="line-348"></span><span class="anchor" id="line-349"></span><span class="anchor" id="line-350"></span><span class="anchor" id="line-351"></span><span class="anchor" id="line-352"></span><span class="anchor" id="line-353"></span><span class="anchor" id="line-354"></span><span class="anchor" id="line-355"></span><span class="anchor" id="line-356"></span><span class="anchor" id="line-357"></span><span class="anchor" id="line-358"></span><span class="anchor" id="line-359"></span><span class="anchor" id="line-360"></span><span class="anchor" id="line-361"></span><span class="anchor" id="line-362"></span><span class="anchor" id="line-363"></span><span class="anchor" id="line-364"></span><span class="anchor" id="line-365"></span><span class="anchor" id="line-366"></span><span class="anchor" id="line-367"></span><span class="anchor" id="line-368"></span><span class="anchor" id="line-369"></span><span class="anchor" id="line-370"></span><span class="anchor" id="line-371"></span><span class="anchor" id="line-372"></span><span class="anchor" id="line-373"></span><span class="anchor" id="line-374"></span><span class="anchor" id="line-375"></span><span class="anchor" id="line-376"></span><span class="anchor" id="line-377"></span><span class="anchor" id="line-378"></span><span class="anchor" id="line-379"></span><span class="anchor" id="line-380"></span><span class="anchor" id="line-381"></span><span class="anchor" id="line-382"></span><span class="anchor" id="line-383"></span><span class="anchor" id="line-384"></span><span class="anchor" id="line-385"></span><span class="anchor" id="line-386"></span><span class="anchor" id="line-387"></span><span class="anchor" id="line-388"></span><span class="anchor" id="line-389"></span><span class="anchor" id="line-390"></span><span class="anchor" id="line-391"></span><span class="anchor" id="line-392"></span><span class="anchor" id="line-393"></span><span class="anchor" id="line-394"></span><span class="anchor" id="line-395"></span><span class="anchor" id="line-396"></span><span class="anchor" id="line-397"></span><span class="anchor" id="line-398"></span><span class="anchor" id="line-399"></span><span class="anchor" id="line-400"></span><span class="anchor" id="line-401"></span><span class="anchor" id="line-402"></span><span class="anchor" id="line-403"></span><span class="anchor" id="line-404"></span><span class="anchor" id="line-405"></span><span class="anchor" id="line-406"></span><span class="anchor" id="line-407"></span><span class="anchor" id="line-408"></span><span class="anchor" id="line-409"></span><span class="anchor" id="line-410"></span><span class="anchor" id="line-411"></span><span class="anchor" id="line-412"></span><span class="anchor" id="line-413"></span><span class="anchor" id="line-414"></span><span class="anchor" id="line-415"></span><span class="anchor" id="line-1-17"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_1">   1</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_1"></span><span class="anchor" id="line-1-18"></span><span class="ResWord">import</span> <span class="ID">pickle</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_2">   2</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_2"></span><span class="anchor" id="line-2-9"></span><span class="ResWord">import</span> <span class="ID">collections</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_3">   3</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_3"></span><span class="anchor" id="line-3-9"></span><span class="ResWord">import</span> <span class="ID">functools</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_4">   4</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_4"></span><span class="anchor" id="line-4-9"></span><span class="ResWord">import</span> <span class="ID">inspect</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_5">   5</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_5"></span><span class="anchor" id="line-5-9"></span><span class="ResWord">import</span> <span class="ID">os.path</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_6">   6</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_6"></span><span class="anchor" id="line-6-9"></span><span class="ResWord">import</span> <span class="ID">re</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_7">   7</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_7"></span><span class="anchor" id="line-7-9"></span><span class="ResWord">import</span> <span class="ID">unicodedata</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_8">   8</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_8"></span><span class="anchor" id="line-8-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_9">   9</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_9"></span><span class="anchor" id="line-9-9"></span><span class="ResWord">class</span> <span class="ID">Memorize</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_10">  10</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_10"></span><span class="anchor" id="line-10-9"></span>    <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_11">  11</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_11"></span><span class="anchor" id="line-11-7"></span><span class="String">    A function decorated with @Memorize caches its return</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_12">  12</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_12"></span><span class="anchor" id="line-12-7"></span><span class="String">    value every time it is called. If the function is called</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_13">  13</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_13"></span><span class="anchor" id="line-13-7"></span><span class="String">    later with the same arguments, the cached value is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_14">  14</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_14"></span><span class="anchor" id="line-14-7"></span><span class="String">    returned (the function is not reevaluated). The cache is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_15">  15</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_15"></span><span class="anchor" id="line-15-7"></span><span class="String">    stored as a .cache file in the current directory for reuse</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_16">  16</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_16"></span><span class="anchor" id="line-16-7"></span><span class="String">    in future executions. If the Python file containing the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_17">  17</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_17"></span><span class="anchor" id="line-17-6"></span><span class="String">    decorated function has been updated since the last run,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_18">  18</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_18"></span><span class="anchor" id="line-18-6"></span><span class="String">    the current cache is deleted and a new cache is created</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_19">  19</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_19"></span><span class="anchor" id="line-19-6"></span><span class="String">    (in case the behavior of the function has changed).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_20">  20</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_20"></span><span class="anchor" id="line-20-6"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_21">  21</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_21"></span><span class="anchor" id="line-21-6"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_22">  22</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_22"></span><span class="anchor" id="line-22-6"></span>        <span class="ResWord">self</span>.<span class="ID">func</span> = <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_23">  23</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_23"></span><span class="anchor" id="line-23-6"></span>        <span class="ResWord">self</span>.<span class="ID">set_parent_file</span>() <span class="Comment"># Sets self.parent_filepath and self.parent_filename</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_24">  24</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_24"></span><span class="anchor" id="line-24-6"></span>        <span class="ResWord">self</span>.<span class="ID">__name__</span> = <span class="ResWord">self</span>.<span class="ID">func</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_25">  25</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_25"></span><span class="anchor" id="line-25-6"></span>        <span class="ResWord">self</span>.<span class="ID">set_cache_filename</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_26">  26</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_26"></span><span class="anchor" id="line-26-6"></span>        <span class="ResWord">if</span> <span class="ResWord">self</span>.<span class="ID">cache_exists</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_27">  27</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_27"></span><span class="anchor" id="line-27-5"></span>            <span class="ResWord">self</span>.<span class="ID">read_cache</span>() <span class="Comment"># Sets self.timestamp and self.cache</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_28">  28</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_28"></span><span class="anchor" id="line-28-5"></span>            <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">self</span>.<span class="ID">is_safe_cache</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_29">  29</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_29"></span><span class="anchor" id="line-29-5"></span>                <span class="ResWord">self</span>.<span class="ID">cache</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_30">  30</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_30"></span><span class="anchor" id="line-30-5"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_31">  31</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_31"></span><span class="anchor" id="line-31-5"></span>            <span class="ResWord">self</span>.<span class="ID">cache</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_32">  32</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_32"></span><span class="anchor" id="line-32-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_33">  33</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_33"></span><span class="anchor" id="line-33-5"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_34">  34</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_34"></span><span class="anchor" id="line-34-5"></span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">isinstance</span>(<span class="ID">args</span>, <span class="ID">collections</span>.<span class="ID">Hashable</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_35">  35</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_35"></span><span class="anchor" id="line-35-5"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">func</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_36">  36</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_36"></span><span class="anchor" id="line-36-5"></span>        <span class="ResWord">if</span> <span class="ID">args</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">cache</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_37">  37</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_37"></span><span class="anchor" id="line-37-5"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">cache</span>[<span class="ID">args</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_38">  38</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_38"></span><span class="anchor" id="line-38-4"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_39">  39</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_39"></span><span class="anchor" id="line-39-4"></span>            <span class="ID">value</span> = <span class="ResWord">self</span>.<span class="ID">func</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_40">  40</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_40"></span><span class="anchor" id="line-40-4"></span>            <span class="ResWord">self</span>.<span class="ID">cache</span>[<span class="ID">args</span>] = <span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_41">  41</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_41"></span><span class="anchor" id="line-41-4"></span>            <span class="ResWord">self</span>.<span class="ID">save_cache</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_42">  42</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_42"></span><span class="anchor" id="line-42-3"></span>            <span class="ResWord">return</span> <span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_43">  43</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_43"></span><span class="anchor" id="line-43-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_44">  44</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_44"></span><span class="anchor" id="line-44-3"></span>    <span class="ResWord">def</span> <span class="ID">set_parent_file</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_45">  45</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_45"></span><span class="anchor" id="line-45-3"></span>        <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_46">  46</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_46"></span><span class="anchor" id="line-46-3"></span><span class="String">        Sets self.parent_file to the absolute path of the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_47">  47</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_47"></span><span class="anchor" id="line-47-3"></span><span class="String">        file containing the memoized function.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_48">  48</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_48"></span><span class="anchor" id="line-48-2"></span><span class="String">        &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_49">  49</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_49"></span><span class="anchor" id="line-49-2"></span>        <span class="ID">rel_parent_file</span> = <span class="ID">inspect</span>.<span class="ID">stack</span>()[-<span class="Number">1</span>].<span class="ID">filename</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_50">  50</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_50"></span><span class="anchor" id="line-50-1"></span>        <span class="ResWord">self</span>.<span class="ID">parent_filepath</span> = <span class="ID">os</span>.<span class="ID">path</span>.<span class="ID">abspath</span>(<span class="ID">rel_parent_file</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_51">  51</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_51"></span><span class="anchor" id="line-51-1"></span>        <span class="ResWord">self</span>.<span class="ID">parent_filename</span> = <span class="ID">_filename_from_path</span>(<span class="ID">rel_parent_file</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_52">  52</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_52"></span><span class="anchor" id="line-52-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_53">  53</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_53"></span><span class="anchor" id="line-53-1"></span>    <span class="ResWord">def</span> <span class="ID">set_cache_filename</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_54">  54</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_54"></span><span class="anchor" id="line-54-1"></span>        <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_55">  55</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_55"></span><span class="anchor" id="line-55-1"></span><span class="String">        Sets self.cache_filename to an os-compliant</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_56">  56</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_56"></span><span class="anchor" id="line-56-1"></span><span class="String">        version of &quot;file_function.cache&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_57">  57</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_57"></span><span class="anchor" id="line-57-1"></span><span class="String">        &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_58">  58</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_58"></span><span class="anchor" id="line-58-1"></span>        <span class="ID">filename</span> = <span class="ID">_slugify</span>(<span class="ResWord">self</span>.<span class="ID">parent_filename</span>.<span class="ID">replace</span>(<span class="String">'</span><span class="String">.py</span><span class="String">'</span>, <span class="String">'</span><span class="String">'</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_59">  59</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_59"></span><span class="anchor" id="line-59-1"></span>        <span class="ID">funcname</span> = <span class="ID">_slugify</span>(<span class="ResWord">self</span>.<span class="ID">__name__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_60">  60</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_60"></span><span class="anchor" id="line-60-1"></span>        <span class="ResWord">self</span>.<span class="ID">cache_filename</span> = <span class="ID">filename</span>+<span class="String">'</span><span class="String">_</span><span class="String">'</span>+<span class="ID">funcname</span>+<span class="String">'</span><span class="String">.cache</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_61">  61</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_61"></span><span class="anchor" id="line-61-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_62">  62</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_62"></span><span class="anchor" id="line-62-1"></span>    <span class="ResWord">def</span> <span class="ID">get_last_update</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_63">  63</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_63"></span><span class="anchor" id="line-63-1"></span>        <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_64">  64</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_64"></span><span class="anchor" id="line-64-1"></span><span class="String">        Returns the time that the parent file was last</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_65">  65</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_65"></span><span class="anchor" id="line-65-1"></span><span class="String">        updated.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_66">  66</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_66"></span><span class="anchor" id="line-66-1"></span><span class="String">        &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_67">  67</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_67"></span><span class="anchor" id="line-67-1"></span>        <span class="ID">last_update</span> = <span class="ID">os</span>.<span class="ID">path</span>.<span class="ID">getmtime</span>(<span class="ResWord">self</span>.<span class="ID">parent_filepath</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_68">  68</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_68"></span><span class="anchor" id="line-68-1"></span>        <span class="ResWord">return</span> <span class="ID">last_update</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_69">  69</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_69"></span><span class="anchor" id="line-69-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_70">  70</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_70"></span><span class="anchor" id="line-70-1"></span>    <span class="ResWord">def</span> <span class="ID">is_safe_cache</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_71">  71</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_71"></span><span class="anchor" id="line-71-1"></span>        <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_72">  72</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_72"></span><span class="anchor" id="line-72-1"></span><span class="String">        Returns True if the file containing the memoized</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_73">  73</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_73"></span><span class="anchor" id="line-73-1"></span><span class="String">        function has not been updated since the cache was</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_74">  74</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_74"></span><span class="anchor" id="line-74-1"></span><span class="String">        last saved.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_75">  75</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_75"></span><span class="anchor" id="line-75-1"></span><span class="String">        &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_76">  76</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_76"></span><span class="anchor" id="line-76-1"></span>        <span class="ResWord">if</span> <span class="ResWord">self</span>.<span class="ID">get_last_update</span>() &gt; <span class="ResWord">self</span>.<span class="ID">timestamp</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_77">  77</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_77"></span><span class="anchor" id="line-77-1"></span>            <span class="ResWord">return</span> <span class="ResWord">False</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_78">  78</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_78"></span><span class="anchor" id="line-78-1"></span>        <span class="ResWord">return</span> <span class="ResWord">True</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_79">  79</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_79"></span><span class="anchor" id="line-79-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_80">  80</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_80"></span><span class="anchor" id="line-80-1"></span>    <span class="ResWord">def</span> <span class="ID">read_cache</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_81">  81</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_81"></span><span class="anchor" id="line-81-1"></span>        <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_82">  82</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_82"></span><span class="anchor" id="line-82-1"></span><span class="String">        Read a pickled dictionary into self.timestamp and</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_83">  83</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_83"></span><span class="anchor" id="line-83-1"></span><span class="String">        self.cache. See self.save_cache.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_84">  84</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_84"></span><span class="anchor" id="line-84-1"></span><span class="String">        &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_85">  85</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_85"></span><span class="anchor" id="line-85-1"></span>        <span class="ResWord">with</span> <span class="ResWord">open</span>(<span class="ResWord">self</span>.<span class="ID">cache_filename</span>, <span class="String">'</span><span class="String">rb</span><span class="String">'</span>) <span class="ResWord">as</span> <span class="ID">f</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_86">  86</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_86"></span><span class="anchor" id="line-86-1"></span>            <span class="ID">data</span> = <span class="ID">pickle</span>.<span class="ID">loads</span>(<span class="ID">f</span>.<span class="ID">read</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_87">  87</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_87"></span><span class="anchor" id="line-87-1"></span>            <span class="ResWord">self</span>.<span class="ID">timestamp</span> = <span class="ID">data</span>[<span class="String">'</span><span class="String">timestamp</span><span class="String">'</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_88">  88</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_88"></span><span class="anchor" id="line-88-1"></span>            <span class="ResWord">self</span>.<span class="ID">cache</span> = <span class="ID">data</span>[<span class="String">'</span><span class="String">cache</span><span class="String">'</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_89">  89</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_89"></span><span class="anchor" id="line-89-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_90">  90</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_90"></span><span class="anchor" id="line-90-1"></span>    <span class="ResWord">def</span> <span class="ID">save_cache</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_91">  91</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_91"></span><span class="anchor" id="line-91-1"></span>        <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_92">  92</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_92"></span><span class="anchor" id="line-92-1"></span><span class="String">        Pickle the file's timestamp and the function's cache</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_93">  93</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_93"></span><span class="anchor" id="line-93-1"></span><span class="String">        in a dictionary object.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_94">  94</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_94"></span><span class="anchor" id="line-94-1"></span><span class="String">        &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_95">  95</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_95"></span><span class="anchor" id="line-95-1"></span>        <span class="ResWord">with</span> <span class="ResWord">open</span>(<span class="ResWord">self</span>.<span class="ID">cache_filename</span>, <span class="String">'</span><span class="String">wb+</span><span class="String">'</span>) <span class="ResWord">as</span> <span class="ID">f</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_96">  96</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_96"></span><span class="anchor" id="line-96-1"></span>            <span class="ID">out</span> = <span class="ResWord">dict</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_97">  97</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_97"></span><span class="anchor" id="line-97-1"></span>            <span class="ID">out</span>[<span class="String">'</span><span class="String">timestamp</span><span class="String">'</span>] = <span class="ResWord">self</span>.<span class="ID">get_last_update</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_98">  98</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_98"></span><span class="anchor" id="line-98-1"></span>            <span class="ID">out</span>[<span class="String">'</span><span class="String">cache</span><span class="String">'</span>] = <span class="ResWord">self</span>.<span class="ID">cache</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_99">  99</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_99"></span><span class="anchor" id="line-99-1"></span>            <span class="ID">f</span>.<span class="ID">write</span>(<span class="ID">pickle</span>.<span class="ID">dumps</span>(<span class="ID">out</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_100"> 100</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_100"></span><span class="anchor" id="line-100-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_101"> 101</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_101"></span><span class="anchor" id="line-101-1"></span>    <span class="ResWord">def</span> <span class="ID">cache_exists</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_102"> 102</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_102"></span><span class="anchor" id="line-102-1"></span>        <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_103"> 103</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_103"></span><span class="anchor" id="line-103-1"></span><span class="String">        Returns True if a matching cache exists in the current directory.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_104"> 104</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_104"></span><span class="anchor" id="line-104-1"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_105"> 105</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_105"></span><span class="anchor" id="line-105-1"></span>        <span class="ResWord">if</span> <span class="ID">os</span>.<span class="ID">path</span>.<span class="ID">isfile</span>(<span class="ResWord">self</span>.<span class="ID">cache_filename</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_106"> 106</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_106"></span><span class="anchor" id="line-106-1"></span>            <span class="ResWord">return</span> <span class="ResWord">True</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_107"> 107</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_107"></span><span class="anchor" id="line-107-1"></span>        <span class="ResWord">return</span> <span class="ResWord">False</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_108"> 108</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_108"></span><span class="anchor" id="line-108-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_109"> 109</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_109"></span><span class="anchor" id="line-109-1"></span>    <span class="ResWord">def</span> <span class="ID">__repr__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_110"> 110</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_110"></span><span class="anchor" id="line-110-1"></span>        <span class="String">&quot;&quot;&quot; Return the function's docstring. &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_111"> 111</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_111"></span><span class="anchor" id="line-111-1"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">func</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_112"> 112</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_112"></span><span class="anchor" id="line-112-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_113"> 113</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_113"></span><span class="anchor" id="line-113-1"></span>    <span class="ResWord">def</span> <span class="ID">__get__</span>(<span class="ResWord">self</span>, <span class="ID">obj</span>, <span class="ID">objtype</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_114"> 114</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_114"></span><span class="anchor" id="line-114-1"></span>        <span class="String">&quot;&quot;&quot; Support instance methods. &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_115"> 115</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_115"></span><span class="anchor" id="line-115-1"></span>        <span class="ResWord">return</span> <span class="ID">functools</span>.<span class="ID">partial</span>(<span class="ResWord">self</span>.<span class="ID">__call__</span>, <span class="ID">obj</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_116"> 116</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_116"></span><span class="anchor" id="line-116-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_117"> 117</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_117"></span><span class="anchor" id="line-117-1"></span><span class="ResWord">def</span> <span class="ID">_slugify</span>(<span class="ID">value</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_118"> 118</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_118"></span><span class="anchor" id="line-118-1"></span>    <span class="String">&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_119"> 119</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_119"></span><span class="anchor" id="line-119-1"></span><span class="String">    Normalizes string, converts to lowercase, removes</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_120"> 120</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_120"></span><span class="anchor" id="line-120-1"></span><span class="String">    non-alpha characters, and converts spaces to</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_121"> 121</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_121"></span><span class="anchor" id="line-121-1"></span><span class="String">    hyphens. From</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_122"> 122</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_122"></span><span class="anchor" id="line-122-1"></span><span class="String">    http://stackoverflow.com/questions/295135/turn-a-string-into-a-valid-filename-in-python</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_123"> 123</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_123"></span><span class="anchor" id="line-123-1"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_124"> 124</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_124"></span><span class="anchor" id="line-124-1"></span>    <span class="ID">value</span> = <span class="ID">unicodedata</span>.<span class="ID">normalize</span>(<span class="String">'</span><span class="String">NFKD</span><span class="String">'</span>, <span class="ID">value</span>).<span class="ID">encode</span>(<span class="String">'</span><span class="String">ascii</span><span class="String">'</span>, <span class="String">'</span><span class="String">ignore</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_125"> 125</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_125"></span><span class="anchor" id="line-125-1"></span>    <span class="ID">value</span> = <span class="ID">re</span>.<span class="ID">sub</span>(<span class="String">r'</span><span class="String">[^</span><span class="String">\</span><span class="String">w</span><span class="String">\</span><span class="String">s-]</span><span class="String">'</span>, <span class="String">'</span><span class="String">'</span>, <span class="ID">value</span>.<span class="ID">decode</span>(<span class="String">'</span><span class="String">utf-8</span><span class="String">'</span>, <span class="String">'</span><span class="String">ignore</span><span class="String">'</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_126"> 126</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_126"></span><span class="anchor" id="line-126-1"></span>    <span class="ID">value</span> = <span class="ID">value</span>.<span class="ID">strip</span>().<span class="ID">lower</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_127"> 127</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_127"></span><span class="anchor" id="line-127-1"></span>    <span class="ID">value</span> = <span class="ID">re</span>.<span class="ID">sub</span>(<span class="String">r'</span><span class="String">[-</span><span class="String">\</span><span class="String">s]+</span><span class="String">'</span>, <span class="String">'</span><span class="String">-</span><span class="String">'</span>, <span class="ID">value</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_128"> 128</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_128"></span><span class="anchor" id="line-128-1"></span>    <span class="ResWord">return</span> <span class="ID">value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_129"> 129</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_129"></span><span class="anchor" id="line-129-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_130"> 130</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_130"></span><span class="anchor" id="line-130-1"></span><span class="ResWord">def</span> <span class="ID">_filename_from_path</span>(<span class="ID">filepath</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_131"> 131</a> </span><span class="LineAnchor" id="CA-41c0a6fb47a91f5c3fc49b7cc004761fc43ec2b6_131"></span><span class="anchor" id="line-131-1"></span>    <span class="ResWord">return</span> <span class="ID">filepath</span>.<span class="ID">split</span>(<span class="String">'</span><span class="String">/</span><span class="String">'</span>)[-<span class="Number">1</span>]</span>
</pre></div></div><span class="anchor" id="line-416"></span><p class="line867">
<h2 id="Cached_Properties">Cached Properties</h2>
<span class="anchor" id="line-417"></span><p class="line867"><span class="anchor" id="line-418"></span><span class="anchor" id="line-419"></span><span class="anchor" id="line-420"></span><span class="anchor" id="line-421"></span><span class="anchor" id="line-422"></span><span class="anchor" id="line-423"></span><span class="anchor" id="line-424"></span><span class="anchor" id="line-425"></span><span class="anchor" id="line-426"></span><span class="anchor" id="line-427"></span><span class="anchor" id="line-428"></span><span class="anchor" id="line-429"></span><span class="anchor" id="line-430"></span><span class="anchor" id="line-431"></span><span class="anchor" id="line-432"></span><span class="anchor" id="line-433"></span><span class="anchor" id="line-434"></span><span class="anchor" id="line-435"></span><span class="anchor" id="line-436"></span><span class="anchor" id="line-437"></span><span class="anchor" id="line-438"></span><span class="anchor" id="line-439"></span><span class="anchor" id="line-440"></span><span class="anchor" id="line-441"></span><span class="anchor" id="line-442"></span><span class="anchor" id="line-443"></span><span class="anchor" id="line-444"></span><span class="anchor" id="line-445"></span><span class="anchor" id="line-446"></span><span class="anchor" id="line-447"></span><span class="anchor" id="line-448"></span><span class="anchor" id="line-449"></span><span class="anchor" id="line-450"></span><span class="anchor" id="line-451"></span><span class="anchor" id="line-452"></span><span class="anchor" id="line-453"></span><span class="anchor" id="line-454"></span><span class="anchor" id="line-455"></span><span class="anchor" id="line-456"></span><span class="anchor" id="line-457"></span><span class="anchor" id="line-458"></span><span class="anchor" id="line-459"></span><span class="anchor" id="line-460"></span><span class="anchor" id="line-461"></span><span class="anchor" id="line-462"></span><span class="anchor" id="line-463"></span><span class="anchor" id="line-464"></span><span class="anchor" id="line-465"></span><span class="anchor" id="line-466"></span><span class="anchor" id="line-467"></span><span class="anchor" id="line-468"></span><span class="anchor" id="line-469"></span><span class="anchor" id="line-470"></span><span class="anchor" id="line-471"></span><span class="anchor" id="line-472"></span><span class="anchor" id="line-473"></span><span class="anchor" id="line-474"></span><span class="anchor" id="line-475"></span><span class="anchor" id="line-476"></span><span class="anchor" id="line-477"></span><span class="anchor" id="line-478"></span><span class="anchor" id="line-479"></span><span class="anchor" id="line-1-19"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_1">   1</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_1"></span><span class="anchor" id="line-1-20"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_2">   2</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_2"></span><span class="anchor" id="line-2-10"></span><span class="Comment"># © 2011 Christopher Arndt, MIT License</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_3">   3</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_3"></span><span class="anchor" id="line-3-10"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_4">   4</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_4"></span><span class="anchor" id="line-4-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_5">   5</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_5"></span><span class="anchor" id="line-5-10"></span><span class="ResWord">import</span> <span class="ID">time</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_6">   6</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_6"></span><span class="anchor" id="line-6-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_7">   7</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_7"></span><span class="anchor" id="line-7-10"></span><span class="ResWord">class</span> <span class="ID">cached_property</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_8">   8</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_8"></span><span class="anchor" id="line-8-10"></span>    <span class="String">'''Decorator for read-only properties evaluated only once within TTL period.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_9">   9</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_9"></span><span class="anchor" id="line-9-10"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_10">  10</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_10"></span><span class="anchor" id="line-10-10"></span><span class="String">    It can be used to create a cached property like this::</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_11">  11</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_11"></span><span class="anchor" id="line-11-8"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_12">  12</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_12"></span><span class="anchor" id="line-12-8"></span><span class="String">        import random</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_13">  13</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_13"></span><span class="anchor" id="line-13-8"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_14">  14</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_14"></span><span class="anchor" id="line-14-8"></span><span class="String">        # the class containing the property must be a new-style class</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_15">  15</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_15"></span><span class="anchor" id="line-15-8"></span><span class="String">        class MyClass(object):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_16">  16</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_16"></span><span class="anchor" id="line-16-8"></span><span class="String">            # create property whose value is cached for ten minutes</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_17">  17</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_17"></span><span class="anchor" id="line-17-7"></span><span class="String">            @cached_property(ttl=600)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_18">  18</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_18"></span><span class="anchor" id="line-18-7"></span><span class="String">            def randint(self):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_19">  19</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_19"></span><span class="anchor" id="line-19-7"></span><span class="String">                # will only be evaluated every 10 min. at maximum.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_20">  20</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_20"></span><span class="anchor" id="line-20-7"></span><span class="String">                return random.randint(0, 100)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_21">  21</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_21"></span><span class="anchor" id="line-21-7"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_22">  22</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_22"></span><span class="anchor" id="line-22-7"></span><span class="String">    The value is cached  in the '_cache' attribute of the object instance that</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_23">  23</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_23"></span><span class="anchor" id="line-23-7"></span><span class="String">    has the property getter method wrapped by this decorator. The '_cache'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_24">  24</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_24"></span><span class="anchor" id="line-24-7"></span><span class="String">    attribute value is a dictionary which has a key for every property of the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_25">  25</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_25"></span><span class="anchor" id="line-25-7"></span><span class="String">    object which is wrapped by this decorator. Each entry in the cache is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_26">  26</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_26"></span><span class="anchor" id="line-26-7"></span><span class="String">    created only when the property is accessed for the first time and is a</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_27">  27</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_27"></span><span class="anchor" id="line-27-6"></span><span class="String">    two-element tuple with the last computed property value and the last time</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_28">  28</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_28"></span><span class="anchor" id="line-28-6"></span><span class="String">    it was updated in seconds since the epoch.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_29">  29</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_29"></span><span class="anchor" id="line-29-6"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_30">  30</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_30"></span><span class="anchor" id="line-30-6"></span><span class="String">    The default time-to-live (TTL) is 300 seconds (5 minutes). Set the TTL to</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_31">  31</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_31"></span><span class="anchor" id="line-31-6"></span><span class="String">    zero for the cached value to never expire.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_32">  32</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_32"></span><span class="anchor" id="line-32-6"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_33">  33</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_33"></span><span class="anchor" id="line-33-6"></span><span class="String">    To expire a cached property value manually just do::</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_34">  34</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_34"></span><span class="anchor" id="line-34-6"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_35">  35</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_35"></span><span class="anchor" id="line-35-6"></span><span class="String">        del instance._cache[&lt;property name&gt;]</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_36">  36</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_36"></span><span class="anchor" id="line-36-6"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_37">  37</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_37"></span><span class="anchor" id="line-37-6"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_38">  38</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_38"></span><span class="anchor" id="line-38-5"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">ttl</span>=<span class="Number">300</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_39">  39</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_39"></span><span class="anchor" id="line-39-5"></span>        <span class="ResWord">self</span>.<span class="ID">ttl</span> = <span class="ID">ttl</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_40">  40</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_40"></span><span class="anchor" id="line-40-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_41">  41</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_41"></span><span class="anchor" id="line-41-5"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, <span class="ID">fget</span>, <span class="ID">doc</span>=<span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_42">  42</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_42"></span><span class="anchor" id="line-42-4"></span>        <span class="ResWord">self</span>.<span class="ID">fget</span> = <span class="ID">fget</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_43">  43</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_43"></span><span class="anchor" id="line-43-4"></span>        <span class="ResWord">self</span>.<span class="ID">__doc__</span> = <span class="ID">doc</span> <span class="ResWord">or</span> <span class="ID">fget</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_44">  44</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_44"></span><span class="anchor" id="line-44-4"></span>        <span class="ResWord">self</span>.<span class="ID">__name__</span> = <span class="ID">fget</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_45">  45</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_45"></span><span class="anchor" id="line-45-4"></span>        <span class="ResWord">self</span>.<span class="ID">__module__</span> = <span class="ID">fget</span>.<span class="ID">__module__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_46">  46</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_46"></span><span class="anchor" id="line-46-4"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_47">  47</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_47"></span><span class="anchor" id="line-47-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_48">  48</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_48"></span><span class="anchor" id="line-48-3"></span>    <span class="ResWord">def</span> <span class="ID">__get__</span>(<span class="ResWord">self</span>, <span class="ID">inst</span>, <span class="ID">owner</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_49">  49</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_49"></span><span class="anchor" id="line-49-3"></span>        <span class="ID">now</span> = <span class="ID">time</span>.<span class="ID">time</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_50">  50</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_50"></span><span class="anchor" id="line-50-2"></span>        <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_51">  51</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_51"></span><span class="anchor" id="line-51-2"></span>            <span class="ID">value</span>, <span class="ID">last_update</span> = <span class="ID">inst</span>.<span class="ID">_cache</span>[<span class="ResWord">self</span>.<span class="ID">__name__</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_52">  52</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_52"></span><span class="anchor" id="line-52-2"></span>            <span class="ResWord">if</span> <span class="ResWord">self</span>.<span class="ID">ttl</span> &gt; <span class="Number">0</span> <span class="ResWord">and</span> <span class="ID">now</span> - <span class="ID">last_update</span> &gt; <span class="ResWord">self</span>.<span class="ID">ttl</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_53">  53</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_53"></span><span class="anchor" id="line-53-2"></span>                <span class="ResWord">raise</span> <span class="ID">AttributeError</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_54">  54</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_54"></span><span class="anchor" id="line-54-2"></span>        <span class="ResWord">except</span> (<span class="ID">KeyError</span>, <span class="ID">AttributeError</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_55">  55</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_55"></span><span class="anchor" id="line-55-2"></span>            <span class="ID">value</span> = <span class="ResWord">self</span>.<span class="ID">fget</span>(<span class="ID">inst</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_56">  56</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_56"></span><span class="anchor" id="line-56-2"></span>            <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_57">  57</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_57"></span><span class="anchor" id="line-57-2"></span>                <span class="ID">cache</span> = <span class="ID">inst</span>.<span class="ID">_cache</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_58">  58</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_58"></span><span class="anchor" id="line-58-2"></span>            <span class="ResWord">except</span> <span class="ID">AttributeError</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_59">  59</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_59"></span><span class="anchor" id="line-59-2"></span>                <span class="ID">cache</span> = <span class="ID">inst</span>.<span class="ID">_cache</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_60">  60</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_60"></span><span class="anchor" id="line-60-2"></span>            <span class="ID">cache</span>[<span class="ResWord">self</span>.<span class="ID">__name__</span>] = (<span class="ID">value</span>, <span class="ID">now</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_61">  61</a> </span><span class="LineAnchor" id="CA-4c09fabb0a06622faabbd1dffe3b73ea0289be13_61"></span><span class="anchor" id="line-61-2"></span>        <span class="ResWord">return</span> <span class="ID">value</span></span>
</pre></div></div><span class="anchor" id="line-480"></span><p class="line867">
<h2 id="Retry">Retry</h2>
<span class="anchor" id="line-481"></span><p class="line874">Call a function which returns True/False to indicate success or failure. On failure, wait, and try the function again. On repeated failures, wait longer between each successive attempt. If the decorator runs out of attempts, then it gives up and returns False, but you could just as easily raise some exception. <span class="anchor" id="line-482"></span><span class="anchor" id="line-483"></span><p class="line867"><span class="anchor" id="line-484"></span><span class="anchor" id="line-485"></span><span class="anchor" id="line-486"></span><span class="anchor" id="line-487"></span><span class="anchor" id="line-488"></span><span class="anchor" id="line-489"></span><span class="anchor" id="line-490"></span><span class="anchor" id="line-491"></span><span class="anchor" id="line-492"></span><span class="anchor" id="line-493"></span><span class="anchor" id="line-494"></span><span class="anchor" id="line-495"></span><span class="anchor" id="line-496"></span><span class="anchor" id="line-497"></span><span class="anchor" id="line-498"></span><span class="anchor" id="line-499"></span><span class="anchor" id="line-500"></span><span class="anchor" id="line-501"></span><span class="anchor" id="line-502"></span><span class="anchor" id="line-503"></span><span class="anchor" id="line-504"></span><span class="anchor" id="line-505"></span><span class="anchor" id="line-506"></span><span class="anchor" id="line-507"></span><span class="anchor" id="line-508"></span><span class="anchor" id="line-509"></span><span class="anchor" id="line-510"></span><span class="anchor" id="line-511"></span><span class="anchor" id="line-512"></span><span class="anchor" id="line-513"></span><span class="anchor" id="line-514"></span><span class="anchor" id="line-515"></span><span class="anchor" id="line-516"></span><span class="anchor" id="line-517"></span><span class="anchor" id="line-518"></span><span class="anchor" id="line-519"></span><span class="anchor" id="line-520"></span><span class="anchor" id="line-521"></span><span class="anchor" id="line-522"></span><span class="anchor" id="line-523"></span><span class="anchor" id="line-524"></span><span class="anchor" id="line-525"></span><span class="anchor" id="line-1-21"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-901f7a51642f4dbe152097ab6cc66fef32bc555f\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_1">   1</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_1"></span><span class="anchor" id="line-1-22"></span><span class="ResWord">import</span> <span class="ID">time</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_2">   2</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_2"></span><span class="anchor" id="line-2-11"></span><span class="ResWord">import</span> <span class="ID">math</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_3">   3</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_3"></span><span class="anchor" id="line-3-11"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_4">   4</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_4"></span><span class="anchor" id="line-4-11"></span><span class="Comment"># Retry decorator with exponential backoff</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_5">   5</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_5"></span><span class="anchor" id="line-5-11"></span><span class="ResWord">def</span> <span class="ID">retry</span>(<span class="ID">tries</span>, <span class="ID">delay</span>=<span class="Number">3</span>, <span class="ID">backoff</span>=<span class="Number">2</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_6">   6</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_6"></span><span class="anchor" id="line-6-11"></span>  <span class="String">'''Retries a function or method until it returns True.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_7">   7</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_7"></span><span class="anchor" id="line-7-11"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_8">   8</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_8"></span><span class="anchor" id="line-8-11"></span><span class="String">  delay sets the initial delay in seconds, and backoff sets the factor by which</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_9">   9</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_9"></span><span class="anchor" id="line-9-11"></span><span class="String">  the delay should lengthen after each failure. backoff must be greater than 1,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_10">  10</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_10"></span><span class="anchor" id="line-10-11"></span><span class="String">  or else it isn't really a backoff. tries must be at least 0, and delay</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_11">  11</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_11"></span><span class="anchor" id="line-11-9"></span><span class="String">  greater than 0.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_12">  12</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_12"></span><span class="anchor" id="line-12-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_13">  13</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_13"></span><span class="anchor" id="line-13-9"></span>  <span class="ResWord">if</span> <span class="ID">backoff</span> &lt;= <span class="Number">1</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_14">  14</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_14"></span><span class="anchor" id="line-14-9"></span>    <span class="ResWord">raise</span> <span class="ID">ValueError</span>(<span class="String">&quot;</span><span class="String">backoff must be greater than 1</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_15">  15</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_15"></span><span class="anchor" id="line-15-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_16">  16</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_16"></span><span class="anchor" id="line-16-9"></span>  <span class="ID">tries</span> = <span class="ID">math</span>.<span class="ID">floor</span>(<span class="ID">tries</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_17">  17</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_17"></span><span class="anchor" id="line-17-8"></span>  <span class="ResWord">if</span> <span class="ID">tries</span> &lt; <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_18">  18</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_18"></span><span class="anchor" id="line-18-8"></span>    <span class="ResWord">raise</span> <span class="ID">ValueError</span>(<span class="String">&quot;</span><span class="String">tries must be 0 or greater</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_19">  19</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_19"></span><span class="anchor" id="line-19-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_20">  20</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_20"></span><span class="anchor" id="line-20-8"></span>  <span class="ResWord">if</span> <span class="ID">delay</span> &lt;= <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_21">  21</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_21"></span><span class="anchor" id="line-21-8"></span>    <span class="ResWord">raise</span> <span class="ID">ValueError</span>(<span class="String">&quot;</span><span class="String">delay must be greater than 0</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_22">  22</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_22"></span><span class="anchor" id="line-22-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_23">  23</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_23"></span><span class="anchor" id="line-23-8"></span>  <span class="ResWord">def</span> <span class="ID">deco_retry</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_24">  24</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_24"></span><span class="anchor" id="line-24-8"></span>    <span class="ResWord">def</span> <span class="ID">f_retry</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_25">  25</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_25"></span><span class="anchor" id="line-25-8"></span>      <span class="ID">mtries</span>, <span class="ID">mdelay</span> = <span class="ID">tries</span>, <span class="ID">delay</span> <span class="Comment"># make mutable</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_26">  26</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_26"></span><span class="anchor" id="line-26-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_27">  27</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_27"></span><span class="anchor" id="line-27-7"></span>      <span class="ID">rv</span> = <span class="ID">f</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>) <span class="Comment"># first attempt</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_28">  28</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_28"></span><span class="anchor" id="line-28-7"></span>      <span class="ResWord">while</span> <span class="ID">mtries</span> &gt; <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_29">  29</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_29"></span><span class="anchor" id="line-29-7"></span>        <span class="ResWord">if</span> <span class="ID">rv</span> <span class="ResWord">is</span> <span class="ResWord">True</span>: <span class="Comment"># Done on success</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_30">  30</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_30"></span><span class="anchor" id="line-30-7"></span>          <span class="ResWord">return</span> <span class="ResWord">True</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_31">  31</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_31"></span><span class="anchor" id="line-31-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_32">  32</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_32"></span><span class="anchor" id="line-32-7"></span>        <span class="ID">mtries</span> -= <span class="Number">1</span>      <span class="Comment"># consume an attempt</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_33">  33</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_33"></span><span class="anchor" id="line-33-7"></span>        <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="ID">mdelay</span>) <span class="Comment"># wait...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_34">  34</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_34"></span><span class="anchor" id="line-34-7"></span>        <span class="ID">mdelay</span> *= <span class="ID">backoff</span>  <span class="Comment"># make future wait longer</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_35">  35</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_35"></span><span class="anchor" id="line-35-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_36">  36</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_36"></span><span class="anchor" id="line-36-7"></span>        <span class="ID">rv</span> = <span class="ID">f</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>) <span class="Comment"># Try again</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_37">  37</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_37"></span><span class="anchor" id="line-37-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_38">  38</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_38"></span><span class="anchor" id="line-38-6"></span>      <span class="ResWord">return</span> <span class="ResWord">False</span> <span class="Comment"># Ran out of tries :-(</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_39">  39</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_39"></span><span class="anchor" id="line-39-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_40">  40</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_40"></span><span class="anchor" id="line-40-6"></span>    <span class="ResWord">return</span> <span class="ID">f_retry</span> <span class="Comment"># true decorator -&gt; decorated function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_41">  41</a> </span><span class="LineAnchor" id="CA-901f7a51642f4dbe152097ab6cc66fef32bc555f_41"></span><span class="anchor" id="line-41-6"></span>  <span class="ResWord">return</span> <span class="ID">deco_retry</span>  <span class="Comment"># @retry(arg[, ...]) -&gt; true decorator</span></span>
</pre></div></div><span class="anchor" id="line-526"></span><p class="line867">
<h2 id="Pseudo-currying">Pseudo-currying</h2>
<span class="anchor" id="line-527"></span><p class="line874">(FYI you can use functools.partial() to emulate currying (which works even for keyword arguments)) <span class="anchor" id="line-528"></span><span class="anchor" id="line-529"></span><p class="line867"><span class="anchor" id="line-530"></span><span class="anchor" id="line-531"></span><span class="anchor" id="line-532"></span><span class="anchor" id="line-533"></span><span class="anchor" id="line-534"></span><span class="anchor" id="line-535"></span><span class="anchor" id="line-536"></span><span class="anchor" id="line-537"></span><span class="anchor" id="line-538"></span><span class="anchor" id="line-539"></span><span class="anchor" id="line-540"></span><span class="anchor" id="line-541"></span><span class="anchor" id="line-542"></span><span class="anchor" id="line-543"></span><span class="anchor" id="line-544"></span><span class="anchor" id="line-545"></span><span class="anchor" id="line-546"></span><span class="anchor" id="line-547"></span><span class="anchor" id="line-548"></span><span class="anchor" id="line-549"></span><span class="anchor" id="line-550"></span><span class="anchor" id="line-551"></span><span class="anchor" id="line-552"></span><span class="anchor" id="line-553"></span><span class="anchor" id="line-554"></span><span class="anchor" id="line-555"></span><span class="anchor" id="line-556"></span><span class="anchor" id="line-1-23"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_1">   1</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_1"></span><span class="anchor" id="line-1-24"></span><span class="ResWord">class</span> <span class="ID">curried</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_2">   2</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_2"></span><span class="anchor" id="line-2-12"></span>  <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_3">   3</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_3"></span><span class="anchor" id="line-3-12"></span><span class="String">  Decorator that returns a function that keeps returning functions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_4">   4</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_4"></span><span class="anchor" id="line-4-12"></span><span class="String">  until all arguments are supplied; then the original function is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_5">   5</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_5"></span><span class="anchor" id="line-5-12"></span><span class="String">  evaluated.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_6">   6</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_6"></span><span class="anchor" id="line-6-12"></span><span class="String">  '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_7">   7</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_7"></span><span class="anchor" id="line-7-12"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_8">   8</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_8"></span><span class="anchor" id="line-8-12"></span>  <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">func</span>, *<span class="ID">a</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_9">   9</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_9"></span><span class="anchor" id="line-9-12"></span>    <span class="ResWord">self</span>.<span class="ID">func</span> = <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_10">  10</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_10"></span><span class="anchor" id="line-10-12"></span>    <span class="ResWord">self</span>.<span class="ID">args</span> = <span class="ID">a</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_11">  11</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_11"></span><span class="anchor" id="line-11-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_12">  12</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_12"></span><span class="anchor" id="line-12-10"></span>  <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">a</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_13">  13</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_13"></span><span class="anchor" id="line-13-10"></span>    <span class="ID">args</span> = <span class="ResWord">self</span>.<span class="ID">args</span> + <span class="ID">a</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_14">  14</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_14"></span><span class="anchor" id="line-14-10"></span>    <span class="ResWord">if</span> <span class="ResWord">len</span>(<span class="ID">args</span>) &lt; <span class="ResWord">self</span>.<span class="ID">func</span>.<span class="ID">func_code</span>.<span class="ID">co_argcount</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_15">  15</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_15"></span><span class="anchor" id="line-15-10"></span>      <span class="ResWord">return</span> <span class="ID">curried</span>(<span class="ResWord">self</span>.<span class="ID">func</span>, *<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_16">  16</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_16"></span><span class="anchor" id="line-16-10"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_17">  17</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_17"></span><span class="anchor" id="line-17-9"></span>      <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">func</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_18">  18</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_18"></span><span class="anchor" id="line-18-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_19">  19</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_19"></span><span class="anchor" id="line-19-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_20">  20</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_20"></span><span class="anchor" id="line-20-9"></span><span class="ID">@curried</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_21">  21</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_21"></span><span class="anchor" id="line-21-9"></span><span class="ResWord">def</span> <span class="ID">add</span>(<span class="ID">a</span>, <span class="ID">b</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_22">  22</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_22"></span><span class="anchor" id="line-22-9"></span>    <span class="ResWord">return</span> <span class="ID">a</span> + <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_23">  23</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_23"></span><span class="anchor" id="line-23-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_24">  24</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_24"></span><span class="anchor" id="line-24-9"></span><span class="ID">add1</span> = <span class="ID">add</span>(<span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_25">  25</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_25"></span><span class="anchor" id="line-25-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_26">  26</a> </span><span class="LineAnchor" id="CA-d8aaa23d6c3719ecbfafbf1492c720e4de503a97_26"></span><span class="anchor" id="line-26-9"></span><span class="ResWord">print</span> <span class="ID">add1</span>(<span class="Number">2</span>)</span>
</pre></div></div><span class="anchor" id="line-557"></span><p class="line867">
<h2 id="Creating_decorator_with_optional_arguments">Creating decorator with optional arguments</h2>
<span class="anchor" id="line-558"></span><p class="line867"><span class="anchor" id="line-559"></span><span class="anchor" id="line-560"></span><span class="anchor" id="line-561"></span><span class="anchor" id="line-562"></span><span class="anchor" id="line-563"></span><span class="anchor" id="line-564"></span><span class="anchor" id="line-565"></span><span class="anchor" id="line-566"></span><span class="anchor" id="line-567"></span><span class="anchor" id="line-568"></span><span class="anchor" id="line-569"></span><span class="anchor" id="line-570"></span><span class="anchor" id="line-571"></span><span class="anchor" id="line-572"></span><span class="anchor" id="line-573"></span><span class="anchor" id="line-574"></span><span class="anchor" id="line-575"></span><span class="anchor" id="line-576"></span><span class="anchor" id="line-577"></span><span class="anchor" id="line-578"></span><span class="anchor" id="line-579"></span><span class="anchor" id="line-580"></span><span class="anchor" id="line-581"></span><span class="anchor" id="line-582"></span><span class="anchor" id="line-583"></span><span class="anchor" id="line-584"></span><span class="anchor" id="line-585"></span><span class="anchor" id="line-586"></span><span class="anchor" id="line-587"></span><span class="anchor" id="line-588"></span><span class="anchor" id="line-1-25"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-cbf80bf22c9646c17506104028b9a9bc916b5002\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_1">   1</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_1"></span><span class="anchor" id="line-1-26"></span><span class="ResWord">import</span> <span class="ID">functools</span>, <span class="ID">inspect</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_2">   2</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_2"></span><span class="anchor" id="line-2-13"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_3">   3</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_3"></span><span class="anchor" id="line-3-13"></span><span class="ResWord">def</span> <span class="ID">decorator</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_4">   4</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_4"></span><span class="anchor" id="line-4-13"></span>    <span class="String">''' Allow to use decorator either with arguments or not. '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_5">   5</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_5"></span><span class="anchor" id="line-5-13"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_6">   6</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_6"></span><span class="anchor" id="line-6-13"></span>    <span class="ResWord">def</span> <span class="ID">isFuncArg</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_7">   7</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_7"></span><span class="anchor" id="line-7-13"></span>        <span class="ResWord">return</span> <span class="ResWord">len</span>(<span class="ID">args</span>) == <span class="Number">1</span> <span class="ResWord">and</span> <span class="ResWord">len</span>(<span class="ID">kw</span>) == <span class="Number">0</span> <span class="ResWord">and</span> (</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_8">   8</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_8"></span><span class="anchor" id="line-8-13"></span>            <span class="ID">inspect</span>.<span class="ID">isfunction</span>(<span class="ID">args</span>[<span class="Number">0</span>]) <span class="ResWord">or</span> <span class="ResWord">isinstance</span>(<span class="ID">args</span>[<span class="Number">0</span>], <span class="ResWord">type</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_9">   9</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_9"></span><span class="anchor" id="line-9-13"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_10">  10</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_10"></span><span class="anchor" id="line-10-13"></span>    <span class="ResWord">if</span> <span class="ResWord">isinstance</span>(<span class="ID">func</span>, <span class="ResWord">type</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_11">  11</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_11"></span><span class="anchor" id="line-11-11"></span>        <span class="ResWord">def</span> <span class="ID">class_wrapper</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_12">  12</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_12"></span><span class="anchor" id="line-12-11"></span>            <span class="ResWord">if</span> <span class="ID">isFuncArg</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_13">  13</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_13"></span><span class="anchor" id="line-13-11"></span>                <span class="ResWord">return</span> <span class="ID">func</span>()(*<span class="ID">args</span>, **<span class="ID">kw</span>) <span class="Comment"># create class before usage</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_14">  14</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_14"></span><span class="anchor" id="line-14-11"></span>            <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_15">  15</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_15"></span><span class="anchor" id="line-15-11"></span>        <span class="ID">class_wrapper</span>.<span class="ID">__name__</span> = <span class="ID">func</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_16">  16</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_16"></span><span class="anchor" id="line-16-11"></span>        <span class="ID">class_wrapper</span>.<span class="ID">__module__</span> = <span class="ID">func</span>.<span class="ID">__module__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_17">  17</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_17"></span><span class="anchor" id="line-17-10"></span>        <span class="ResWord">return</span> <span class="ID">class_wrapper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_18">  18</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_18"></span><span class="anchor" id="line-18-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_19">  19</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_19"></span><span class="anchor" id="line-19-10"></span>    <span class="ID">@functools.wraps</span>(<span class="ID">func</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_20">  20</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_20"></span><span class="anchor" id="line-20-10"></span>    <span class="ResWord">def</span> <span class="ID">func_wrapper</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_21">  21</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_21"></span><span class="anchor" id="line-21-10"></span>        <span class="ResWord">if</span> <span class="ID">isFuncArg</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_22">  22</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_22"></span><span class="anchor" id="line-22-10"></span>            <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_23">  23</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_23"></span><span class="anchor" id="line-23-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_24">  24</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_24"></span><span class="anchor" id="line-24-10"></span>        <span class="ResWord">def</span> <span class="ID">functor</span>(<span class="ID">userFunc</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_25">  25</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_25"></span><span class="anchor" id="line-25-10"></span>            <span class="ResWord">return</span> <span class="ID">func</span>(<span class="ID">userFunc</span>, *<span class="ID">args</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_26">  26</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_26"></span><span class="anchor" id="line-26-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_27">  27</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_27"></span><span class="anchor" id="line-27-8"></span>        <span class="ResWord">return</span> <span class="ID">functor</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_28">  28</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_28"></span><span class="anchor" id="line-28-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-cbf80bf22c9646c17506104028b9a9bc916b5002_29">  29</a> </span><span class="LineAnchor" id="CA-cbf80bf22c9646c17506104028b9a9bc916b5002_29"></span><span class="anchor" id="line-29-8"></span>    <span class="ResWord">return</span> <span class="ID">func_wrapper</span></span>
</pre></div></div><span class="anchor" id="line-589"></span><p class="line874">Example: <span class="anchor" id="line-590"></span><span class="anchor" id="line-591"></span><p class="line867"><span class="anchor" id="line-592"></span><span class="anchor" id="line-593"></span><span class="anchor" id="line-594"></span><span class="anchor" id="line-595"></span><span class="anchor" id="line-596"></span><span class="anchor" id="line-597"></span><span class="anchor" id="line-598"></span><span class="anchor" id="line-599"></span><span class="anchor" id="line-600"></span><span class="anchor" id="line-601"></span><span class="anchor" id="line-602"></span><span class="anchor" id="line-603"></span><span class="anchor" id="line-604"></span><span class="anchor" id="line-605"></span><span class="anchor" id="line-606"></span><span class="anchor" id="line-607"></span><span class="anchor" id="line-608"></span><span class="anchor" id="line-609"></span><span class="anchor" id="line-610"></span><span class="anchor" id="line-611"></span><span class="anchor" id="line-612"></span><span class="anchor" id="line-613"></span><span class="anchor" id="line-614"></span><span class="anchor" id="line-615"></span><span class="anchor" id="line-616"></span><span class="anchor" id="line-617"></span><span class="anchor" id="line-618"></span><span class="anchor" id="line-619"></span><span class="anchor" id="line-1-27"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-5a4140dd9753641b2bc8648819770d22ab132306\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-5a4140dd9753641b2bc8648819770d22ab132306" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_1">   1</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_1"></span><span class="anchor" id="line-1-28"></span><span class="ID">@decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_2">   2</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_2"></span><span class="anchor" id="line-2-14"></span><span class="ResWord">def</span> <span class="ID">apply</span>(<span class="ID">func</span>, *<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_3">   3</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_3"></span><span class="anchor" id="line-3-14"></span>    <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_4">   4</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_4"></span><span class="anchor" id="line-4-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_5">   5</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_5"></span><span class="anchor" id="line-5-14"></span><span class="ID">@decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_6">   6</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_6"></span><span class="anchor" id="line-6-14"></span><span class="ResWord">class</span> <span class="ID">apply</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_7">   7</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_7"></span><span class="anchor" id="line-7-14"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_8">   8</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_8"></span><span class="anchor" id="line-8-14"></span>        <span class="ResWord">self</span>.<span class="ID">args</span> = <span class="ID">args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_9">   9</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_9"></span><span class="anchor" id="line-9-14"></span>        <span class="ResWord">self</span>.<span class="ID">kw</span>   = <span class="ID">kw</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_10">  10</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_10"></span><span class="anchor" id="line-10-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_11">  11</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_11"></span><span class="anchor" id="line-11-12"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, <span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_12">  12</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_12"></span><span class="anchor" id="line-12-12"></span>        <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ResWord">self</span>.<span class="ID">args</span>, **<span class="ResWord">self</span>.<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_13">  13</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_13"></span><span class="anchor" id="line-13-12"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_14">  14</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_14"></span><span class="anchor" id="line-14-12"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_15">  15</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_15"></span><span class="anchor" id="line-15-12"></span><span class="Comment"># Usage in both cases:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_16">  16</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_16"></span><span class="anchor" id="line-16-12"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_17">  17</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_17"></span><span class="anchor" id="line-17-11"></span><span class="ID">@apply</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_18">  18</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_18"></span><span class="anchor" id="line-18-11"></span><span class="ResWord">def</span> <span class="ID">test</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_19">  19</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_19"></span><span class="anchor" id="line-19-11"></span>    <span class="ResWord">return</span> <span class="String">'</span><span class="String">test</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_20">  20</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_20"></span><span class="anchor" id="line-20-11"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_21">  21</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_21"></span><span class="anchor" id="line-21-11"></span><span class="ResWord">assert</span> <span class="ID">test</span> == <span class="String">'</span><span class="String">test</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_22">  22</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_22"></span><span class="anchor" id="line-22-11"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_23">  23</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_23"></span><span class="anchor" id="line-23-11"></span><span class="ID">@apply</span>(<span class="Number">2</span>, <span class="Number">3</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_24">  24</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_24"></span><span class="anchor" id="line-24-11"></span><span class="ResWord">def</span> <span class="ID">test</span>(<span class="ID">a</span>, <span class="ID">b</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_25">  25</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_25"></span><span class="anchor" id="line-25-11"></span>    <span class="ResWord">return</span> <span class="ID">a</span> + <span class="ID">b</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_26">  26</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_26"></span><span class="anchor" id="line-26-11"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5a4140dd9753641b2bc8648819770d22ab132306_27">  27</a> </span><span class="LineAnchor" id="CA-5a4140dd9753641b2bc8648819770d22ab132306_27"></span><span class="anchor" id="line-27-9"></span><span class="ResWord">assert</span> <span class="ID">test</span> <span class="ResWord">is</span> <span class="Number">5</span></span>
</pre></div></div><span class="anchor" id="line-620"></span><p class="line874">Note: There is only one drawback: wrapper checks its arguments for single function or class. To avoid wrong behavior you can use keyword arguments instead of positional, e.g.: <span class="anchor" id="line-621"></span><span class="anchor" id="line-622"></span><p class="line867"><span class="anchor" id="line-623"></span><span class="anchor" id="line-624"></span><span class="anchor" id="line-625"></span><span class="anchor" id="line-626"></span><span class="anchor" id="line-1-29"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-3cf3b0315527b4428fdf81a02c5fa0dd5878c975\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-3cf3b0315527b4428fdf81a02c5fa0dd5878c975" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-3cf3b0315527b4428fdf81a02c5fa0dd5878c975_1">   1</a> </span><span class="LineAnchor" id="CA-3cf3b0315527b4428fdf81a02c5fa0dd5878c975_1"></span><span class="anchor" id="line-1-30"></span><span class="ID">@decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3cf3b0315527b4428fdf81a02c5fa0dd5878c975_2">   2</a> </span><span class="LineAnchor" id="CA-3cf3b0315527b4428fdf81a02c5fa0dd5878c975_2"></span><span class="anchor" id="line-2-15"></span><span class="ResWord">def</span> <span class="ID">my_property</span>(<span class="ID">getter</span>, *, <span class="ID">setter</span>=<span class="ResWord">None</span>, <span class="ID">deleter</span>=<span class="ResWord">None</span>, <span class="ID">doc</span>=<span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3cf3b0315527b4428fdf81a02c5fa0dd5878c975_3">   3</a> </span><span class="LineAnchor" id="CA-3cf3b0315527b4428fdf81a02c5fa0dd5878c975_3"></span><span class="anchor" id="line-3-15"></span>    <span class="ResWord">return</span> <span class="ResWord">property</span>(<span class="ID">getter</span>, <span class="ID">setter</span>, <span class="ID">deleter</span>, <span class="ID">doc</span>)</span>
</pre></div></div><span class="anchor" id="line-627"></span><p class="line867">
<h2 id="Controllable_DIY_debug">Controllable DIY debug</h2>
<span class="anchor" id="line-628"></span><p class="line874">(Other hooks could be similarly added. Docstrings and exceptions are left out for simplicity of demonstration.) <span class="anchor" id="line-629"></span><span class="anchor" id="line-630"></span><p class="line867"><span class="anchor" id="line-631"></span><span class="anchor" id="line-632"></span><span class="anchor" id="line-633"></span><span class="anchor" id="line-634"></span><span class="anchor" id="line-635"></span><span class="anchor" id="line-636"></span><span class="anchor" id="line-637"></span><span class="anchor" id="line-638"></span><span class="anchor" id="line-639"></span><span class="anchor" id="line-640"></span><span class="anchor" id="line-641"></span><span class="anchor" id="line-642"></span><span class="anchor" id="line-643"></span><span class="anchor" id="line-644"></span><span class="anchor" id="line-645"></span><span class="anchor" id="line-646"></span><span class="anchor" id="line-647"></span><span class="anchor" id="line-648"></span><span class="anchor" id="line-649"></span><span class="anchor" id="line-650"></span><span class="anchor" id="line-651"></span><span class="anchor" id="line-652"></span><span class="anchor" id="line-653"></span><span class="anchor" id="line-654"></span><span class="anchor" id="line-655"></span><span class="anchor" id="line-656"></span><span class="anchor" id="line-657"></span><span class="anchor" id="line-658"></span><span class="anchor" id="line-659"></span><span class="anchor" id="line-660"></span><span class="anchor" id="line-661"></span><span class="anchor" id="line-662"></span><span class="anchor" id="line-663"></span><span class="anchor" id="line-664"></span><span class="anchor" id="line-1-31"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-0665a89d3e470bec22ad0dec0941056100be3791\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-0665a89d3e470bec22ad0dec0941056100be3791" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_1">   1</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_1"></span><span class="anchor" id="line-1-32"></span><span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_2">   2</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_2"></span><span class="anchor" id="line-2-16"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_3">   3</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_3"></span><span class="anchor" id="line-3-16"></span><span class="ID">WHAT_TO_DEBUG</span> = <span class="ResWord">set</span>([<span class="String">'</span><span class="String">io</span><span class="String">'</span>, <span class="String">'</span><span class="String">core</span><span class="String">'</span>])  <span class="Comment"># change to what you need</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_4">   4</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_4"></span><span class="anchor" id="line-4-15"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_5">   5</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_5"></span><span class="anchor" id="line-5-15"></span><span class="ResWord">class</span> <span class="ID">debug</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_6">   6</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_6"></span><span class="anchor" id="line-6-15"></span>    <span class="String">'''Decorator which helps to control what aspects of a program to debug</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_7">   7</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_7"></span><span class="anchor" id="line-7-15"></span><span class="String">    on per-function basis. Aspects are provided as list of arguments.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_8">   8</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_8"></span><span class="anchor" id="line-8-15"></span><span class="String">    It DOESN'T slowdown functions which aren't supposed to be debugged.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_9">   9</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_9"></span><span class="anchor" id="line-9-15"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_10">  10</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_10"></span><span class="anchor" id="line-10-15"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">aspects</span>=<span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_11">  11</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_11"></span><span class="anchor" id="line-11-13"></span>        <span class="ResWord">self</span>.<span class="ID">aspects</span> = <span class="ResWord">set</span>(<span class="ID">aspects</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_12">  12</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_12"></span><span class="anchor" id="line-12-13"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_13">  13</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_13"></span><span class="anchor" id="line-13-13"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, <span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_14">  14</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_14"></span><span class="anchor" id="line-14-13"></span>        <span class="ResWord">if</span> <span class="ResWord">self</span>.<span class="ID">aspects</span> &amp; <span class="ID">WHAT_TO_DEBUG</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_15">  15</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_15"></span><span class="anchor" id="line-15-13"></span>            <span class="ResWord">def</span> <span class="ID">newf</span>(*<span class="ID">args</span>, **<span class="ID">kwds</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_16">  16</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_16"></span><span class="anchor" id="line-16-13"></span>                <span class="ResWord">print</span> &gt;&gt; <span class="ID">sys</span>.<span class="ID">stderr</span>, <span class="ID">f</span>.<span class="ID">func_name</span>, <span class="ID">args</span>, <span class="ID">kwds</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_17">  17</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_17"></span><span class="anchor" id="line-17-12"></span>                <span class="ID">f_result</span> = <span class="ID">f</span>(*<span class="ID">args</span>, **<span class="ID">kwds</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_18">  18</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_18"></span><span class="anchor" id="line-18-12"></span>                <span class="ResWord">print</span> &gt;&gt; <span class="ID">sys</span>.<span class="ID">stderr</span>, <span class="ID">f</span>.<span class="ID">func_name</span>, <span class="String">&quot;</span><span class="String">returned</span><span class="String">&quot;</span>, <span class="ID">f_result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_19">  19</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_19"></span><span class="anchor" id="line-19-12"></span>                <span class="ResWord">return</span> <span class="ID">f_result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_20">  20</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_20"></span><span class="anchor" id="line-20-12"></span>            <span class="ID">newf</span>.<span class="ID">__doc__</span> = <span class="ID">f</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_21">  21</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_21"></span><span class="anchor" id="line-21-12"></span>            <span class="ResWord">return</span> <span class="ID">newf</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_22">  22</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_22"></span><span class="anchor" id="line-22-12"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_23">  23</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_23"></span><span class="anchor" id="line-23-12"></span>            <span class="ResWord">return</span> <span class="ID">f</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_24">  24</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_24"></span><span class="anchor" id="line-24-12"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_25">  25</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_25"></span><span class="anchor" id="line-25-12"></span><span class="ID">@debug</span>([<span class="String">'</span><span class="String">io</span><span class="String">'</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_26">  26</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_26"></span><span class="anchor" id="line-26-12"></span><span class="ResWord">def</span> <span class="ID">prn</span>(<span class="ID">x</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_27">  27</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_27"></span><span class="anchor" id="line-27-10"></span>    <span class="ResWord">print</span> <span class="ID">x</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_28">  28</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_28"></span><span class="anchor" id="line-28-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_29">  29</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_29"></span><span class="anchor" id="line-29-9"></span><span class="ID">@debug</span>([<span class="String">'</span><span class="String">core</span><span class="String">'</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_30">  30</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_30"></span><span class="anchor" id="line-30-8"></span><span class="ResWord">def</span> <span class="ID">mult</span>(<span class="ID">x</span>, <span class="ID">y</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_31">  31</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_31"></span><span class="anchor" id="line-31-8"></span>    <span class="ResWord">return</span> <span class="ID">x</span> * <span class="ID">y</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_32">  32</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_32"></span><span class="anchor" id="line-32-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0665a89d3e470bec22ad0dec0941056100be3791_33">  33</a> </span><span class="LineAnchor" id="CA-0665a89d3e470bec22ad0dec0941056100be3791_33"></span><span class="anchor" id="line-33-8"></span><span class="ID">prn</span>(<span class="ID">mult</span>(<span class="Number">2</span>, <span class="Number">2</span>))</span>
</pre></div></div><span class="anchor" id="line-665"></span><p class="line867">
<h2 id="Easy_adding_methods_to_a_class_instance">Easy adding methods to a class instance</h2>
<span class="anchor" id="line-666"></span><p class="line874">Credits to John Roth. <span class="anchor" id="line-667"></span><span class="anchor" id="line-668"></span><p class="line867"><span class="anchor" id="line-669"></span><span class="anchor" id="line-670"></span><span class="anchor" id="line-671"></span><span class="anchor" id="line-672"></span><span class="anchor" id="line-673"></span><span class="anchor" id="line-674"></span><span class="anchor" id="line-675"></span><span class="anchor" id="line-676"></span><span class="anchor" id="line-677"></span><span class="anchor" id="line-678"></span><span class="anchor" id="line-679"></span><span class="anchor" id="line-680"></span><span class="anchor" id="line-681"></span><span class="anchor" id="line-682"></span><span class="anchor" id="line-683"></span><span class="anchor" id="line-684"></span><span class="anchor" id="line-685"></span><span class="anchor" id="line-686"></span><span class="anchor" id="line-687"></span><span class="anchor" id="line-688"></span><span class="anchor" id="line-1-33"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_1">   1</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_1"></span><span class="anchor" id="line-1-34"></span><span class="ResWord">class</span> <span class="ID">Foo</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_2">   2</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_2"></span><span class="anchor" id="line-2-17"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_3">   3</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_3"></span><span class="anchor" id="line-3-17"></span>        <span class="ResWord">self</span>.<span class="ID">x</span> = <span class="Number">42</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_4">   4</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_4"></span><span class="anchor" id="line-4-16"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_5">   5</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_5"></span><span class="anchor" id="line-5-16"></span><span class="ID">foo</span> = <span class="ID">Foo</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_6">   6</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_6"></span><span class="anchor" id="line-6-16"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_7">   7</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_7"></span><span class="anchor" id="line-7-16"></span><span class="ResWord">def</span> <span class="ID">addto</span>(<span class="ID">instance</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_8">   8</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_8"></span><span class="anchor" id="line-8-16"></span>    <span class="ResWord">def</span> <span class="ID">decorator</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_9">   9</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_9"></span><span class="anchor" id="line-9-16"></span>        <span class="ResWord">import</span> <span class="ID">types</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_10">  10</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_10"></span><span class="anchor" id="line-10-16"></span>        <span class="ID">f</span> = <span class="ID">types</span>.<span class="ID">MethodType</span>(<span class="ID">f</span>, <span class="ID">instance</span>, <span class="ID">instance</span>.<span class="ID">__class__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_11">  11</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_11"></span><span class="anchor" id="line-11-14"></span>        <span class="ResWord">setattr</span>(<span class="ID">instance</span>, <span class="ID">f</span>.<span class="ID">func_name</span>, <span class="ID">f</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_12">  12</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_12"></span><span class="anchor" id="line-12-14"></span>        <span class="ResWord">return</span> <span class="ID">f</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_13">  13</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_13"></span><span class="anchor" id="line-13-14"></span>    <span class="ResWord">return</span> <span class="ID">decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_14">  14</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_14"></span><span class="anchor" id="line-14-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_15">  15</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_15"></span><span class="anchor" id="line-15-14"></span><span class="ID">@addto</span>(<span class="ID">foo</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_16">  16</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_16"></span><span class="anchor" id="line-16-14"></span><span class="ResWord">def</span> <span class="ID">print_x</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_17">  17</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_17"></span><span class="anchor" id="line-17-13"></span>    <span class="ResWord">print</span> <span class="ResWord">self</span>.<span class="ID">x</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_18">  18</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_18"></span><span class="anchor" id="line-18-13"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_19">  19</a> </span><span class="LineAnchor" id="CA-c6c177d9b14e7d0fa4b1ecf40448e7f834158ca2_19"></span><span class="anchor" id="line-19-13"></span><span class="Comment"># foo.print_x() would print &quot;42&quot;</span></span>
</pre></div></div><span class="anchor" id="line-689"></span><p class="line867">
<h2 id="Counting_function_calls">Counting function calls</h2>
<span class="anchor" id="line-690"></span><p class="line867"><span class="anchor" id="line-691"></span><span class="anchor" id="line-692"></span><span class="anchor" id="line-693"></span><span class="anchor" id="line-694"></span><span class="anchor" id="line-695"></span><span class="anchor" id="line-696"></span><span class="anchor" id="line-697"></span><span class="anchor" id="line-698"></span><span class="anchor" id="line-699"></span><span class="anchor" id="line-700"></span><span class="anchor" id="line-701"></span><span class="anchor" id="line-702"></span><span class="anchor" id="line-703"></span><span class="anchor" id="line-704"></span><span class="anchor" id="line-705"></span><span class="anchor" id="line-706"></span><span class="anchor" id="line-707"></span><span class="anchor" id="line-708"></span><span class="anchor" id="line-709"></span><span class="anchor" id="line-710"></span><span class="anchor" id="line-711"></span><span class="anchor" id="line-712"></span><span class="anchor" id="line-713"></span><span class="anchor" id="line-714"></span><span class="anchor" id="line-1-35"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_1">   1</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_1"></span><span class="anchor" id="line-1-36"></span><span class="ResWord">class</span> <span class="ID">countcalls</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_2">   2</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_2"></span><span class="anchor" id="line-2-18"></span>   <span class="String">&quot;</span><span class="String">Decorator that keeps track of the number of times a function is called.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_3">   3</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_3"></span><span class="anchor" id="line-3-18"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_4">   4</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_4"></span><span class="anchor" id="line-4-17"></span>   <span class="ID">__instances</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_5">   5</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_5"></span><span class="anchor" id="line-5-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_6">   6</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_6"></span><span class="anchor" id="line-6-17"></span>   <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_7">   7</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_7"></span><span class="anchor" id="line-7-17"></span>      <span class="ResWord">self</span>.<span class="ID">__f</span> = <span class="ID">f</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_8">   8</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_8"></span><span class="anchor" id="line-8-17"></span>      <span class="ResWord">self</span>.<span class="ID">__numcalls</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_9">   9</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_9"></span><span class="anchor" id="line-9-17"></span>      <span class="ID">countcalls</span>.<span class="ID">__instances</span>[<span class="ID">f</span>] = <span class="ResWord">self</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_10">  10</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_10"></span><span class="anchor" id="line-10-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_11">  11</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_11"></span><span class="anchor" id="line-11-15"></span>   <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_12">  12</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_12"></span><span class="anchor" id="line-12-15"></span>      <span class="ResWord">self</span>.<span class="ID">__numcalls</span> += <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_13">  13</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_13"></span><span class="anchor" id="line-13-15"></span>      <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">__f</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_14">  14</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_14"></span><span class="anchor" id="line-14-15"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_15">  15</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_15"></span><span class="anchor" id="line-15-15"></span>   <span class="ID">@staticmethod</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_16">  16</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_16"></span><span class="anchor" id="line-16-15"></span>   <span class="ResWord">def</span> <span class="ID">count</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_17">  17</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_17"></span><span class="anchor" id="line-17-14"></span>      <span class="String">&quot;</span><span class="String">Return the number of times the function f was called.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_18">  18</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_18"></span><span class="anchor" id="line-18-14"></span>      <span class="ResWord">return</span> <span class="ID">countcalls</span>.<span class="ID">__instances</span>[<span class="ID">f</span>].<span class="ID">__numcalls</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_19">  19</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_19"></span><span class="anchor" id="line-19-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_20">  20</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_20"></span><span class="anchor" id="line-20-13"></span>   <span class="ID">@staticmethod</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_21">  21</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_21"></span><span class="anchor" id="line-21-13"></span>   <span class="ResWord">def</span> <span class="ID">counts</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_22">  22</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_22"></span><span class="anchor" id="line-22-13"></span>      <span class="String">&quot;</span><span class="String">Return a dict of {function: # of calls} for all registered functions.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_23">  23</a> </span><span class="LineAnchor" id="CA-f453d62ae8a68d33529a448cbbfbb3b1f4fc4d7c_23"></span><span class="anchor" id="line-23-13"></span>      <span class="ResWord">return</span> <span class="ResWord">dict</span>([(<span class="ID">f</span>, <span class="ID">countcalls</span>.<span class="ID">count</span>(<span class="ID">f</span>)) <span class="ResWord">for</span> <span class="ID">f</span> <span class="ResWord">in</span> <span class="ID">countcalls</span>.<span class="ID">__instances</span>])</span>
</pre></div></div><span class="anchor" id="line-715"></span><p class="line867">
<h2 id="Alternate_Counting_function_calls">Alternate Counting function calls</h2>
<span class="anchor" id="line-716"></span><p class="line867"><span class="anchor" id="line-717"></span><span class="anchor" id="line-718"></span><span class="anchor" id="line-719"></span><span class="anchor" id="line-720"></span><span class="anchor" id="line-721"></span><span class="anchor" id="line-722"></span><span class="anchor" id="line-723"></span><span class="anchor" id="line-724"></span><span class="anchor" id="line-725"></span><span class="anchor" id="line-726"></span><span class="anchor" id="line-727"></span><span class="anchor" id="line-728"></span><span class="anchor" id="line-729"></span><span class="anchor" id="line-730"></span><span class="anchor" id="line-731"></span><span class="anchor" id="line-732"></span><span class="anchor" id="line-733"></span><span class="anchor" id="line-734"></span><span class="anchor" id="line-735"></span><span class="anchor" id="line-736"></span><span class="anchor" id="line-737"></span><span class="anchor" id="line-738"></span><span class="anchor" id="line-739"></span><span class="anchor" id="line-740"></span><span class="anchor" id="line-741"></span><span class="anchor" id="line-742"></span><span class="anchor" id="line-743"></span><span class="anchor" id="line-744"></span><span class="anchor" id="line-745"></span><span class="anchor" id="line-746"></span><span class="anchor" id="line-747"></span><span class="anchor" id="line-748"></span><span class="anchor" id="line-749"></span><span class="anchor" id="line-750"></span><span class="anchor" id="line-751"></span><span class="anchor" id="line-752"></span><span class="anchor" id="line-753"></span><span class="anchor" id="line-754"></span><span class="anchor" id="line-755"></span><span class="anchor" id="line-756"></span><span class="anchor" id="line-757"></span><span class="anchor" id="line-1-37"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-85dd1e36314663d895b64d7345064c69abeb1793\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-85dd1e36314663d895b64d7345064c69abeb1793" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_1">   1</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_1"></span><span class="anchor" id="line-1-38"></span><span class="ResWord">class</span> <span class="ID">countcalls</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_2">   2</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_2"></span><span class="anchor" id="line-2-19"></span>   <span class="String">&quot;</span><span class="String">Decorator that keeps track of the number of times a function is called.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_3">   3</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_3"></span><span class="anchor" id="line-3-19"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_4">   4</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_4"></span><span class="anchor" id="line-4-18"></span>   <span class="ID">__instances</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_5">   5</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_5"></span><span class="anchor" id="line-5-18"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_6">   6</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_6"></span><span class="anchor" id="line-6-18"></span>   <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_7">   7</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_7"></span><span class="anchor" id="line-7-18"></span>      <span class="ResWord">self</span>.<span class="ID">__f</span> = <span class="ID">f</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_8">   8</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_8"></span><span class="anchor" id="line-8-18"></span>      <span class="ResWord">self</span>.<span class="ID">__numcalls</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_9">   9</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_9"></span><span class="anchor" id="line-9-18"></span>      <span class="ID">countcalls</span>.<span class="ID">__instances</span>[<span class="ID">f</span>] = <span class="ResWord">self</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_10">  10</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_10"></span><span class="anchor" id="line-10-18"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_11">  11</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_11"></span><span class="anchor" id="line-11-16"></span>   <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_12">  12</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_12"></span><span class="anchor" id="line-12-16"></span>      <span class="ResWord">self</span>.<span class="ID">__numcalls</span> += <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_13">  13</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_13"></span><span class="anchor" id="line-13-16"></span>      <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">__f</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_14">  14</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_14"></span><span class="anchor" id="line-14-16"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_15">  15</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_15"></span><span class="anchor" id="line-15-16"></span>   <span class="ResWord">def</span> <span class="ID">count</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_16">  16</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_16"></span><span class="anchor" id="line-16-16"></span>      <span class="String">&quot;</span><span class="String">Return the number of times the function f was called.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_17">  17</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_17"></span><span class="anchor" id="line-17-15"></span>      <span class="ResWord">return</span> <span class="ID">countcalls</span>.<span class="ID">__instances</span>[<span class="ResWord">self</span>.<span class="ID">__f</span>].<span class="ID">__numcalls</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_18">  18</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_18"></span><span class="anchor" id="line-18-15"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_19">  19</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_19"></span><span class="anchor" id="line-19-15"></span>   <span class="ID">@staticmethod</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_20">  20</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_20"></span><span class="anchor" id="line-20-14"></span>   <span class="ResWord">def</span> <span class="ID">counts</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_21">  21</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_21"></span><span class="anchor" id="line-21-14"></span>      <span class="String">&quot;</span><span class="String">Return a dict of {function: # of calls} for all registered functions.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_22">  22</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_22"></span><span class="anchor" id="line-22-14"></span>      <span class="ResWord">return</span> <span class="ResWord">dict</span>([(<span class="ID">f</span>.<span class="ID">__name__</span>, <span class="ID">countcalls</span>.<span class="ID">__instances</span>[<span class="ID">f</span>].<span class="ID">__numcalls</span>) <span class="ResWord">for</span> <span class="ID">f</span> <span class="ResWord">in</span> <span class="ID">countcalls</span>.<span class="ID">__instances</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_23">  23</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_23"></span><span class="anchor" id="line-23-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_24">  24</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_24"></span><span class="anchor" id="line-24-13"></span><span class="Comment">#example</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_25">  25</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_25"></span><span class="anchor" id="line-25-13"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_26">  26</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_26"></span><span class="anchor" id="line-26-13"></span><span class="ID">@countcalls</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_27">  27</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_27"></span><span class="anchor" id="line-27-11"></span><span class="ResWord">def</span> <span class="ID">f</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_28">  28</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_28"></span><span class="anchor" id="line-28-10"></span>   <span class="ResWord">print</span> <span class="String">'</span><span class="String">f called</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_29">  29</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_29"></span><span class="anchor" id="line-29-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_30">  30</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_30"></span><span class="anchor" id="line-30-9"></span><span class="ID">@countcalls</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_31">  31</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_31"></span><span class="anchor" id="line-31-9"></span><span class="ResWord">def</span> <span class="ID">g</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_32">  32</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_32"></span><span class="anchor" id="line-32-9"></span>   <span class="ResWord">print</span> <span class="String">'</span><span class="String">g called</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_33">  33</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_33"></span><span class="anchor" id="line-33-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_34">  34</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_34"></span><span class="anchor" id="line-34-8"></span><span class="ID">f</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_35">  35</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_35"></span><span class="anchor" id="line-35-8"></span><span class="ID">f</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_36">  36</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_36"></span><span class="anchor" id="line-36-8"></span><span class="ID">f</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_37">  37</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_37"></span><span class="anchor" id="line-37-8"></span><span class="ResWord">print</span> <span class="ID">f</span>.<span class="ID">count</span>() <span class="Comment"># prints 3</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_38">  38</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_38"></span><span class="anchor" id="line-38-7"></span><span class="ResWord">print</span> <span class="ID">countcalls</span>.<span class="ID">counts</span>() <span class="Comment"># same as f.counts() or g.counts()</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_39">  39</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_39"></span><span class="anchor" id="line-39-7"></span><span class="ID">g</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-85dd1e36314663d895b64d7345064c69abeb1793_40">  40</a> </span><span class="LineAnchor" id="CA-85dd1e36314663d895b64d7345064c69abeb1793_40"></span><span class="anchor" id="line-40-7"></span><span class="ResWord">print</span> <span class="ID">g</span>.<span class="ID">count</span>() <span class="Comment"># prints 1</span></span>
</pre></div></div><span class="anchor" id="line-758"></span><p class="line867">
<h2 id="Generating_Deprecation_Warnings">Generating Deprecation Warnings</h2>
<span class="anchor" id="line-759"></span><p class="line867"><span class="anchor" id="line-760"></span><span class="anchor" id="line-761"></span><span class="anchor" id="line-762"></span><span class="anchor" id="line-763"></span><span class="anchor" id="line-764"></span><span class="anchor" id="line-765"></span><span class="anchor" id="line-766"></span><span class="anchor" id="line-767"></span><span class="anchor" id="line-768"></span><span class="anchor" id="line-769"></span><span class="anchor" id="line-770"></span><span class="anchor" id="line-771"></span><span class="anchor" id="line-772"></span><span class="anchor" id="line-773"></span><span class="anchor" id="line-774"></span><span class="anchor" id="line-775"></span><span class="anchor" id="line-776"></span><span class="anchor" id="line-777"></span><span class="anchor" id="line-778"></span><span class="anchor" id="line-779"></span><span class="anchor" id="line-780"></span><span class="anchor" id="line-781"></span><span class="anchor" id="line-782"></span><span class="anchor" id="line-783"></span><span class="anchor" id="line-784"></span><span class="anchor" id="line-785"></span><span class="anchor" id="line-1-39"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_1">   1</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_1"></span><span class="anchor" id="line-1-40"></span><span class="ResWord">import</span> <span class="ID">warnings</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_2">   2</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_2"></span><span class="anchor" id="line-2-20"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_3">   3</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_3"></span><span class="anchor" id="line-3-20"></span><span class="ResWord">def</span> <span class="ID">deprecated</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_4">   4</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_4"></span><span class="anchor" id="line-4-19"></span>    <span class="String">'''This is a decorator which can be used to mark functions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_5">   5</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_5"></span><span class="anchor" id="line-5-19"></span><span class="String">    as deprecated. It will result in a warning being emitted</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_6">   6</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_6"></span><span class="anchor" id="line-6-19"></span><span class="String">    when the function is used.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_7">   7</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_7"></span><span class="anchor" id="line-7-19"></span>    <span class="ResWord">def</span> <span class="ID">new_func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_8">   8</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_8"></span><span class="anchor" id="line-8-19"></span>        <span class="ID">warnings</span>.<span class="ID">warn</span>(<span class="String">&quot;</span><span class="String">Call to deprecated function {}.</span><span class="String">&quot;</span>.<span class="ID">format</span>(<span class="ID">func</span>.<span class="ID">__name__</span>),</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_9">   9</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_9"></span><span class="anchor" id="line-9-19"></span>                      <span class="ID">category</span>=<span class="ID">DeprecationWarning</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_10">  10</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_10"></span><span class="anchor" id="line-10-19"></span>        <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_11">  11</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_11"></span><span class="anchor" id="line-11-17"></span>    <span class="ID">new_func</span>.<span class="ID">__name__</span> = <span class="ID">func</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_12">  12</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_12"></span><span class="anchor" id="line-12-17"></span>    <span class="ID">new_func</span>.<span class="ID">__doc__</span> = <span class="ID">func</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_13">  13</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_13"></span><span class="anchor" id="line-13-17"></span>    <span class="ID">new_func</span>.<span class="ID">__dict__</span>.<span class="ID">update</span>(<span class="ID">func</span>.<span class="ID">__dict__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_14">  14</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_14"></span><span class="anchor" id="line-14-17"></span>    <span class="ResWord">return</span> <span class="ID">new_func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_15">  15</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_15"></span><span class="anchor" id="line-15-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_16">  16</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_16"></span><span class="anchor" id="line-16-17"></span><span class="Comment"># === Examples of use ===</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_17">  17</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_17"></span><span class="anchor" id="line-17-16"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_18">  18</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_18"></span><span class="anchor" id="line-18-16"></span><span class="ID">@deprecated</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_19">  19</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_19"></span><span class="anchor" id="line-19-16"></span><span class="ResWord">def</span> <span class="ID">some_old_function</span>(<span class="ID">x</span>,<span class="ID">y</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_20">  20</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_20"></span><span class="anchor" id="line-20-15"></span>    <span class="ResWord">return</span> <span class="ID">x</span> + <span class="ID">y</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_21">  21</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_21"></span><span class="anchor" id="line-21-15"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_22">  22</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_22"></span><span class="anchor" id="line-22-15"></span><span class="ResWord">class</span> <span class="ID">SomeClass</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_23">  23</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_23"></span><span class="anchor" id="line-23-15"></span>    <span class="ID">@deprecated</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_24">  24</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_24"></span><span class="anchor" id="line-24-14"></span>    <span class="ResWord">def</span> <span class="ID">some_old_method</span>(<span class="ResWord">self</span>, <span class="ID">x</span>,<span class="ID">y</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_25">  25</a> </span><span class="LineAnchor" id="CA-03ade855b8be998a2a4befd0f5f810b63abcfd7d_25"></span><span class="anchor" id="line-25-14"></span>        <span class="ResWord">return</span> <span class="ID">x</span> + <span class="ID">y</span></span>
</pre></div></div><span class="anchor" id="line-786"></span><p class="line867">
<h2 id="Smart_deprecation_warnings_.28with_valid_filenames.2C_line_numbers.2C_etc..29">Smart deprecation warnings (with valid filenames, line numbers, etc.)</h2>
<span class="anchor" id="line-787"></span><p class="line867"><span class="anchor" id="line-788"></span><span class="anchor" id="line-789"></span><span class="anchor" id="line-790"></span><span class="anchor" id="line-791"></span><span class="anchor" id="line-792"></span><span class="anchor" id="line-793"></span><span class="anchor" id="line-794"></span><span class="anchor" id="line-795"></span><span class="anchor" id="line-796"></span><span class="anchor" id="line-797"></span><span class="anchor" id="line-798"></span><span class="anchor" id="line-799"></span><span class="anchor" id="line-800"></span><span class="anchor" id="line-801"></span><span class="anchor" id="line-802"></span><span class="anchor" id="line-803"></span><span class="anchor" id="line-804"></span><span class="anchor" id="line-805"></span><span class="anchor" id="line-806"></span><span class="anchor" id="line-807"></span><span class="anchor" id="line-808"></span><span class="anchor" id="line-809"></span><span class="anchor" id="line-810"></span><span class="anchor" id="line-811"></span><span class="anchor" id="line-812"></span><span class="anchor" id="line-813"></span><span class="anchor" id="line-814"></span><span class="anchor" id="line-815"></span><span class="anchor" id="line-816"></span><span class="anchor" id="line-817"></span><span class="anchor" id="line-818"></span><span class="anchor" id="line-1-41"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-92953dfd597a5cffc650d5a379452bb3b022cdd0\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_1">   1</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_1"></span><span class="anchor" id="line-1-42"></span><span class="ResWord">import</span> <span class="ID">warnings</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_2">   2</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_2"></span><span class="anchor" id="line-2-21"></span><span class="ResWord">import</span> <span class="ID">functools</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_3">   3</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_3"></span><span class="anchor" id="line-3-21"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_4">   4</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_4"></span><span class="anchor" id="line-4-20"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_5">   5</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_5"></span><span class="anchor" id="line-5-20"></span><span class="ResWord">def</span> <span class="ID">deprecated</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_6">   6</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_6"></span><span class="anchor" id="line-6-20"></span>    <span class="String">'''This is a decorator which can be used to mark functions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_7">   7</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_7"></span><span class="anchor" id="line-7-20"></span><span class="String">    as deprecated. It will result in a warning being emitted</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_8">   8</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_8"></span><span class="anchor" id="line-8-20"></span><span class="String">    when the function is used.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_9">   9</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_9"></span><span class="anchor" id="line-9-20"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_10">  10</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_10"></span><span class="anchor" id="line-10-20"></span>    <span class="ID">@functools.wraps</span>(<span class="ID">func</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_11">  11</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_11"></span><span class="anchor" id="line-11-18"></span>    <span class="ResWord">def</span> <span class="ID">new_func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_12">  12</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_12"></span><span class="anchor" id="line-12-18"></span>        <span class="ID">warnings</span>.<span class="ID">warn_explicit</span>(</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_13">  13</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_13"></span><span class="anchor" id="line-13-18"></span>            <span class="String">&quot;</span><span class="String">Call to deprecated function {}.</span><span class="String">&quot;</span>.<span class="ID">format</span>(<span class="ID">func</span>.<span class="ID">__name__</span>),</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_14">  14</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_14"></span><span class="anchor" id="line-14-18"></span>            <span class="ID">category</span>=<span class="ID">DeprecationWarning</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_15">  15</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_15"></span><span class="anchor" id="line-15-18"></span>            <span class="ID">filename</span>=<span class="ID">func</span>.<span class="ID">func_code</span>.<span class="ID">co_filename</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_16">  16</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_16"></span><span class="anchor" id="line-16-18"></span>            <span class="ID">lineno</span>=<span class="ID">func</span>.<span class="ID">func_code</span>.<span class="ID">co_firstlineno</span> + <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_17">  17</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_17"></span><span class="anchor" id="line-17-17"></span>        )</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_18">  18</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_18"></span><span class="anchor" id="line-18-17"></span>        <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_19">  19</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_19"></span><span class="anchor" id="line-19-17"></span>    <span class="ResWord">return</span> <span class="ID">new_func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_20">  20</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_20"></span><span class="anchor" id="line-20-16"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_21">  21</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_21"></span><span class="anchor" id="line-21-16"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_22">  22</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_22"></span><span class="anchor" id="line-22-16"></span><span class="Comment">## Usage examples ##</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_23">  23</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_23"></span><span class="anchor" id="line-23-16"></span><span class="ID">@deprecated</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_24">  24</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_24"></span><span class="anchor" id="line-24-15"></span><span class="ResWord">def</span> <span class="ID">my_func</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_25">  25</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_25"></span><span class="anchor" id="line-25-15"></span>    <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_26">  26</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_26"></span><span class="anchor" id="line-26-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_27">  27</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_27"></span><span class="anchor" id="line-27-12"></span><span class="ID">@other_decorators_must_be_upper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_28">  28</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_28"></span><span class="anchor" id="line-28-11"></span><span class="ID">@deprecated</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_29">  29</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_29"></span><span class="anchor" id="line-29-11"></span><span class="ResWord">def</span> <span class="ID">my_func</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_30">  30</a> </span><span class="LineAnchor" id="CA-92953dfd597a5cffc650d5a379452bb3b022cdd0_30"></span><span class="anchor" id="line-30-10"></span>    <span class="ResWord">pass</span></span>
</pre></div></div><span class="anchor" id="line-819"></span><p class="line867">
<h2 id="Ignoring_Deprecation_Warnings">Ignoring Deprecation Warnings</h2>
<span class="anchor" id="line-820"></span><p class="line867"><span class="anchor" id="line-821"></span><span class="anchor" id="line-822"></span><span class="anchor" id="line-823"></span><span class="anchor" id="line-824"></span><span class="anchor" id="line-825"></span><span class="anchor" id="line-826"></span><span class="anchor" id="line-827"></span><span class="anchor" id="line-828"></span><span class="anchor" id="line-829"></span><span class="anchor" id="line-830"></span><span class="anchor" id="line-831"></span><span class="anchor" id="line-832"></span><span class="anchor" id="line-833"></span><span class="anchor" id="line-834"></span><span class="anchor" id="line-835"></span><span class="anchor" id="line-836"></span><span class="anchor" id="line-837"></span><span class="anchor" id="line-838"></span><span class="anchor" id="line-839"></span><span class="anchor" id="line-840"></span><span class="anchor" id="line-841"></span><span class="anchor" id="line-842"></span><span class="anchor" id="line-843"></span><span class="anchor" id="line-844"></span><span class="anchor" id="line-845"></span><span class="anchor" id="line-846"></span><span class="anchor" id="line-847"></span><span class="anchor" id="line-1-43"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-3458cae5393c212d5b886a26c779849164214872\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-3458cae5393c212d5b886a26c779849164214872" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_1">   1</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_1"></span><span class="anchor" id="line-1-44"></span><span class="ResWord">import</span> <span class="ID">warnings</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_2">   2</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_2"></span><span class="anchor" id="line-2-22"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_3">   3</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_3"></span><span class="anchor" id="line-3-22"></span><span class="ResWord">def</span> <span class="ID">ignore_deprecation_warnings</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_4">   4</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_4"></span><span class="anchor" id="line-4-21"></span>    <span class="String">'''This is a decorator which can be used to ignore deprecation warnings</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_5">   5</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_5"></span><span class="anchor" id="line-5-21"></span><span class="String">    occurring in a function.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_6">   6</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_6"></span><span class="anchor" id="line-6-21"></span>    <span class="ResWord">def</span> <span class="ID">new_func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_7">   7</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_7"></span><span class="anchor" id="line-7-21"></span>        <span class="ResWord">with</span> <span class="ID">warnings</span>.<span class="ID">catch_warnings</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_8">   8</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_8"></span><span class="anchor" id="line-8-21"></span>            <span class="ID">warnings</span>.<span class="ID">filterwarnings</span>(<span class="String">&quot;</span><span class="String">ignore</span><span class="String">&quot;</span>, <span class="ID">category</span>=<span class="ID">DeprecationWarning</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_9">   9</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_9"></span><span class="anchor" id="line-9-21"></span>            <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_10">  10</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_10"></span><span class="anchor" id="line-10-21"></span>    <span class="ID">new_func</span>.<span class="ID">__name__</span> = <span class="ID">func</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_11">  11</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_11"></span><span class="anchor" id="line-11-19"></span>    <span class="ID">new_func</span>.<span class="ID">__doc__</span> = <span class="ID">func</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_12">  12</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_12"></span><span class="anchor" id="line-12-19"></span>    <span class="ID">new_func</span>.<span class="ID">__dict__</span>.<span class="ID">update</span>(<span class="ID">func</span>.<span class="ID">__dict__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_13">  13</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_13"></span><span class="anchor" id="line-13-19"></span>    <span class="ResWord">return</span> <span class="ID">new_func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_14">  14</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_14"></span><span class="anchor" id="line-14-19"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_15">  15</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_15"></span><span class="anchor" id="line-15-19"></span><span class="Comment"># === Examples of use ===</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_16">  16</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_16"></span><span class="anchor" id="line-16-19"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_17">  17</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_17"></span><span class="anchor" id="line-17-18"></span><span class="ID">@ignore_deprecation_warnings</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_18">  18</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_18"></span><span class="anchor" id="line-18-18"></span><span class="ResWord">def</span> <span class="ID">some_function_raising_deprecation_warning</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_19">  19</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_19"></span><span class="anchor" id="line-19-18"></span>    <span class="ID">warnings</span>.<span class="ID">warn</span>(<span class="String">&quot;</span><span class="String">This is a deprecationg warning.</span><span class="String">&quot;</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_20">  20</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_20"></span><span class="anchor" id="line-20-17"></span>                  <span class="ID">category</span>=<span class="ID">DeprecationWarning</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_21">  21</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_21"></span><span class="anchor" id="line-21-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_22">  22</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_22"></span><span class="anchor" id="line-22-17"></span><span class="ResWord">class</span> <span class="ID">SomeClass</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_23">  23</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_23"></span><span class="anchor" id="line-23-17"></span>    <span class="ID">@ignore_deprecation_warnings</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_24">  24</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_24"></span><span class="anchor" id="line-24-16"></span>    <span class="ResWord">def</span> <span class="ID">some_method_raising_deprecation_warning</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_25">  25</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_25"></span><span class="anchor" id="line-25-16"></span>        <span class="ID">warnings</span>.<span class="ID">warn</span>(<span class="String">&quot;</span><span class="String">This is a deprecationg warning.</span><span class="String">&quot;</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-3458cae5393c212d5b886a26c779849164214872_26">  26</a> </span><span class="LineAnchor" id="CA-3458cae5393c212d5b886a26c779849164214872_26"></span><span class="anchor" id="line-26-15"></span>                      <span class="ID">category</span>=<span class="ID">DeprecationWarning</span>)</span>
</pre></div></div><span class="anchor" id="line-848"></span><p class="line867">
<h2 id="Enable.2FDisable_Decorators">Enable/Disable Decorators</h2>
<span class="anchor" id="line-849"></span><p class="line867"><span class="anchor" id="line-850"></span><span class="anchor" id="line-851"></span><span class="anchor" id="line-852"></span><span class="anchor" id="line-853"></span><span class="anchor" id="line-854"></span><span class="anchor" id="line-855"></span><span class="anchor" id="line-856"></span><span class="anchor" id="line-857"></span><span class="anchor" id="line-858"></span><span class="anchor" id="line-859"></span><span class="anchor" id="line-860"></span><span class="anchor" id="line-861"></span><span class="anchor" id="line-862"></span><span class="anchor" id="line-863"></span><span class="anchor" id="line-864"></span><span class="anchor" id="line-865"></span><span class="anchor" id="line-866"></span><span class="anchor" id="line-867"></span><span class="anchor" id="line-868"></span><span class="anchor" id="line-869"></span><span class="anchor" id="line-870"></span><span class="anchor" id="line-871"></span><span class="anchor" id="line-872"></span><span class="anchor" id="line-873"></span><span class="anchor" id="line-1-45"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-a6aef080c0565c38553d6daea75bc507528028a9\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-a6aef080c0565c38553d6daea75bc507528028a9" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_1">   1</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_1"></span><span class="anchor" id="line-1-46"></span><span class="ResWord">def</span> <span class="ID">unchanged</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_2">   2</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_2"></span><span class="anchor" id="line-2-23"></span>    <span class="String">&quot;</span><span class="String">This decorator doesn</span><span class="String">'</span><span class="String">t add any behavior</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_3">   3</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_3"></span><span class="anchor" id="line-3-23"></span>    <span class="ResWord">return</span> <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_4">   4</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_4"></span><span class="anchor" id="line-4-22"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_5">   5</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_5"></span><span class="anchor" id="line-5-22"></span><span class="ResWord">def</span> <span class="ID">disabled</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_6">   6</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_6"></span><span class="anchor" id="line-6-22"></span>    <span class="String">&quot;</span><span class="String">This decorator disables the provided function, and does nothing</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_7">   7</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_7"></span><span class="anchor" id="line-7-22"></span>    <span class="ResWord">def</span> <span class="ID">empty_func</span>(*<span class="ID">args</span>,**<span class="ID">kargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_8">   8</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_8"></span><span class="anchor" id="line-8-22"></span>        <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_9">   9</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_9"></span><span class="anchor" id="line-9-22"></span>    <span class="ResWord">return</span> <span class="ID">empty_func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_10">  10</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_10"></span><span class="anchor" id="line-10-22"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_11">  11</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_11"></span><span class="anchor" id="line-11-20"></span><span class="Comment"># define this as equivalent to unchanged, for nice symmetry with disabled</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_12">  12</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_12"></span><span class="anchor" id="line-12-20"></span><span class="ID">enabled</span> = <span class="ID">unchanged</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_13">  13</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_13"></span><span class="anchor" id="line-13-20"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_14">  14</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_14"></span><span class="anchor" id="line-14-20"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_15">  15</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_15"></span><span class="anchor" id="line-15-20"></span><span class="Comment"># Sample use</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_16">  16</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_16"></span><span class="anchor" id="line-16-20"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_17">  17</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_17"></span><span class="anchor" id="line-17-19"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_18">  18</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_18"></span><span class="anchor" id="line-18-19"></span><span class="ID">GLOBAL_ENABLE_FLAG</span> = <span class="ResWord">True</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_19">  19</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_19"></span><span class="anchor" id="line-19-19"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_20">  20</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_20"></span><span class="anchor" id="line-20-18"></span><span class="ID">state</span> = <span class="ID">enabled</span> <span class="ResWord">if</span> <span class="ID">GLOBAL_ENABLE_FLAG</span> <span class="ResWord">else</span> <span class="ID">disabled</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_21">  21</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_21"></span><span class="anchor" id="line-21-18"></span><span class="ID">@state</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_22">  22</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_22"></span><span class="anchor" id="line-22-18"></span><span class="ResWord">def</span> <span class="ID">special_function_foo</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-a6aef080c0565c38553d6daea75bc507528028a9_23">  23</a> </span><span class="LineAnchor" id="CA-a6aef080c0565c38553d6daea75bc507528028a9_23"></span><span class="anchor" id="line-23-18"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">function was enabled</span><span class="String">&quot;</span></span>
</pre></div></div><span class="anchor" id="line-874"></span><p class="line867">
<h2 id="Easy_Dump_of_Function_Arguments">Easy Dump of Function Arguments</h2>
<span class="anchor" id="line-875"></span><p class="line867"><span class="anchor" id="line-876"></span><span class="anchor" id="line-877"></span><span class="anchor" id="line-878"></span><span class="anchor" id="line-879"></span><span class="anchor" id="line-880"></span><span class="anchor" id="line-881"></span><span class="anchor" id="line-882"></span><span class="anchor" id="line-883"></span><span class="anchor" id="line-884"></span><span class="anchor" id="line-885"></span><span class="anchor" id="line-886"></span><span class="anchor" id="line-887"></span><span class="anchor" id="line-888"></span><span class="anchor" id="line-889"></span><span class="anchor" id="line-890"></span><span class="anchor" id="line-891"></span><span class="anchor" id="line-892"></span><span class="anchor" id="line-893"></span><span class="anchor" id="line-894"></span><span class="anchor" id="line-1-47"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_1">   1</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_1"></span><span class="anchor" id="line-1-48"></span><span class="ResWord">def</span> <span class="ID">dump_args</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_2">   2</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_2"></span><span class="anchor" id="line-2-24"></span>    <span class="String">&quot;</span><span class="String">This decorator dumps out the arguments passed to a function before calling it</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_3">   3</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_3"></span><span class="anchor" id="line-3-24"></span>    <span class="ID">argnames</span> = <span class="ID">func</span>.<span class="ID">func_code</span>.<span class="ID">co_varnames</span>[:<span class="ID">func</span>.<span class="ID">func_code</span>.<span class="ID">co_argcount</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_4">   4</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_4"></span><span class="anchor" id="line-4-23"></span>    <span class="ID">fname</span> = <span class="ID">func</span>.<span class="ID">func_name</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_5">   5</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_5"></span><span class="anchor" id="line-5-23"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_6">   6</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_6"></span><span class="anchor" id="line-6-23"></span>    <span class="ResWord">def</span> <span class="ID">echo_func</span>(*<span class="ID">args</span>,**<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_7">   7</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_7"></span><span class="anchor" id="line-7-23"></span>        <span class="ResWord">print</span> <span class="ID">fname</span>, <span class="String">&quot;</span><span class="String">:</span><span class="String">&quot;</span>, <span class="String">'</span><span class="String">, </span><span class="String">'</span>.<span class="ID">join</span>(</span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_8">   8</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_8"></span><span class="anchor" id="line-8-23"></span>            <span class="String">'</span><span class="String">%s</span><span class="String">=</span><span class="String">%r</span><span class="String">'</span> % <span class="ID">entry</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_9">   9</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_9"></span><span class="anchor" id="line-9-23"></span>            <span class="ResWord">for</span> <span class="ID">entry</span> <span class="ResWord">in</span> <span class="ResWord">zip</span>(<span class="ID">argnames</span>,<span class="ID">args</span>) + <span class="ID">kwargs</span>.<span class="ID">items</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_10">  10</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_10"></span><span class="anchor" id="line-10-23"></span>        <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_11">  11</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_11"></span><span class="anchor" id="line-11-21"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_12">  12</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_12"></span><span class="anchor" id="line-12-21"></span>    <span class="ResWord">return</span> <span class="ID">echo_func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_13">  13</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_13"></span><span class="anchor" id="line-13-21"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_14">  14</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_14"></span><span class="anchor" id="line-14-21"></span><span class="ID">@dump_args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_15">  15</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_15"></span><span class="anchor" id="line-15-21"></span><span class="ResWord">def</span> <span class="ID">f1</span>(<span class="ID">a</span>,<span class="ID">b</span>,<span class="ID">c</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_16">  16</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_16"></span><span class="anchor" id="line-16-21"></span>    <span class="ResWord">print</span> <span class="ID">a</span> + <span class="ID">b</span> + <span class="ID">c</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_17">  17</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_17"></span><span class="anchor" id="line-17-20"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_18">  18</a> </span><span class="LineAnchor" id="CA-2f7cc564efa5e987cbcab4627c58afc7053eac8b_18"></span><span class="anchor" id="line-18-20"></span><span class="ID">f1</span>(<span class="Number">1</span>, <span class="Number">2</span>, <span class="Number">3</span>)</span>
</pre></div></div><span class="anchor" id="line-895"></span><p class="line867">
<h2 id="Pre-.2FPost-Conditions">Pre-/Post-Conditions</h2>
<span class="anchor" id="line-896"></span><p class="line867"><span class="anchor" id="line-897"></span><span class="anchor" id="line-898"></span><span class="anchor" id="line-899"></span><span class="anchor" id="line-900"></span><span class="anchor" id="line-901"></span><span class="anchor" id="line-902"></span><span class="anchor" id="line-903"></span><span class="anchor" id="line-904"></span><span class="anchor" id="line-905"></span><span class="anchor" id="line-906"></span><span class="anchor" id="line-907"></span><span class="anchor" id="line-908"></span><span class="anchor" id="line-909"></span><span class="anchor" id="line-910"></span><span class="anchor" id="line-911"></span><span class="anchor" id="line-912"></span><span class="anchor" id="line-913"></span><span class="anchor" id="line-914"></span><span class="anchor" id="line-915"></span><span class="anchor" id="line-916"></span><span class="anchor" id="line-917"></span><span class="anchor" id="line-918"></span><span class="anchor" id="line-919"></span><span class="anchor" id="line-920"></span><span class="anchor" id="line-921"></span><span class="anchor" id="line-922"></span><span class="anchor" id="line-923"></span><span class="anchor" id="line-924"></span><span class="anchor" id="line-925"></span><span class="anchor" id="line-926"></span><span class="anchor" id="line-927"></span><span class="anchor" id="line-928"></span><span class="anchor" id="line-929"></span><span class="anchor" id="line-930"></span><span class="anchor" id="line-931"></span><span class="anchor" id="line-932"></span><span class="anchor" id="line-933"></span><span class="anchor" id="line-934"></span><span class="anchor" id="line-935"></span><span class="anchor" id="line-936"></span><span class="anchor" id="line-937"></span><span class="anchor" id="line-938"></span><span class="anchor" id="line-939"></span><span class="anchor" id="line-940"></span><span class="anchor" id="line-941"></span><span class="anchor" id="line-942"></span><span class="anchor" id="line-943"></span><span class="anchor" id="line-944"></span><span class="anchor" id="line-945"></span><span class="anchor" id="line-946"></span><span class="anchor" id="line-947"></span><span class="anchor" id="line-948"></span><span class="anchor" id="line-949"></span><span class="anchor" id="line-950"></span><span class="anchor" id="line-951"></span><span class="anchor" id="line-952"></span><span class="anchor" id="line-953"></span><span class="anchor" id="line-954"></span><span class="anchor" id="line-955"></span><span class="anchor" id="line-956"></span><span class="anchor" id="line-957"></span><span class="anchor" id="line-958"></span><span class="anchor" id="line-959"></span><span class="anchor" id="line-960"></span><span class="anchor" id="line-961"></span><span class="anchor" id="line-962"></span><span class="anchor" id="line-963"></span><span class="anchor" id="line-964"></span><span class="anchor" id="line-965"></span><span class="anchor" id="line-966"></span><span class="anchor" id="line-967"></span><span class="anchor" id="line-968"></span><span class="anchor" id="line-969"></span><span class="anchor" id="line-970"></span><span class="anchor" id="line-971"></span><span class="anchor" id="line-972"></span><span class="anchor" id="line-973"></span><span class="anchor" id="line-974"></span><span class="anchor" id="line-975"></span><span class="anchor" id="line-976"></span><span class="anchor" id="line-977"></span><span class="anchor" id="line-978"></span><span class="anchor" id="line-979"></span><span class="anchor" id="line-980"></span><span class="anchor" id="line-981"></span><span class="anchor" id="line-982"></span><span class="anchor" id="line-983"></span><span class="anchor" id="line-984"></span><span class="anchor" id="line-985"></span><span class="anchor" id="line-986"></span><span class="anchor" id="line-987"></span><span class="anchor" id="line-988"></span><span class="anchor" id="line-989"></span><span class="anchor" id="line-990"></span><span class="anchor" id="line-991"></span><span class="anchor" id="line-992"></span><span class="anchor" id="line-993"></span><span class="anchor" id="line-994"></span><span class="anchor" id="line-995"></span><span class="anchor" id="line-996"></span><span class="anchor" id="line-997"></span><span class="anchor" id="line-998"></span><span class="anchor" id="line-999"></span><span class="anchor" id="line-1000"></span><span class="anchor" id="line-1001"></span><span class="anchor" id="line-1002"></span><span class="anchor" id="line-1003"></span><span class="anchor" id="line-1004"></span><span class="anchor" id="line-1005"></span><span class="anchor" id="line-1006"></span><span class="anchor" id="line-1007"></span><span class="anchor" id="line-1008"></span><span class="anchor" id="line-1009"></span><span class="anchor" id="line-1010"></span><span class="anchor" id="line-1011"></span><span class="anchor" id="line-1012"></span><span class="anchor" id="line-1013"></span><span class="anchor" id="line-1-49"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_1">   1</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_1"></span><span class="anchor" id="line-1-50"></span><span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_2">   2</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_2"></span><span class="anchor" id="line-2-25"></span><span class="String">Provide pre-/postconditions as function decorators.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_3">   3</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_3"></span><span class="anchor" id="line-3-25"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_4">   4</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_4"></span><span class="anchor" id="line-4-24"></span><span class="String">Example usage:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_5">   5</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_5"></span><span class="anchor" id="line-5-24"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_6">   6</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_6"></span><span class="anchor" id="line-6-24"></span><span class="String">  &gt;&gt;&gt; def in_ge20(inval):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_7">   7</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_7"></span><span class="anchor" id="line-7-24"></span><span class="String">  ...    assert inval &gt;= 20, 'Input value &lt; 20'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_8">   8</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_8"></span><span class="anchor" id="line-8-24"></span><span class="String">  ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_9">   9</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_9"></span><span class="anchor" id="line-9-24"></span><span class="String">  &gt;&gt;&gt; def out_lt30(retval, inval):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_10">  10</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_10"></span><span class="anchor" id="line-10-24"></span><span class="String">  ...    assert retval &lt; 30, 'Return value &gt;= 30'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_11">  11</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_11"></span><span class="anchor" id="line-11-22"></span><span class="String">  ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_12">  12</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_12"></span><span class="anchor" id="line-12-22"></span><span class="String">  &gt;&gt;&gt; @precondition(in_ge20)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_13">  13</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_13"></span><span class="anchor" id="line-13-22"></span><span class="String">  ... @postcondition(out_lt30)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_14">  14</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_14"></span><span class="anchor" id="line-14-22"></span><span class="String">  ... def inc(value):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_15">  15</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_15"></span><span class="anchor" id="line-15-22"></span><span class="String">  ...   return value + 1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_16">  16</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_16"></span><span class="anchor" id="line-16-22"></span><span class="String">  ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_17">  17</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_17"></span><span class="anchor" id="line-17-21"></span><span class="String">  &gt;&gt;&gt; inc(5)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_18">  18</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_18"></span><span class="anchor" id="line-18-21"></span><span class="String">  Traceback (most recent call last):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_19">  19</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_19"></span><span class="anchor" id="line-19-20"></span><span class="String">    ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_20">  20</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_20"></span><span class="anchor" id="line-20-19"></span><span class="String">  AssertionError: Input value &lt; 20</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_21">  21</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_21"></span><span class="anchor" id="line-21-19"></span><span class="String">  &gt;&gt;&gt; inc(29)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_22">  22</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_22"></span><span class="anchor" id="line-22-19"></span><span class="String">  Traceback (most recent call last):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_23">  23</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_23"></span><span class="anchor" id="line-23-19"></span><span class="String">    ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_24">  24</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_24"></span><span class="anchor" id="line-24-17"></span><span class="String">  AssertionError: Return value &gt;= 30</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_25">  25</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_25"></span><span class="anchor" id="line-25-17"></span><span class="String">  &gt;&gt;&gt; inc(20)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_26">  26</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_26"></span><span class="anchor" id="line-26-16"></span><span class="String">  21</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_27">  27</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_27"></span><span class="anchor" id="line-27-13"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_28">  28</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_28"></span><span class="anchor" id="line-28-12"></span><span class="String">You can define as many pre-/postconditions for a function as you</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_29">  29</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_29"></span><span class="anchor" id="line-29-12"></span><span class="String">like. It is also possible to specify both types of conditions at once:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_30">  30</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_30"></span><span class="anchor" id="line-30-11"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_31">  31</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_31"></span><span class="anchor" id="line-31-10"></span><span class="String">  &gt;&gt;&gt; @conditions(in_ge20, out_lt30)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_32">  32</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_32"></span><span class="anchor" id="line-32-10"></span><span class="String">  ... def add1(value):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_33">  33</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_33"></span><span class="anchor" id="line-33-10"></span><span class="String">  ...   return value + 1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_34">  34</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_34"></span><span class="anchor" id="line-34-9"></span><span class="String">  ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_35">  35</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_35"></span><span class="anchor" id="line-35-9"></span><span class="String">  &gt;&gt;&gt; add1(5)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_36">  36</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_36"></span><span class="anchor" id="line-36-9"></span><span class="String">  Traceback (most recent call last):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_37">  37</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_37"></span><span class="anchor" id="line-37-9"></span><span class="String">    ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_38">  38</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_38"></span><span class="anchor" id="line-38-8"></span><span class="String">  AssertionError: Input value &lt; 20</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_39">  39</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_39"></span><span class="anchor" id="line-39-8"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_40">  40</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_40"></span><span class="anchor" id="line-40-8"></span><span class="String">An interesting feature is the ability to prevent the creation of</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_41">  41</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_41"></span><span class="anchor" id="line-41-7"></span><span class="String">pre-/postconditions at function definition time. This makes it</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_42">  42</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_42"></span><span class="anchor" id="line-42-5"></span><span class="String">possible to use conditions for debugging and then switch them off for</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_43">  43</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_43"></span><span class="anchor" id="line-43-5"></span><span class="String">distribution.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_44">  44</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_44"></span><span class="anchor" id="line-44-5"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_45">  45</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_45"></span><span class="anchor" id="line-45-5"></span><span class="String">  &gt;&gt;&gt; debug = False</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_46">  46</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_46"></span><span class="anchor" id="line-46-5"></span><span class="String">  &gt;&gt;&gt; @precondition(in_ge20, debug)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_47">  47</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_47"></span><span class="anchor" id="line-47-5"></span><span class="String">  ... def dec(value):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_48">  48</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_48"></span><span class="anchor" id="line-48-4"></span><span class="String">  ...   return value - 1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_49">  49</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_49"></span><span class="anchor" id="line-49-4"></span><span class="String">  ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_50">  50</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_50"></span><span class="anchor" id="line-50-3"></span><span class="String">  &gt;&gt;&gt; dec(5)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_51">  51</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_51"></span><span class="anchor" id="line-51-3"></span><span class="String">  4</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_52">  52</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_52"></span><span class="anchor" id="line-52-3"></span><span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_53">  53</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_53"></span><span class="anchor" id="line-53-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_54">  54</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_54"></span><span class="anchor" id="line-54-3"></span><span class="ID">__all__</span> = [<span class="String">'</span><span class="String">precondition</span><span class="String">'</span>, <span class="String">'</span><span class="String">postcondition</span><span class="String">'</span>, <span class="String">'</span><span class="String">conditions</span><span class="String">'</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_55">  55</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_55"></span><span class="anchor" id="line-55-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_56">  56</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_56"></span><span class="anchor" id="line-56-3"></span><span class="ID">DEFAULT_ON</span> = <span class="ResWord">True</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_57">  57</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_57"></span><span class="anchor" id="line-57-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_58">  58</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_58"></span><span class="anchor" id="line-58-3"></span><span class="ResWord">def</span> <span class="ID">precondition</span>(<span class="ID">precondition</span>, <span class="ID">use_conditions</span>=<span class="ID">DEFAULT_ON</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_59">  59</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_59"></span><span class="anchor" id="line-59-3"></span>    <span class="ResWord">return</span> <span class="ID">conditions</span>(<span class="ID">precondition</span>, <span class="ResWord">None</span>, <span class="ID">use_conditions</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_60">  60</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_60"></span><span class="anchor" id="line-60-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_61">  61</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_61"></span><span class="anchor" id="line-61-3"></span><span class="ResWord">def</span> <span class="ID">postcondition</span>(<span class="ID">postcondition</span>, <span class="ID">use_conditions</span>=<span class="ID">DEFAULT_ON</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_62">  62</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_62"></span><span class="anchor" id="line-62-2"></span>    <span class="ResWord">return</span> <span class="ID">conditions</span>(<span class="ResWord">None</span>, <span class="ID">postcondition</span>, <span class="ID">use_conditions</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_63">  63</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_63"></span><span class="anchor" id="line-63-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_64">  64</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_64"></span><span class="anchor" id="line-64-2"></span><span class="ResWord">class</span> <span class="ID">conditions</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_65">  65</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_65"></span><span class="anchor" id="line-65-2"></span>    <span class="ID">__slots__</span> = (<span class="String">'</span><span class="String">__precondition</span><span class="String">'</span>, <span class="String">'</span><span class="String">__postcondition</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_66">  66</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_66"></span><span class="anchor" id="line-66-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_67">  67</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_67"></span><span class="anchor" id="line-67-2"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">pre</span>, <span class="ID">post</span>, <span class="ID">use_conditions</span>=<span class="ID">DEFAULT_ON</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_68">  68</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_68"></span><span class="anchor" id="line-68-2"></span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">use_conditions</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_69">  69</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_69"></span><span class="anchor" id="line-69-2"></span>            <span class="ID">pre</span>, <span class="ID">post</span> = <span class="ResWord">None</span>, <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_70">  70</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_70"></span><span class="anchor" id="line-70-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_71">  71</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_71"></span><span class="anchor" id="line-71-2"></span>        <span class="ResWord">self</span>.<span class="ID">__precondition</span>  = <span class="ID">pre</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_72">  72</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_72"></span><span class="anchor" id="line-72-2"></span>        <span class="ResWord">self</span>.<span class="ID">__postcondition</span> = <span class="ID">post</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_73">  73</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_73"></span><span class="anchor" id="line-73-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_74">  74</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_74"></span><span class="anchor" id="line-74-2"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, <span class="ID">function</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_75">  75</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_75"></span><span class="anchor" id="line-75-2"></span>        <span class="Comment"># combine recursive wrappers (@precondition + @postcondition == @conditions)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_76">  76</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_76"></span><span class="anchor" id="line-76-2"></span>        <span class="ID">pres</span>  = <span class="ResWord">set</span>((<span class="ResWord">self</span>.<span class="ID">__precondition</span>,))</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_77">  77</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_77"></span><span class="anchor" id="line-77-2"></span>        <span class="ID">posts</span> = <span class="ResWord">set</span>((<span class="ResWord">self</span>.<span class="ID">__postcondition</span>,))</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_78">  78</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_78"></span><span class="anchor" id="line-78-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_79">  79</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_79"></span><span class="anchor" id="line-79-2"></span>        <span class="Comment"># unwrap function, collect distinct pre-/post conditions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_80">  80</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_80"></span><span class="anchor" id="line-80-2"></span>        <span class="ResWord">while</span> <span class="ResWord">type</span>(<span class="ID">function</span>) <span class="ResWord">is</span> <span class="ID">FunctionWrapper</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_81">  81</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_81"></span><span class="anchor" id="line-81-2"></span>            <span class="ID">pres</span>.<span class="ID">add</span>(<span class="ID">function</span>.<span class="ID">_pre</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_82">  82</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_82"></span><span class="anchor" id="line-82-2"></span>            <span class="ID">posts</span>.<span class="ID">add</span>(<span class="ID">function</span>.<span class="ID">_post</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_83">  83</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_83"></span><span class="anchor" id="line-83-2"></span>            <span class="ID">function</span> = <span class="ID">function</span>.<span class="ID">_func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_84">  84</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_84"></span><span class="anchor" id="line-84-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_85">  85</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_85"></span><span class="anchor" id="line-85-2"></span>        <span class="Comment"># filter out None conditions and build pairs of pre- and postconditions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_86">  86</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_86"></span><span class="anchor" id="line-86-2"></span>        <span class="ID">conditions</span> = <span class="ResWord">map</span>(<span class="ResWord">None</span>, <span class="ResWord">filter</span>(<span class="ResWord">None</span>, <span class="ID">pres</span>), <span class="ResWord">filter</span>(<span class="ResWord">None</span>, <span class="ID">posts</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_87">  87</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_87"></span><span class="anchor" id="line-87-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_88">  88</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_88"></span><span class="anchor" id="line-88-2"></span>        <span class="Comment"># add a wrapper for each pair (note that 'conditions' may be empty)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_89">  89</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_89"></span><span class="anchor" id="line-89-2"></span>        <span class="ResWord">for</span> <span class="ID">pre</span>, <span class="ID">post</span> <span class="ResWord">in</span> <span class="ID">conditions</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_90">  90</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_90"></span><span class="anchor" id="line-90-2"></span>            <span class="ID">function</span> = <span class="ID">FunctionWrapper</span>(<span class="ID">pre</span>, <span class="ID">post</span>, <span class="ID">function</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_91">  91</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_91"></span><span class="anchor" id="line-91-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_92">  92</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_92"></span><span class="anchor" id="line-92-2"></span>        <span class="ResWord">return</span> <span class="ID">function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_93">  93</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_93"></span><span class="anchor" id="line-93-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_94">  94</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_94"></span><span class="anchor" id="line-94-2"></span><span class="ResWord">class</span> <span class="ID">FunctionWrapper</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_95">  95</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_95"></span><span class="anchor" id="line-95-2"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">precondition</span>, <span class="ID">postcondition</span>, <span class="ID">function</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_96">  96</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_96"></span><span class="anchor" id="line-96-2"></span>        <span class="ResWord">self</span>.<span class="ID">_pre</span>  = <span class="ID">precondition</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_97">  97</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_97"></span><span class="anchor" id="line-97-2"></span>        <span class="ResWord">self</span>.<span class="ID">_post</span> = <span class="ID">postcondition</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_98">  98</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_98"></span><span class="anchor" id="line-98-2"></span>        <span class="ResWord">self</span>.<span class="ID">_func</span> = <span class="ID">function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_99">  99</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_99"></span><span class="anchor" id="line-99-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_100"> 100</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_100"></span><span class="anchor" id="line-100-2"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_101"> 101</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_101"></span><span class="anchor" id="line-101-2"></span>        <span class="ID">precondition</span>  = <span class="ResWord">self</span>.<span class="ID">_pre</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_102"> 102</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_102"></span><span class="anchor" id="line-102-2"></span>        <span class="ID">postcondition</span> = <span class="ResWord">self</span>.<span class="ID">_post</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_103"> 103</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_103"></span><span class="anchor" id="line-103-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_104"> 104</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_104"></span><span class="anchor" id="line-104-2"></span>        <span class="ResWord">if</span> <span class="ID">precondition</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_105"> 105</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_105"></span><span class="anchor" id="line-105-2"></span>            <span class="ID">precondition</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_106"> 106</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_106"></span><span class="anchor" id="line-106-2"></span>        <span class="ID">result</span> = <span class="ResWord">self</span>.<span class="ID">_func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_107"> 107</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_107"></span><span class="anchor" id="line-107-2"></span>        <span class="ResWord">if</span> <span class="ID">postcondition</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_108"> 108</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_108"></span><span class="anchor" id="line-108-2"></span>            <span class="ID">postcondition</span>(<span class="ID">result</span>, *<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_109"> 109</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_109"></span><span class="anchor" id="line-109-2"></span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_110"> 110</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_110"></span><span class="anchor" id="line-110-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_111"> 111</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_111"></span><span class="anchor" id="line-111-2"></span><span class="ResWord">def</span> <span class="ID">__test</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_112"> 112</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_112"></span><span class="anchor" id="line-112-2"></span>    <span class="ResWord">import</span> <span class="ID">doctest</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_113"> 113</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_113"></span><span class="anchor" id="line-113-2"></span>    <span class="ID">doctest</span>.<span class="ID">testmod</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_114"> 114</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_114"></span><span class="anchor" id="line-114-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_115"> 115</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_115"></span><span class="anchor" id="line-115-2"></span><span class="ResWord">if</span> <span class="ID">__name__</span> == <span class="String">&quot;</span><span class="String">__main__</span><span class="String">&quot;</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_116"> 116</a> </span><span class="LineAnchor" id="CA-ba42cc7e40e2872ba1ab8b49a1a12fb5d74a001b_116"></span><span class="anchor" id="line-116-2"></span>    <span class="ID">__test</span>()</span>
</pre></div></div><span class="anchor" id="line-1014"></span><p class="line867">
<h2 id="Profiling.2FCoverage_Analysis">Profiling/Coverage Analysis</h2>
<span class="anchor" id="line-1015"></span><p class="line862">The code and examples are a bit longish, so I'll include a link instead: <a class="http" href="http://mg.pov.lt/blog/profiling.html">http://mg.pov.lt/blog/profiling.html</a> <span class="anchor" id="line-1016"></span><span class="anchor" id="line-1017"></span><p class="line867">
<h2 id="Line_Tracing_Individual_Functions">Line Tracing Individual Functions</h2>
<span class="anchor" id="line-1018"></span><p class="line874">I cobbled this together from the trace module. It allows you to decorate individual functions so their lines are traced. I think it works out to be a slightly smaller hammer than running the trace module and trying to pare back what it traces using exclusions. <span class="anchor" id="line-1019"></span><span class="anchor" id="line-1020"></span><p class="line867"><span class="anchor" id="line-1021"></span><span class="anchor" id="line-1022"></span><span class="anchor" id="line-1023"></span><span class="anchor" id="line-1024"></span><span class="anchor" id="line-1025"></span><span class="anchor" id="line-1026"></span><span class="anchor" id="line-1027"></span><span class="anchor" id="line-1028"></span><span class="anchor" id="line-1029"></span><span class="anchor" id="line-1030"></span><span class="anchor" id="line-1031"></span><span class="anchor" id="line-1032"></span><span class="anchor" id="line-1033"></span><span class="anchor" id="line-1034"></span><span class="anchor" id="line-1035"></span><span class="anchor" id="line-1036"></span><span class="anchor" id="line-1037"></span><span class="anchor" id="line-1038"></span><span class="anchor" id="line-1039"></span><span class="anchor" id="line-1040"></span><span class="anchor" id="line-1041"></span><span class="anchor" id="line-1042"></span><span class="anchor" id="line-1043"></span><span class="anchor" id="line-1044"></span><span class="anchor" id="line-1045"></span><span class="anchor" id="line-1046"></span><span class="anchor" id="line-1047"></span><span class="anchor" id="line-1048"></span><span class="anchor" id="line-1049"></span><span class="anchor" id="line-1050"></span><span class="anchor" id="line-1-51"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_1">   1</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_1"></span><span class="anchor" id="line-1-52"></span><span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_2">   2</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_2"></span><span class="anchor" id="line-2-26"></span><span class="ResWord">import</span> <span class="ID">os</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_3">   3</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_3"></span><span class="anchor" id="line-3-26"></span><span class="ResWord">import</span> <span class="ID">linecache</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_4">   4</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_4"></span><span class="anchor" id="line-4-25"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_5">   5</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_5"></span><span class="anchor" id="line-5-25"></span><span class="ResWord">def</span> <span class="ID">trace</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_6">   6</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_6"></span><span class="anchor" id="line-6-25"></span>    <span class="ResWord">def</span> <span class="ID">globaltrace</span>(<span class="ID">frame</span>, <span class="ID">why</span>, <span class="ID">arg</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_7">   7</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_7"></span><span class="anchor" id="line-7-25"></span>        <span class="ResWord">if</span> <span class="ID">why</span> == <span class="String">&quot;</span><span class="String">call</span><span class="String">&quot;</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_8">   8</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_8"></span><span class="anchor" id="line-8-25"></span>            <span class="ResWord">return</span> <span class="ID">localtrace</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_9">   9</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_9"></span><span class="anchor" id="line-9-25"></span>        <span class="ResWord">return</span> <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_10">  10</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_10"></span><span class="anchor" id="line-10-25"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_11">  11</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_11"></span><span class="anchor" id="line-11-23"></span>    <span class="ResWord">def</span> <span class="ID">localtrace</span>(<span class="ID">frame</span>, <span class="ID">why</span>, <span class="ID">arg</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_12">  12</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_12"></span><span class="anchor" id="line-12-23"></span>        <span class="ResWord">if</span> <span class="ID">why</span> == <span class="String">&quot;</span><span class="String">line</span><span class="String">&quot;</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_13">  13</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_13"></span><span class="anchor" id="line-13-23"></span>            <span class="Comment"># record the file name and line number of every trace</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_14">  14</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_14"></span><span class="anchor" id="line-14-23"></span>            <span class="ID">filename</span> = <span class="ID">frame</span>.<span class="ID">f_code</span>.<span class="ID">co_filename</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_15">  15</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_15"></span><span class="anchor" id="line-15-23"></span>            <span class="ID">lineno</span> = <span class="ID">frame</span>.<span class="ID">f_lineno</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_16">  16</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_16"></span><span class="anchor" id="line-16-23"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_17">  17</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_17"></span><span class="anchor" id="line-17-22"></span>            <span class="ID">bname</span> = <span class="ID">os</span>.<span class="ID">path</span>.<span class="ID">basename</span>(<span class="ID">filename</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_18">  18</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_18"></span><span class="anchor" id="line-18-22"></span>            <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">{}({}): {}</span><span class="String">&quot;</span>.<span class="ID">format</span>(  <span class="ID">bname</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_19">  19</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_19"></span><span class="anchor" id="line-19-21"></span>                                        <span class="ID">lineno</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_20">  20</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_20"></span><span class="anchor" id="line-20-20"></span>                                        <span class="ID">linecache</span>.<span class="ID">getline</span>(<span class="ID">filename</span>, <span class="ID">lineno</span>)),</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_21">  21</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_21"></span><span class="anchor" id="line-21-20"></span>        <span class="ResWord">return</span> <span class="ID">localtrace</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_22">  22</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_22"></span><span class="anchor" id="line-22-20"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_23">  23</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_23"></span><span class="anchor" id="line-23-20"></span>    <span class="ResWord">def</span> <span class="ID">_f</span>(*<span class="ID">args</span>, **<span class="ID">kwds</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_24">  24</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_24"></span><span class="anchor" id="line-24-18"></span>        <span class="ID">sys</span>.<span class="ID">settrace</span>(<span class="ID">globaltrace</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_25">  25</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_25"></span><span class="anchor" id="line-25-18"></span>        <span class="ID">result</span> = <span class="ID">f</span>(*<span class="ID">args</span>, **<span class="ID">kwds</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_26">  26</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_26"></span><span class="anchor" id="line-26-17"></span>        <span class="ID">sys</span>.<span class="ID">settrace</span>(<span class="ResWord">None</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_27">  27</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_27"></span><span class="anchor" id="line-27-14"></span>        <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_28">  28</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_28"></span><span class="anchor" id="line-28-13"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_29">  29</a> </span><span class="LineAnchor" id="CA-eccbd25adea7ab5aae945d9574c39aaf02c158ed_29"></span><span class="anchor" id="line-29-13"></span>    <span class="ResWord">return</span> <span class="ID">_f</span></span>
</pre></div></div><span class="anchor" id="line-1051"></span><p class="line867">
<h2 id="Synchronization">Synchronization</h2>
<span class="anchor" id="line-1052"></span><p class="line874">Synchronize two (or more) functions on a given lock. <span class="anchor" id="line-1053"></span><span class="anchor" id="line-1054"></span><p class="line867"><span class="anchor" id="line-1055"></span><span class="anchor" id="line-1056"></span><span class="anchor" id="line-1057"></span><span class="anchor" id="line-1058"></span><span class="anchor" id="line-1059"></span><span class="anchor" id="line-1060"></span><span class="anchor" id="line-1061"></span><span class="anchor" id="line-1062"></span><span class="anchor" id="line-1063"></span><span class="anchor" id="line-1064"></span><span class="anchor" id="line-1065"></span><span class="anchor" id="line-1066"></span><span class="anchor" id="line-1067"></span><span class="anchor" id="line-1068"></span><span class="anchor" id="line-1069"></span><span class="anchor" id="line-1070"></span><span class="anchor" id="line-1071"></span><span class="anchor" id="line-1072"></span><span class="anchor" id="line-1073"></span><span class="anchor" id="line-1074"></span><span class="anchor" id="line-1075"></span><span class="anchor" id="line-1076"></span><span class="anchor" id="line-1077"></span><span class="anchor" id="line-1078"></span><span class="anchor" id="line-1079"></span><span class="anchor" id="line-1080"></span><span class="anchor" id="line-1081"></span><span class="anchor" id="line-1082"></span><span class="anchor" id="line-1-53"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-af1e1c538b2586a9f108a34f9a57b2535d292e28\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_1">   1</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_1"></span><span class="anchor" id="line-1-54"></span><span class="ResWord">def</span> <span class="ID">synchronized</span>(<span class="ID">lock</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_2">   2</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_2"></span><span class="anchor" id="line-2-27"></span>    <span class="String">'''Synchronization decorator.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_3">   3</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_3"></span><span class="anchor" id="line-3-27"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_4">   4</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_4"></span><span class="anchor" id="line-4-26"></span>    <span class="ResWord">def</span> <span class="ID">wrap</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_5">   5</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_5"></span><span class="anchor" id="line-5-26"></span>        <span class="ResWord">def</span> <span class="ID">new_function</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_6">   6</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_6"></span><span class="anchor" id="line-6-26"></span>            <span class="ID">lock</span>.<span class="ID">acquire</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_7">   7</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_7"></span><span class="anchor" id="line-7-26"></span>            <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_8">   8</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_8"></span><span class="anchor" id="line-8-26"></span>                <span class="ResWord">return</span> <span class="ID">f</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_9">   9</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_9"></span><span class="anchor" id="line-9-26"></span>            <span class="ResWord">finally</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_10">  10</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_10"></span><span class="anchor" id="line-10-26"></span>                <span class="ID">lock</span>.<span class="ID">release</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_11">  11</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_11"></span><span class="anchor" id="line-11-24"></span>        <span class="ResWord">return</span> <span class="ID">new_function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_12">  12</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_12"></span><span class="anchor" id="line-12-24"></span>    <span class="ResWord">return</span> <span class="ID">wrap</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_13">  13</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_13"></span><span class="anchor" id="line-13-24"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_14">  14</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_14"></span><span class="anchor" id="line-14-24"></span><span class="Comment"># Example usage:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_15">  15</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_15"></span><span class="anchor" id="line-15-24"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_16">  16</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_16"></span><span class="anchor" id="line-16-24"></span><span class="ResWord">from</span> <span class="ID">threading</span> <span class="ResWord">import</span> <span class="ID">Lock</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_17">  17</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_17"></span><span class="anchor" id="line-17-23"></span><span class="ID">my_lock</span> = <span class="ID">Lock</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_18">  18</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_18"></span><span class="anchor" id="line-18-23"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_19">  19</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_19"></span><span class="anchor" id="line-19-22"></span><span class="ID">@synchronized</span>(<span class="ID">my_lock</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_20">  20</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_20"></span><span class="anchor" id="line-20-21"></span><span class="ResWord">def</span> <span class="ID">critical1</span>(*<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_21">  21</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_21"></span><span class="anchor" id="line-21-21"></span>    <span class="Comment"># Interesting stuff goes here.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_22">  22</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_22"></span><span class="anchor" id="line-22-21"></span>    <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_23">  23</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_23"></span><span class="anchor" id="line-23-21"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_24">  24</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_24"></span><span class="anchor" id="line-24-19"></span><span class="ID">@synchronized</span>(<span class="ID">my_lock</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_25">  25</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_25"></span><span class="anchor" id="line-25-19"></span><span class="ResWord">def</span> <span class="ID">critical2</span>(*<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_26">  26</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_26"></span><span class="anchor" id="line-26-18"></span>    <span class="Comment"># Other interesting stuff goes here.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_27">  27</a> </span><span class="LineAnchor" id="CA-af1e1c538b2586a9f108a34f9a57b2535d292e28_27"></span><span class="anchor" id="line-27-15"></span>    <span class="ResWord">pass</span></span>
</pre></div></div><span class="anchor" id="line-1083"></span><p class="line867">
<h2 id="Type_Enforcement_.28accepts.2Freturns.29">Type Enforcement (accepts/returns)</h2>
<span class="anchor" id="line-1084"></span><p class="line874">Provides various degrees of type enforcement for function parameters and return values. <span class="anchor" id="line-1085"></span><span class="anchor" id="line-1086"></span><p class="line867"><span class="anchor" id="line-1087"></span><span class="anchor" id="line-1088"></span><span class="anchor" id="line-1089"></span><span class="anchor" id="line-1090"></span><span class="anchor" id="line-1091"></span><span class="anchor" id="line-1092"></span><span class="anchor" id="line-1093"></span><span class="anchor" id="line-1094"></span><span class="anchor" id="line-1095"></span><span class="anchor" id="line-1096"></span><span class="anchor" id="line-1097"></span><span class="anchor" id="line-1098"></span><span class="anchor" id="line-1099"></span><span class="anchor" id="line-1100"></span><span class="anchor" id="line-1101"></span><span class="anchor" id="line-1102"></span><span class="anchor" id="line-1103"></span><span class="anchor" id="line-1104"></span><span class="anchor" id="line-1105"></span><span class="anchor" id="line-1106"></span><span class="anchor" id="line-1107"></span><span class="anchor" id="line-1108"></span><span class="anchor" id="line-1109"></span><span class="anchor" id="line-1110"></span><span class="anchor" id="line-1111"></span><span class="anchor" id="line-1112"></span><span class="anchor" id="line-1113"></span><span class="anchor" id="line-1114"></span><span class="anchor" id="line-1115"></span><span class="anchor" id="line-1116"></span><span class="anchor" id="line-1117"></span><span class="anchor" id="line-1118"></span><span class="anchor" id="line-1119"></span><span class="anchor" id="line-1120"></span><span class="anchor" id="line-1121"></span><span class="anchor" id="line-1122"></span><span class="anchor" id="line-1123"></span><span class="anchor" id="line-1124"></span><span class="anchor" id="line-1125"></span><span class="anchor" id="line-1126"></span><span class="anchor" id="line-1127"></span><span class="anchor" id="line-1128"></span><span class="anchor" id="line-1129"></span><span class="anchor" id="line-1130"></span><span class="anchor" id="line-1131"></span><span class="anchor" id="line-1132"></span><span class="anchor" id="line-1133"></span><span class="anchor" id="line-1134"></span><span class="anchor" id="line-1135"></span><span class="anchor" id="line-1136"></span><span class="anchor" id="line-1137"></span><span class="anchor" id="line-1138"></span><span class="anchor" id="line-1139"></span><span class="anchor" id="line-1140"></span><span class="anchor" id="line-1141"></span><span class="anchor" id="line-1142"></span><span class="anchor" id="line-1143"></span><span class="anchor" id="line-1144"></span><span class="anchor" id="line-1145"></span><span class="anchor" id="line-1146"></span><span class="anchor" id="line-1147"></span><span class="anchor" id="line-1148"></span><span class="anchor" id="line-1149"></span><span class="anchor" id="line-1150"></span><span class="anchor" id="line-1151"></span><span class="anchor" id="line-1152"></span><span class="anchor" id="line-1153"></span><span class="anchor" id="line-1154"></span><span class="anchor" id="line-1155"></span><span class="anchor" id="line-1156"></span><span class="anchor" id="line-1157"></span><span class="anchor" id="line-1158"></span><span class="anchor" id="line-1159"></span><span class="anchor" id="line-1160"></span><span class="anchor" id="line-1161"></span><span class="anchor" id="line-1162"></span><span class="anchor" id="line-1163"></span><span class="anchor" id="line-1164"></span><span class="anchor" id="line-1165"></span><span class="anchor" id="line-1166"></span><span class="anchor" id="line-1167"></span><span class="anchor" id="line-1168"></span><span class="anchor" id="line-1169"></span><span class="anchor" id="line-1170"></span><span class="anchor" id="line-1171"></span><span class="anchor" id="line-1172"></span><span class="anchor" id="line-1173"></span><span class="anchor" id="line-1174"></span><span class="anchor" id="line-1175"></span><span class="anchor" id="line-1176"></span><span class="anchor" id="line-1177"></span><span class="anchor" id="line-1178"></span><span class="anchor" id="line-1179"></span><span class="anchor" id="line-1180"></span><span class="anchor" id="line-1181"></span><span class="anchor" id="line-1182"></span><span class="anchor" id="line-1183"></span><span class="anchor" id="line-1184"></span><span class="anchor" id="line-1185"></span><span class="anchor" id="line-1186"></span><span class="anchor" id="line-1187"></span><span class="anchor" id="line-1188"></span><span class="anchor" id="line-1189"></span><span class="anchor" id="line-1190"></span><span class="anchor" id="line-1191"></span><span class="anchor" id="line-1192"></span><span class="anchor" id="line-1193"></span><span class="anchor" id="line-1194"></span><span class="anchor" id="line-1195"></span><span class="anchor" id="line-1196"></span><span class="anchor" id="line-1197"></span><span class="anchor" id="line-1198"></span><span class="anchor" id="line-1199"></span><span class="anchor" id="line-1200"></span><span class="anchor" id="line-1201"></span><span class="anchor" id="line-1202"></span><span class="anchor" id="line-1203"></span><span class="anchor" id="line-1204"></span><span class="anchor" id="line-1205"></span><span class="anchor" id="line-1206"></span><span class="anchor" id="line-1207"></span><span class="anchor" id="line-1208"></span><span class="anchor" id="line-1209"></span><span class="anchor" id="line-1210"></span><span class="anchor" id="line-1211"></span><span class="anchor" id="line-1212"></span><span class="anchor" id="line-1213"></span><span class="anchor" id="line-1214"></span><span class="anchor" id="line-1215"></span><span class="anchor" id="line-1-55"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_1">   1</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_1"></span><span class="anchor" id="line-1-56"></span><span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_2">   2</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_2"></span><span class="anchor" id="line-2-28"></span><span class="String">One of three degrees of enforcement may be specified by passing</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_3">   3</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_3"></span><span class="anchor" id="line-3-28"></span><span class="String">the 'debug' keyword argument to the decorator:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_4">   4</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_4"></span><span class="anchor" id="line-4-27"></span><span class="String">    0 -- NONE:   No type-checking. Decorators disabled.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_5">   5</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_5"></span><span class="anchor" id="line-5-27"></span><span class="String"> #!python</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_6">   6</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_6"></span><span class="anchor" id="line-6-27"></span><span class="String">-- MEDIUM: Print warning message to stderr. (Default)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_7">   7</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_7"></span><span class="anchor" id="line-7-27"></span><span class="String">    2 -- STRONG: Raise TypeError with message.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_8">   8</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_8"></span><span class="anchor" id="line-8-27"></span><span class="String">If 'debug' is not passed to the decorator, the default level is used.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_9">   9</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_9"></span><span class="anchor" id="line-9-27"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_10">  10</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_10"></span><span class="anchor" id="line-10-27"></span><span class="String">Example usage:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_11">  11</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_11"></span><span class="anchor" id="line-11-25"></span><span class="String">    &gt;&gt;&gt; NONE, MEDIUM, STRONG = 0, 1, 2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_12">  12</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_12"></span><span class="anchor" id="line-12-25"></span><span class="String">    &gt;&gt;&gt;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_13">  13</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_13"></span><span class="anchor" id="line-13-25"></span><span class="String">    &gt;&gt;&gt; @accepts(int, int, int)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_14">  14</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_14"></span><span class="anchor" id="line-14-25"></span><span class="String">    ... @returns(float)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_15">  15</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_15"></span><span class="anchor" id="line-15-25"></span><span class="String">    ... def average(x, y, z):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_16">  16</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_16"></span><span class="anchor" id="line-16-25"></span><span class="String">    ...     return (x + y + z) / 2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_17">  17</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_17"></span><span class="anchor" id="line-17-24"></span><span class="String">    ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_18">  18</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_18"></span><span class="anchor" id="line-18-24"></span><span class="String">    &gt;&gt;&gt; average(5.5, 10, 15.0)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_19">  19</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_19"></span><span class="anchor" id="line-19-23"></span><span class="String">    TypeWarning:  'average' method accepts (int, int, int), but was given</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_20">  20</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_20"></span><span class="anchor" id="line-20-22"></span><span class="String">    (float, int, float)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_21">  21</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_21"></span><span class="anchor" id="line-21-22"></span><span class="String">    15.25</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_22">  22</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_22"></span><span class="anchor" id="line-22-22"></span><span class="String">    &gt;&gt;&gt; average(5, 10, 15)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_23">  23</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_23"></span><span class="anchor" id="line-23-22"></span><span class="String">    TypeWarning:  'average' method returns (float), but result is (int)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_24">  24</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_24"></span><span class="anchor" id="line-24-20"></span><span class="String">    15</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_25">  25</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_25"></span><span class="anchor" id="line-25-20"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_26">  26</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_26"></span><span class="anchor" id="line-26-19"></span><span class="String">Needed to cast params as floats in function def (or simply divide by 2.0).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_27">  27</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_27"></span><span class="anchor" id="line-27-16"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_28">  28</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_28"></span><span class="anchor" id="line-28-14"></span><span class="String">    &gt;&gt;&gt; TYPE_CHECK = STRONG</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_29">  29</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_29"></span><span class="anchor" id="line-29-14"></span><span class="String">    &gt;&gt;&gt; @accepts(int, debug=TYPE_CHECK)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_30">  30</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_30"></span><span class="anchor" id="line-30-12"></span><span class="String">    ... @returns(int, debug=TYPE_CHECK)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_31">  31</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_31"></span><span class="anchor" id="line-31-11"></span><span class="String">    ... def fib(n):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_32">  32</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_32"></span><span class="anchor" id="line-32-11"></span><span class="String">    ...     if n in (0, 1): return n</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_33">  33</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_33"></span><span class="anchor" id="line-33-11"></span><span class="String">    ...     return fib(n-1) + fib(n-2)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_34">  34</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_34"></span><span class="anchor" id="line-34-10"></span><span class="String">    ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_35">  35</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_35"></span><span class="anchor" id="line-35-10"></span><span class="String">    &gt;&gt;&gt; fib(5.3)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_36">  36</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_36"></span><span class="anchor" id="line-36-10"></span><span class="String">    Traceback (most recent call last):</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_37">  37</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_37"></span><span class="anchor" id="line-37-10"></span><span class="String">      ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_38">  38</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_38"></span><span class="anchor" id="line-38-9"></span><span class="String">    TypeError: 'fib' method accepts (int), but was given (float)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_39">  39</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_39"></span><span class="anchor" id="line-39-9"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_40">  40</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_40"></span><span class="anchor" id="line-40-9"></span><span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_41">  41</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_41"></span><span class="anchor" id="line-41-8"></span><span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_42">  42</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_42"></span><span class="anchor" id="line-42-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_43">  43</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_43"></span><span class="anchor" id="line-43-6"></span><span class="ResWord">def</span> <span class="ID">accepts</span>(*<span class="ID">types</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_44">  44</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_44"></span><span class="anchor" id="line-44-6"></span>    <span class="String">'''Function decorator. Checks decorated function's arguments are</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_45">  45</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_45"></span><span class="anchor" id="line-45-6"></span><span class="String">    of the expected types.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_46">  46</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_46"></span><span class="anchor" id="line-46-6"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_47">  47</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_47"></span><span class="anchor" id="line-47-6"></span><span class="String">    Parameters:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_48">  48</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_48"></span><span class="anchor" id="line-48-5"></span><span class="String">    types -- The expected types of the inputs to the decorated function.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_49">  49</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_49"></span><span class="anchor" id="line-49-5"></span><span class="String">             Must specify type for each parameter.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_50">  50</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_50"></span><span class="anchor" id="line-50-4"></span><span class="String">    kw    -- Optional specification of 'debug' level (this is the only valid</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_51">  51</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_51"></span><span class="anchor" id="line-51-4"></span><span class="String">             keyword argument, no other should be given).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_52">  52</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_52"></span><span class="anchor" id="line-52-4"></span><span class="String">             debug = ( 0 | 1 | 2 )</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_53">  53</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_53"></span><span class="anchor" id="line-53-4"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_54">  54</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_54"></span><span class="anchor" id="line-54-4"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_55">  55</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_55"></span><span class="anchor" id="line-55-4"></span>    <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">kw</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_56">  56</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_56"></span><span class="anchor" id="line-56-4"></span>        <span class="Comment"># default level: MEDIUM</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_57">  57</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_57"></span><span class="anchor" id="line-57-4"></span>        <span class="ID">debug</span> = <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_58">  58</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_58"></span><span class="anchor" id="line-58-4"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_59">  59</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_59"></span><span class="anchor" id="line-59-4"></span>        <span class="ID">debug</span> = <span class="ID">kw</span>[<span class="String">'</span><span class="String">debug</span><span class="String">'</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_60">  60</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_60"></span><span class="anchor" id="line-60-4"></span>    <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_61">  61</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_61"></span><span class="anchor" id="line-61-4"></span>        <span class="ResWord">def</span> <span class="ID">decorator</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_62">  62</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_62"></span><span class="anchor" id="line-62-3"></span>            <span class="ResWord">def</span> <span class="ID">newf</span>(*<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_63">  63</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_63"></span><span class="anchor" id="line-63-3"></span>                <span class="ResWord">if</span> <span class="ID">debug</span> <span class="ResWord">is</span> <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_64">  64</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_64"></span><span class="anchor" id="line-64-3"></span>                    <span class="ResWord">return</span> <span class="ID">f</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_65">  65</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_65"></span><span class="anchor" id="line-65-3"></span>                <span class="ResWord">assert</span> <span class="ResWord">len</span>(<span class="ID">args</span>) == <span class="ResWord">len</span>(<span class="ID">types</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_66">  66</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_66"></span><span class="anchor" id="line-66-3"></span>                <span class="ID">argtypes</span> = <span class="ResWord">tuple</span>(<span class="ResWord">map</span>(<span class="ResWord">type</span>, <span class="ID">args</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_67">  67</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_67"></span><span class="anchor" id="line-67-3"></span>                <span class="ResWord">if</span> <span class="ID">argtypes</span> != <span class="ID">types</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_68">  68</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_68"></span><span class="anchor" id="line-68-3"></span>                    <span class="ID">msg</span> = <span class="ID">info</span>(<span class="ID">f</span>.<span class="ID">__name__</span>, <span class="ID">types</span>, <span class="ID">argtypes</span>, <span class="Number">0</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_69">  69</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_69"></span><span class="anchor" id="line-69-3"></span>                    <span class="ResWord">if</span> <span class="ID">debug</span> <span class="ResWord">is</span> <span class="Number">1</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_70">  70</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_70"></span><span class="anchor" id="line-70-3"></span>                        <span class="ResWord">print</span> &gt;&gt; <span class="ID">sys</span>.<span class="ID">stderr</span>, <span class="String">'</span><span class="String">TypeWarning: </span><span class="String">'</span>, <span class="ID">msg</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_71">  71</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_71"></span><span class="anchor" id="line-71-3"></span>                    <span class="ResWord">elif</span> <span class="ID">debug</span> <span class="ResWord">is</span> <span class="Number">2</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_72">  72</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_72"></span><span class="anchor" id="line-72-3"></span>                        <span class="ResWord">raise</span> <span class="ID">TypeError</span>, <span class="ID">msg</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_73">  73</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_73"></span><span class="anchor" id="line-73-3"></span>                <span class="ResWord">return</span> <span class="ID">f</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_74">  74</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_74"></span><span class="anchor" id="line-74-3"></span>            <span class="ID">newf</span>.<span class="ID">__name__</span> = <span class="ID">f</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_75">  75</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_75"></span><span class="anchor" id="line-75-3"></span>            <span class="ResWord">return</span> <span class="ID">newf</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_76">  76</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_76"></span><span class="anchor" id="line-76-3"></span>        <span class="ResWord">return</span> <span class="ID">decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_77">  77</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_77"></span><span class="anchor" id="line-77-3"></span>    <span class="ResWord">except</span> <span class="ID">KeyError</span>, <span class="ID">key</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_78">  78</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_78"></span><span class="anchor" id="line-78-3"></span>        <span class="ResWord">raise</span> <span class="ID">KeyError</span>, <span class="ID">key</span> + <span class="String">&quot;</span><span class="String">is not a valid keyword argument</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_79">  79</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_79"></span><span class="anchor" id="line-79-3"></span>    <span class="ResWord">except</span> <span class="ID">TypeError</span>, <span class="ID">msg</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_80">  80</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_80"></span><span class="anchor" id="line-80-3"></span>        <span class="ResWord">raise</span> <span class="ID">TypeError</span>, <span class="ID">msg</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_81">  81</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_81"></span><span class="anchor" id="line-81-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_82">  82</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_82"></span><span class="anchor" id="line-82-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_83">  83</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_83"></span><span class="anchor" id="line-83-3"></span><span class="ResWord">def</span> <span class="ID">returns</span>(<span class="ID">ret_type</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_84">  84</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_84"></span><span class="anchor" id="line-84-3"></span>    <span class="String">'''Function decorator. Checks decorated function's return value</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_85">  85</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_85"></span><span class="anchor" id="line-85-3"></span><span class="String">    is of the expected type.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_86">  86</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_86"></span><span class="anchor" id="line-86-3"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_87">  87</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_87"></span><span class="anchor" id="line-87-3"></span><span class="String">    Parameters:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_88">  88</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_88"></span><span class="anchor" id="line-88-3"></span><span class="String">    ret_type -- The expected type of the decorated function's return value.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_89">  89</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_89"></span><span class="anchor" id="line-89-3"></span><span class="String">                Must specify type for each parameter.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_90">  90</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_90"></span><span class="anchor" id="line-90-3"></span><span class="String">    kw       -- Optional specification of 'debug' level (this is the only valid</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_91">  91</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_91"></span><span class="anchor" id="line-91-3"></span><span class="String">                keyword argument, no other should be given).</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_92">  92</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_92"></span><span class="anchor" id="line-92-3"></span><span class="String">                debug=(0 | 1 | 2)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_93">  93</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_93"></span><span class="anchor" id="line-93-3"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_94">  94</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_94"></span><span class="anchor" id="line-94-3"></span>    <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_95">  95</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_95"></span><span class="anchor" id="line-95-3"></span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">kw</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_96">  96</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_96"></span><span class="anchor" id="line-96-3"></span>            <span class="Comment"># default level: MEDIUM</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_97">  97</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_97"></span><span class="anchor" id="line-97-3"></span>            <span class="ID">debug</span> = <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_98">  98</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_98"></span><span class="anchor" id="line-98-3"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_99">  99</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_99"></span><span class="anchor" id="line-99-3"></span>            <span class="ID">debug</span> = <span class="ID">kw</span>[<span class="String">'</span><span class="String">debug</span><span class="String">'</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_100"> 100</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_100"></span><span class="anchor" id="line-100-3"></span>        <span class="ResWord">def</span> <span class="ID">decorator</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_101"> 101</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_101"></span><span class="anchor" id="line-101-3"></span>            <span class="ResWord">def</span> <span class="ID">newf</span>(*<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_102"> 102</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_102"></span><span class="anchor" id="line-102-3"></span>                <span class="ID">result</span> = <span class="ID">f</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_103"> 103</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_103"></span><span class="anchor" id="line-103-3"></span>                <span class="ResWord">if</span> <span class="ID">debug</span> <span class="ResWord">is</span> <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_104"> 104</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_104"></span><span class="anchor" id="line-104-3"></span>                    <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_105"> 105</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_105"></span><span class="anchor" id="line-105-3"></span>                <span class="ID">res_type</span> = <span class="ResWord">type</span>(<span class="ID">result</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_106"> 106</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_106"></span><span class="anchor" id="line-106-3"></span>                <span class="ResWord">if</span> <span class="ID">res_type</span> != <span class="ID">ret_type</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_107"> 107</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_107"></span><span class="anchor" id="line-107-3"></span>                    <span class="ID">msg</span> = <span class="ID">info</span>(<span class="ID">f</span>.<span class="ID">__name__</span>, (<span class="ID">ret_type</span>,), (<span class="ID">res_type</span>,), <span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_108"> 108</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_108"></span><span class="anchor" id="line-108-3"></span>                    <span class="ResWord">if</span> <span class="ID">debug</span> <span class="ResWord">is</span> <span class="Number">1</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_109"> 109</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_109"></span><span class="anchor" id="line-109-3"></span>                        <span class="ResWord">print</span> &gt;&gt; <span class="ID">sys</span>.<span class="ID">stderr</span>, <span class="String">'</span><span class="String">TypeWarning: </span><span class="String">'</span>, <span class="ID">msg</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_110"> 110</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_110"></span><span class="anchor" id="line-110-3"></span>                    <span class="ResWord">elif</span> <span class="ID">debug</span> <span class="ResWord">is</span> <span class="Number">2</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_111"> 111</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_111"></span><span class="anchor" id="line-111-3"></span>                        <span class="ResWord">raise</span> <span class="ID">TypeError</span>, <span class="ID">msg</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_112"> 112</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_112"></span><span class="anchor" id="line-112-3"></span>                <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_113"> 113</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_113"></span><span class="anchor" id="line-113-3"></span>            <span class="ID">newf</span>.<span class="ID">__name__</span> = <span class="ID">f</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_114"> 114</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_114"></span><span class="anchor" id="line-114-3"></span>            <span class="ResWord">return</span> <span class="ID">newf</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_115"> 115</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_115"></span><span class="anchor" id="line-115-3"></span>        <span class="ResWord">return</span> <span class="ID">decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_116"> 116</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_116"></span><span class="anchor" id="line-116-3"></span>    <span class="ResWord">except</span> <span class="ID">KeyError</span>, <span class="ID">key</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_117"> 117</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_117"></span><span class="anchor" id="line-117-2"></span>        <span class="ResWord">raise</span> <span class="ID">KeyError</span>, <span class="ID">key</span> + <span class="String">&quot;</span><span class="String">is not a valid keyword argument</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_118"> 118</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_118"></span><span class="anchor" id="line-118-2"></span>    <span class="ResWord">except</span> <span class="ID">TypeError</span>, <span class="ID">msg</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_119"> 119</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_119"></span><span class="anchor" id="line-119-2"></span>        <span class="ResWord">raise</span> <span class="ID">TypeError</span>, <span class="ID">msg</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_120"> 120</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_120"></span><span class="anchor" id="line-120-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_121"> 121</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_121"></span><span class="anchor" id="line-121-2"></span><span class="ResWord">def</span> <span class="ID">info</span>(<span class="ID">fname</span>, <span class="ID">expected</span>, <span class="ID">actual</span>, <span class="ID">flag</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_122"> 122</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_122"></span><span class="anchor" id="line-122-2"></span>    <span class="String">'''Convenience function returns nicely formatted error/warning msg.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_123"> 123</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_123"></span><span class="anchor" id="line-123-2"></span>    <span class="ID">format</span> = <span class="ResWord">lambda</span> <span class="ID">types</span>: <span class="String">'</span><span class="String">, </span><span class="String">'</span>.<span class="ID">join</span>([<span class="ResWord">str</span>(<span class="ID">t</span>).<span class="ID">split</span>(<span class="String">&quot;</span><span class="String">'</span><span class="String">&quot;</span>)[<span class="Number">1</span>] <span class="ResWord">for</span> <span class="ID">t</span> <span class="ResWord">in</span> <span class="ID">types</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_124"> 124</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_124"></span><span class="anchor" id="line-124-2"></span>    <span class="ID">expected</span>, <span class="ID">actual</span> = <span class="ID">format</span>(<span class="ID">expected</span>), <span class="ID">format</span>(<span class="ID">actual</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_125"> 125</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_125"></span><span class="anchor" id="line-125-2"></span>    <span class="ID">msg</span> = <span class="String">&quot;</span><span class="String">'</span><span class="String">{}</span><span class="String">'</span><span class="String"> method </span><span class="String">&quot;</span>.<span class="ID">format</span>( <span class="ID">fname</span> )\</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_126"> 126</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_126"></span><span class="anchor" id="line-126-2"></span>          + (<span class="String">&quot;</span><span class="String">accepts</span><span class="String">&quot;</span>, <span class="String">&quot;</span><span class="String">returns</span><span class="String">&quot;</span>)[<span class="ID">flag</span>] + <span class="String">&quot;</span><span class="String"> ({}), but </span><span class="String">&quot;</span>.<span class="ID">format</span>(<span class="ID">expected</span>)\</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_127"> 127</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_127"></span><span class="anchor" id="line-127-2"></span>          + (<span class="String">&quot;</span><span class="String">was given</span><span class="String">&quot;</span>, <span class="String">&quot;</span><span class="String">result is</span><span class="String">&quot;</span>)[<span class="ID">flag</span>] + <span class="String">&quot;</span><span class="String"> ({})</span><span class="String">&quot;</span>.<span class="ID">format</span>(<span class="ID">actual</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_128"> 128</a> </span><span class="LineAnchor" id="CA-3f6fec70c7d7bf3088b427eb9972af63d8b674ae_128"></span><span class="anchor" id="line-128-2"></span>    <span class="ResWord">return</span> <span class="ID">msg</span></span>
</pre></div></div><span class="anchor" id="line-1216"></span><p class="line867">
<h2 id="CGI_method_wrapper">CGI method wrapper</h2>
<span class="anchor" id="line-1217"></span><p class="line874">Handles HTML boilerplate at top and bottom of pages returned from CGI methods. Works with the cgi module. Now your request handlers can just output the interesting HTML, and let the decorator deal with all the top and bottom clutter. <span class="anchor" id="line-1218"></span><span class="anchor" id="line-1219"></span><p class="line874">(Note: the exception handler eats all exceptions, which in CGI is no big loss, since the program runs in its separate subprocess. At least here, the exception contents will be written to the output page.) <span class="anchor" id="line-1220"></span><span class="anchor" id="line-1221"></span><p class="line867"><span class="anchor" id="line-1222"></span><span class="anchor" id="line-1223"></span><span class="anchor" id="line-1224"></span><span class="anchor" id="line-1225"></span><span class="anchor" id="line-1226"></span><span class="anchor" id="line-1227"></span><span class="anchor" id="line-1228"></span><span class="anchor" id="line-1229"></span><span class="anchor" id="line-1230"></span><span class="anchor" id="line-1231"></span><span class="anchor" id="line-1232"></span><span class="anchor" id="line-1233"></span><span class="anchor" id="line-1234"></span><span class="anchor" id="line-1235"></span><span class="anchor" id="line-1236"></span><span class="anchor" id="line-1237"></span><span class="anchor" id="line-1238"></span><span class="anchor" id="line-1239"></span><span class="anchor" id="line-1240"></span><span class="anchor" id="line-1241"></span><span class="anchor" id="line-1242"></span><span class="anchor" id="line-1243"></span><span class="anchor" id="line-1244"></span><span class="anchor" id="line-1245"></span><span class="anchor" id="line-1-57"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_1">   1</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_1"></span><span class="anchor" id="line-1-58"></span><span class="ResWord">class</span> <span class="ID">CGImethod</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_2">   2</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_2"></span><span class="anchor" id="line-2-29"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">title</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_3">   3</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_3"></span><span class="anchor" id="line-3-29"></span>        <span class="ResWord">self</span>.<span class="ID">title</span> = <span class="ID">title</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_4">   4</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_4"></span><span class="anchor" id="line-4-28"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_5">   5</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_5"></span><span class="anchor" id="line-5-28"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, <span class="ID">fn</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_6">   6</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_6"></span><span class="anchor" id="line-6-28"></span>        <span class="ResWord">def</span> <span class="ID">wrapped_fn</span>(*<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_7">   7</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_7"></span><span class="anchor" id="line-7-28"></span>            <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Content-Type: text/html</span><span class="SPChar">\n</span><span class="SPChar">\n</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_8">   8</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_8"></span><span class="anchor" id="line-8-28"></span>            <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">&lt;HTML&gt;</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_9">   9</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_9"></span><span class="anchor" id="line-9-28"></span>            <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">&lt;HEAD&gt;&lt;TITLE&gt;{}&lt;/TITLE&gt;&lt;/HEAD&gt;</span><span class="String">&quot;</span>.<span class="ID">format</span>(<span class="ResWord">self</span>.<span class="ID">title</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_10">  10</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_10"></span><span class="anchor" id="line-10-28"></span>            <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">&lt;BODY&gt;</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_11">  11</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_11"></span><span class="anchor" id="line-11-26"></span>            <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_12">  12</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_12"></span><span class="anchor" id="line-12-26"></span>                <span class="ID">fn</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_13">  13</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_13"></span><span class="anchor" id="line-13-26"></span>            <span class="ResWord">except</span> <span class="ID">Exception</span>, <span class="ID">e</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_14">  14</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_14"></span><span class="anchor" id="line-14-26"></span>                <span class="ResWord">print</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_15">  15</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_15"></span><span class="anchor" id="line-15-26"></span>                <span class="ResWord">print</span> <span class="ID">e</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_16">  16</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_16"></span><span class="anchor" id="line-16-26"></span>            <span class="ResWord">print</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_17">  17</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_17"></span><span class="anchor" id="line-17-25"></span>            <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">&lt;/BODY&gt;&lt;/HTML&gt;</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_18">  18</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_18"></span><span class="anchor" id="line-18-25"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_19">  19</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_19"></span><span class="anchor" id="line-19-24"></span>        <span class="ResWord">return</span> <span class="ID">wrapped_fn</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_20">  20</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_20"></span><span class="anchor" id="line-20-23"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_21">  21</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_21"></span><span class="anchor" id="line-21-23"></span><span class="ID">@CGImethod</span>(<span class="String">&quot;</span><span class="String">Hello with Decorator</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_22">  22</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_22"></span><span class="anchor" id="line-22-23"></span><span class="ResWord">def</span> <span class="ID">say_hello</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_23">  23</a> </span><span class="LineAnchor" id="CA-0784a7b9618cb90eb3dc21b376d1f773f3fa75ad_23"></span><span class="anchor" id="line-23-23"></span>    <span class="ResWord">print</span> <span class="String">'</span><span class="String">&lt;h1&gt;Hello from CGI-Land&lt;/h1&gt;</span><span class="String">'</span></span>
</pre></div></div><span class="anchor" id="line-1246"></span><p class="line867">
<h2 id="State_Machine_Implementaion">State Machine Implementaion</h2>
<span class="anchor" id="line-1247"></span><p class="line862">A much improved version of decorators for implementing state machines, too long to show here, is at <a href="/moin/State%20Machine%20via%20Decorators">State Machine via Decorators</a> <span class="anchor" id="line-1248"></span><span class="anchor" id="line-1249"></span><p class="line874">This example uses Decorators to facilitate the implementation of a state machine in Python. Decorators are used to specify which methods are the event handlers for the class. In this example, actions are associated with the transitions, but it is possible with a little consideration to associate actions with states instead. <span class="anchor" id="line-1250"></span><span class="anchor" id="line-1251"></span><p class="line862">The example defines a class, <a class="nonexistent" href="/moin/MyMachine">MyMachine</a> that is a state machine. Multiple instances of the class may be instantiated with each maintaining its own state. A class also may have multiple states. Here I've used gstate and tstate. <span class="anchor" id="line-1252"></span><span class="anchor" id="line-1253"></span><p class="line874">The code in the imported statedefn file gets a bit hairy, but you may not need to delve into it for your application. <span class="anchor" id="line-1254"></span><span class="anchor" id="line-1255"></span><p class="line867"><span class="anchor" id="line-1256"></span><span class="anchor" id="line-1257"></span><span class="anchor" id="line-1258"></span><span class="anchor" id="line-1259"></span><span class="anchor" id="line-1260"></span><span class="anchor" id="line-1261"></span><span class="anchor" id="line-1262"></span><span class="anchor" id="line-1263"></span><span class="anchor" id="line-1264"></span><span class="anchor" id="line-1265"></span><span class="anchor" id="line-1266"></span><span class="anchor" id="line-1267"></span><span class="anchor" id="line-1268"></span><span class="anchor" id="line-1269"></span><span class="anchor" id="line-1270"></span><span class="anchor" id="line-1271"></span><span class="anchor" id="line-1272"></span><span class="anchor" id="line-1273"></span><span class="anchor" id="line-1274"></span><span class="anchor" id="line-1275"></span><span class="anchor" id="line-1276"></span><span class="anchor" id="line-1277"></span><span class="anchor" id="line-1278"></span><span class="anchor" id="line-1279"></span><span class="anchor" id="line-1280"></span><span class="anchor" id="line-1281"></span><span class="anchor" id="line-1282"></span><span class="anchor" id="line-1283"></span><span class="anchor" id="line-1284"></span><span class="anchor" id="line-1285"></span><span class="anchor" id="line-1286"></span><span class="anchor" id="line-1287"></span><span class="anchor" id="line-1288"></span><span class="anchor" id="line-1289"></span><span class="anchor" id="line-1290"></span><span class="anchor" id="line-1291"></span><span class="anchor" id="line-1292"></span><span class="anchor" id="line-1293"></span><span class="anchor" id="line-1294"></span><span class="anchor" id="line-1295"></span><span class="anchor" id="line-1296"></span><span class="anchor" id="line-1297"></span><span class="anchor" id="line-1298"></span><span class="anchor" id="line-1299"></span><span class="anchor" id="line-1300"></span><span class="anchor" id="line-1301"></span><span class="anchor" id="line-1302"></span><span class="anchor" id="line-1303"></span><span class="anchor" id="line-1304"></span><span class="anchor" id="line-1305"></span><span class="anchor" id="line-1306"></span><span class="anchor" id="line-1307"></span><span class="anchor" id="line-1308"></span><span class="anchor" id="line-1309"></span><span class="anchor" id="line-1310"></span><span class="anchor" id="line-1311"></span><span class="anchor" id="line-1312"></span><span class="anchor" id="line-1313"></span><span class="anchor" id="line-1314"></span><span class="anchor" id="line-1315"></span><span class="anchor" id="line-1316"></span><span class="anchor" id="line-1317"></span><span class="anchor" id="line-1318"></span><span class="anchor" id="line-1319"></span><span class="anchor" id="line-1320"></span><span class="anchor" id="line-1321"></span><span class="anchor" id="line-1322"></span><span class="anchor" id="line-1323"></span><span class="anchor" id="line-1324"></span><span class="anchor" id="line-1325"></span><span class="anchor" id="line-1326"></span><span class="anchor" id="line-1327"></span><span class="anchor" id="line-1328"></span><span class="anchor" id="line-1329"></span><span class="anchor" id="line-1330"></span><span class="anchor" id="line-1331"></span><span class="anchor" id="line-1332"></span><span class="anchor" id="line-1333"></span><span class="anchor" id="line-1334"></span><span class="anchor" id="line-1335"></span><span class="anchor" id="line-1336"></span><span class="anchor" id="line-1337"></span><span class="anchor" id="line-1338"></span><span class="anchor" id="line-1339"></span><span class="anchor" id="line-1340"></span><span class="anchor" id="line-1341"></span><span class="anchor" id="line-1342"></span><span class="anchor" id="line-1343"></span><span class="anchor" id="line-1344"></span><span class="anchor" id="line-1345"></span><span class="anchor" id="line-1346"></span><span class="anchor" id="line-1347"></span><span class="anchor" id="line-1348"></span><span class="anchor" id="line-1349"></span><span class="anchor" id="line-1350"></span><span class="anchor" id="line-1351"></span><span class="anchor" id="line-1352"></span><span class="anchor" id="line-1353"></span><span class="anchor" id="line-1354"></span><span class="anchor" id="line-1355"></span><span class="anchor" id="line-1356"></span><span class="anchor" id="line-1357"></span><span class="anchor" id="line-1358"></span><span class="anchor" id="line-1359"></span><span class="anchor" id="line-1360"></span><span class="anchor" id="line-1361"></span><span class="anchor" id="line-1362"></span><span class="anchor" id="line-1363"></span><span class="anchor" id="line-1364"></span><span class="anchor" id="line-1365"></span><span class="anchor" id="line-1366"></span><span class="anchor" id="line-1367"></span><span class="anchor" id="line-1368"></span><span class="anchor" id="line-1369"></span><span class="anchor" id="line-1370"></span><span class="anchor" id="line-1371"></span><span class="anchor" id="line-1372"></span><span class="anchor" id="line-1373"></span><span class="anchor" id="line-1374"></span><span class="anchor" id="line-1375"></span><span class="anchor" id="line-1376"></span><span class="anchor" id="line-1377"></span><span class="anchor" id="line-1378"></span><span class="anchor" id="line-1379"></span><span class="anchor" id="line-1380"></span><span class="anchor" id="line-1381"></span><span class="anchor" id="line-1382"></span><span class="anchor" id="line-1383"></span><span class="anchor" id="line-1384"></span><span class="anchor" id="line-1385"></span><span class="anchor" id="line-1386"></span><span class="anchor" id="line-1387"></span><span class="anchor" id="line-1388"></span><span class="anchor" id="line-1389"></span><span class="anchor" id="line-1390"></span><span class="anchor" id="line-1391"></span><span class="anchor" id="line-1392"></span><span class="anchor" id="line-1393"></span><span class="anchor" id="line-1394"></span><span class="anchor" id="line-1395"></span><span class="anchor" id="line-1396"></span><span class="anchor" id="line-1397"></span><span class="anchor" id="line-1398"></span><span class="anchor" id="line-1399"></span><span class="anchor" id="line-1400"></span><span class="anchor" id="line-1401"></span><span class="anchor" id="line-1402"></span><span class="anchor" id="line-1403"></span><span class="anchor" id="line-1404"></span><span class="anchor" id="line-1405"></span><span class="anchor" id="line-1406"></span><span class="anchor" id="line-1-59"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_1">   1</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_1"></span><span class="anchor" id="line-1-60"></span><span class="Comment"># State Machine example Program</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_2">   2</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_2"></span><span class="anchor" id="line-2-30"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_3">   3</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_3"></span><span class="anchor" id="line-3-30"></span><span class="ResWord">from</span> <span class="ID">statedefn</span> <span class="ResWord">import</span> *</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_4">   4</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_4"></span><span class="anchor" id="line-4-29"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_5">   5</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_5"></span><span class="anchor" id="line-5-29"></span><span class="ResWord">class</span> <span class="ID">MyMachine</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_6">   6</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_6"></span><span class="anchor" id="line-6-29"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_7">   7</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_7"></span><span class="anchor" id="line-7-29"></span>    <span class="Comment"># Create Statedefn object for each state you need to keep track of.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_8">   8</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_8"></span><span class="anchor" id="line-8-29"></span>    <span class="Comment"># the name passed to the constructor becomes a StateVar member of the current class.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_9">   9</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_9"></span><span class="anchor" id="line-9-29"></span>    <span class="Comment"># i.e. if my_obj is a MyMachine object, my_obj.gstate maintains the current gstate</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_10">  10</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_10"></span><span class="anchor" id="line-10-29"></span>    <span class="ID">gstate</span> = <span class="ID">StateTable</span>(<span class="String">&quot;</span><span class="String">gstate</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_11">  11</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_11"></span><span class="anchor" id="line-11-27"></span>    <span class="ID">tstate</span> = <span class="ID">StateTable</span>(<span class="String">&quot;</span><span class="String">turtle</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_12">  12</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_12"></span><span class="anchor" id="line-12-27"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_13">  13</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_13"></span><span class="anchor" id="line-13-27"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">name</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_14">  14</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_14"></span><span class="anchor" id="line-14-27"></span>        <span class="Comment"># must call init method of class's StateTable object. to initialize state variable</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_15">  15</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_15"></span><span class="anchor" id="line-15-27"></span>        <span class="ResWord">self</span>.<span class="ID">gstate</span>.<span class="ID">initialize</span>(<span class="ResWord">self</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_16">  16</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_16"></span><span class="anchor" id="line-16-27"></span>        <span class="ResWord">self</span>.<span class="ID">tstate</span>.<span class="ID">initialize</span>(<span class="ResWord">self</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_17">  17</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_17"></span><span class="anchor" id="line-17-26"></span>        <span class="ResWord">self</span>.<span class="ID">mname</span> = <span class="ID">name</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_18">  18</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_18"></span><span class="anchor" id="line-18-26"></span>        <span class="ResWord">self</span>.<span class="ID">a_count</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_19">  19</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_19"></span><span class="anchor" id="line-19-25"></span>        <span class="ResWord">self</span>.<span class="ID">b_count</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_20">  20</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_20"></span><span class="anchor" id="line-20-24"></span>        <span class="ResWord">self</span>.<span class="ID">c_count</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_21">  21</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_21"></span><span class="anchor" id="line-21-24"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_22">  22</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_22"></span><span class="anchor" id="line-22-24"></span>    <span class="Comment"># Decorate the Event Handler virtual functions -note gstate parameter</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_23">  23</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_23"></span><span class="anchor" id="line-23-24"></span>    <span class="ID">@event_handler</span>(<span class="ID">gstate</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_24">  24</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_24"></span><span class="anchor" id="line-24-21"></span>    <span class="ResWord">def</span> <span class="ID">event_a</span>(<span class="ResWord">self</span>): <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_25">  25</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_25"></span><span class="anchor" id="line-25-21"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_26">  26</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_26"></span><span class="anchor" id="line-26-20"></span>    <span class="ID">@event_handler</span>(<span class="ID">gstate</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_27">  27</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_27"></span><span class="anchor" id="line-27-17"></span>    <span class="ResWord">def</span> <span class="ID">event_b</span>(<span class="ResWord">self</span>): <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_28">  28</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_28"></span><span class="anchor" id="line-28-15"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_29">  29</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_29"></span><span class="anchor" id="line-29-15"></span>    <span class="ID">@event_handler</span>(<span class="ID">gstate</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_30">  30</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_30"></span><span class="anchor" id="line-30-13"></span>    <span class="ResWord">def</span> <span class="ID">event_c</span>(<span class="ResWord">self</span>, <span class="ID">val</span>): <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_31">  31</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_31"></span><span class="anchor" id="line-31-12"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_32">  32</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_32"></span><span class="anchor" id="line-32-12"></span>    <span class="ID">@event_handler</span>(<span class="ID">tstate</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_33">  33</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_33"></span><span class="anchor" id="line-33-12"></span>    <span class="ResWord">def</span> <span class="ID">toggle</span>(<span class="ResWord">self</span>): <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_34">  34</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_34"></span><span class="anchor" id="line-34-11"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_35">  35</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_35"></span><span class="anchor" id="line-35-11"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_36">  36</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_36"></span><span class="anchor" id="line-36-11"></span>    <span class="Comment"># define methods to handle events.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_37">  37</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_37"></span><span class="anchor" id="line-37-11"></span>    <span class="ResWord">def</span> <span class="ID">_event_a_hdlr1</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_38">  38</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_38"></span><span class="anchor" id="line-38-10"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 1, event A</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_39">  39</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_39"></span><span class="anchor" id="line-39-10"></span>        <span class="ResWord">self</span>.<span class="ID">a_count</span> += <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_40">  40</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_40"></span><span class="anchor" id="line-40-10"></span>    <span class="ResWord">def</span> <span class="ID">_event_b_hdlr1</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_41">  41</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_41"></span><span class="anchor" id="line-41-9"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 1, event B</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_42">  42</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_42"></span><span class="anchor" id="line-42-7"></span>        <span class="ResWord">self</span>.<span class="ID">b_count</span> += <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_43">  43</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_43"></span><span class="anchor" id="line-43-7"></span>    <span class="ResWord">def</span> <span class="ID">_event_c_hdlr1</span>(<span class="ResWord">self</span>, <span class="ID">val</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_44">  44</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_44"></span><span class="anchor" id="line-44-7"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 1, event C</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_45">  45</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_45"></span><span class="anchor" id="line-45-7"></span>        <span class="ResWord">self</span>.<span class="ID">c_count</span> += <span class="Number">3</span>*<span class="ID">val</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_46">  46</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_46"></span><span class="anchor" id="line-46-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_47">  47</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_47"></span><span class="anchor" id="line-47-7"></span>    <span class="ResWord">def</span> <span class="ID">_event_a_hdlr2</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_48">  48</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_48"></span><span class="anchor" id="line-48-6"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 2, event A</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_49">  49</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_49"></span><span class="anchor" id="line-49-6"></span>        <span class="ResWord">self</span>.<span class="ID">a_count</span> += <span class="Number">10</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_50">  50</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_50"></span><span class="anchor" id="line-50-5"></span>        <span class="Comment"># here we brute force the tstate to on, leave &amp; enter functions called if state changes.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_51">  51</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_51"></span><span class="anchor" id="line-51-5"></span>        <span class="Comment"># turtle is object's state variable for tstate, comes from constructor argument</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_52">  52</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_52"></span><span class="anchor" id="line-52-5"></span>        <span class="ResWord">self</span>.<span class="ID">turtle</span>.<span class="ID">set_state</span>(<span class="ResWord">self</span>, <span class="ResWord">self</span>.<span class="ID">_t_on</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_53">  53</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_53"></span><span class="anchor" id="line-53-5"></span>    <span class="ResWord">def</span> <span class="ID">_event_b_hdlr2</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_54">  54</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_54"></span><span class="anchor" id="line-54-5"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 2, event B</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_55">  55</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_55"></span><span class="anchor" id="line-55-5"></span>        <span class="ResWord">self</span>.<span class="ID">b_count</span> += <span class="Number">10</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_56">  56</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_56"></span><span class="anchor" id="line-56-5"></span>    <span class="ResWord">def</span> <span class="ID">_event_c_hdlr2</span>(<span class="ResWord">self</span>, <span class="ID">val</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_57">  57</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_57"></span><span class="anchor" id="line-57-5"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 2, event C</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_58">  58</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_58"></span><span class="anchor" id="line-58-5"></span>        <span class="ResWord">self</span>.<span class="ID">c_count</span> += <span class="Number">2</span>*<span class="ID">val</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_59">  59</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_59"></span><span class="anchor" id="line-59-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_60">  60</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_60"></span><span class="anchor" id="line-60-5"></span>    <span class="ResWord">def</span> <span class="ID">_event_a_hdlr3</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_61">  61</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_61"></span><span class="anchor" id="line-61-5"></span>        <span class="ResWord">self</span>.<span class="ID">a_count</span> += <span class="Number">100</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_62">  62</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_62"></span><span class="anchor" id="line-62-4"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 3, event A</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_63">  63</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_63"></span><span class="anchor" id="line-63-4"></span>    <span class="ResWord">def</span> <span class="ID">_event_b_hdlr3</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_64">  64</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_64"></span><span class="anchor" id="line-64-4"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 3, event B</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_65">  65</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_65"></span><span class="anchor" id="line-65-4"></span>        <span class="ResWord">self</span>.<span class="ID">b_count</span> += <span class="Number">100</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_66">  66</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_66"></span><span class="anchor" id="line-66-4"></span>        <span class="Comment"># we decide here we want to go to state 2, overrrides spec in state table below.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_67">  67</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_67"></span><span class="anchor" id="line-67-4"></span>        <span class="Comment"># transition to next_state is made after the method exits.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_68">  68</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_68"></span><span class="anchor" id="line-68-4"></span>        <span class="ResWord">self</span>.<span class="ID">gstate</span>.<span class="ID">next_state</span> = <span class="ResWord">self</span>.<span class="ID">_state2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_69">  69</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_69"></span><span class="anchor" id="line-69-4"></span>    <span class="ResWord">def</span> <span class="ID">_event_c_hdlr3</span>(<span class="ResWord">self</span>, <span class="ID">val</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_70">  70</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_70"></span><span class="anchor" id="line-70-4"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">State 3, event C</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_71">  71</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_71"></span><span class="anchor" id="line-71-4"></span>        <span class="ResWord">self</span>.<span class="ID">c_count</span> += <span class="Number">5</span>*<span class="ID">val</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_72">  72</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_72"></span><span class="anchor" id="line-72-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_73">  73</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_73"></span><span class="anchor" id="line-73-4"></span>    <span class="Comment"># Associate the handlers with a state. The first argument is a list of methods.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_74">  74</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_74"></span><span class="anchor" id="line-74-4"></span>    <span class="Comment"># One method for each event_handler decorated function of gstate. Order of methods</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_75">  75</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_75"></span><span class="anchor" id="line-75-4"></span>    <span class="Comment"># in the list correspond to order in which the Event Handlers were declared.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_76">  76</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_76"></span><span class="anchor" id="line-76-4"></span>    <span class="Comment"># Second arg is the name of the state.  Third argument is to be come a list of the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_77">  77</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_77"></span><span class="anchor" id="line-77-4"></span>    <span class="Comment"># next states.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_78">  78</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_78"></span><span class="anchor" id="line-78-4"></span>    <span class="Comment"># The first state created becomes the initial state.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_79">  79</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_79"></span><span class="anchor" id="line-79-4"></span>    <span class="ID">_state1</span> = <span class="ID">gstate</span>.<span class="ID">state</span>(<span class="String">&quot;</span><span class="String">One</span><span class="String">&quot;</span>,  (<span class="ID">_event_a_hdlr1</span>, <span class="ID">_event_b_hdlr1</span>, <span class="ID">_event_c_hdlr1</span>),</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_80">  80</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_80"></span><span class="anchor" id="line-80-4"></span>                                      (<span class="String">&quot;</span><span class="String">Two</span><span class="String">&quot;</span>, <span class="String">&quot;</span><span class="String">Three</span><span class="String">&quot;</span>, <span class="ResWord">None</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_81">  81</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_81"></span><span class="anchor" id="line-81-4"></span>    <span class="ID">_state2</span> = <span class="ID">gstate</span>.<span class="ID">state</span>(<span class="String">&quot;</span><span class="String">Two</span><span class="String">&quot;</span>,  (<span class="ID">_event_a_hdlr2</span>, <span class="ID">_event_b_hdlr2</span>, <span class="ID">_event_c_hdlr2</span>),</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_82">  82</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_82"></span><span class="anchor" id="line-82-4"></span>                                     (<span class="String">&quot;</span><span class="String">Three</span><span class="String">&quot;</span>,        <span class="ResWord">None</span>,          <span class="String">&quot;</span><span class="String">One</span><span class="String">&quot;</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_83">  83</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_83"></span><span class="anchor" id="line-83-4"></span>    <span class="ID">_state3</span> = <span class="ID">gstate</span>.<span class="ID">state</span>(<span class="String">&quot;</span><span class="String">Three</span><span class="String">&quot;</span>,(<span class="ID">_event_a_hdlr3</span>, <span class="ID">_event_b_hdlr3</span>, <span class="ID">_event_c_hdlr3</span>),</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_84">  84</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_84"></span><span class="anchor" id="line-84-4"></span>                                 (<span class="ResWord">None</span>,         <span class="String">&quot;</span><span class="String">One</span><span class="String">&quot;</span>,         <span class="String">&quot;</span><span class="String">Two</span><span class="String">&quot;</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_85">  85</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_85"></span><span class="anchor" id="line-85-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_86">  86</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_86"></span><span class="anchor" id="line-86-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_87">  87</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_87"></span><span class="anchor" id="line-87-4"></span>    <span class="Comment"># Declare a function that will be called when entering a new gstate.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_88">  88</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_88"></span><span class="anchor" id="line-88-4"></span>    <span class="Comment"># Can also declare a leave function using @on_leave_function(gstate)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_89">  89</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_89"></span><span class="anchor" id="line-89-4"></span>    <span class="ID">@on_enter_function</span>(<span class="ID">gstate</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_90">  90</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_90"></span><span class="anchor" id="line-90-4"></span>    <span class="ResWord">def</span> <span class="ID">_enter_gstate</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_91">  91</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_91"></span><span class="anchor" id="line-91-4"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">entering state </span><span class="String">&quot;</span>, <span class="ResWord">self</span>.<span class="ID">gstate</span>.<span class="ID">name</span>() , <span class="String">&quot;</span><span class="String">of </span><span class="String">&quot;</span>, <span class="ResWord">self</span>.<span class="ID">mname</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_92">  92</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_92"></span><span class="anchor" id="line-92-4"></span>    <span class="ID">@on_leave_function</span>(<span class="ID">tstate</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_93">  93</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_93"></span><span class="anchor" id="line-93-4"></span>    <span class="ResWord">def</span> <span class="ID">_leave_tstate</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_94">  94</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_94"></span><span class="anchor" id="line-94-4"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">leaving state </span><span class="String">&quot;</span>, <span class="ResWord">self</span>.<span class="ID">turtle</span>.<span class="ID">name</span>() , <span class="String">&quot;</span><span class="String">of </span><span class="String">&quot;</span>, <span class="ResWord">self</span>.<span class="ID">mname</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_95">  95</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_95"></span><span class="anchor" id="line-95-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_96">  96</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_96"></span><span class="anchor" id="line-96-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_97">  97</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_97"></span><span class="anchor" id="line-97-4"></span>    <span class="ResWord">def</span> <span class="ID">_toggle_on</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_98">  98</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_98"></span><span class="anchor" id="line-98-4"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Toggle On</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_99">  99</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_99"></span><span class="anchor" id="line-99-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_100"> 100</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_100"></span><span class="anchor" id="line-100-4"></span>    <span class="ResWord">def</span> <span class="ID">_toggle_off</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_101"> 101</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_101"></span><span class="anchor" id="line-101-4"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Toggle Off</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_102"> 102</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_102"></span><span class="anchor" id="line-102-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_103"> 103</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_103"></span><span class="anchor" id="line-103-4"></span>    <span class="ID">_t_off</span> = <span class="ID">tstate</span>.<span class="ID">state</span>(<span class="String">&quot;</span><span class="String">Off</span><span class="String">&quot;</span>, [<span class="ID">_toggle_on</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_104"> 104</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_104"></span><span class="anchor" id="line-104-4"></span>                         [<span class="String">&quot;</span><span class="String">On</span><span class="String">&quot;</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_105"> 105</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_105"></span><span class="anchor" id="line-105-4"></span>    <span class="ID">_t_on</span> =  <span class="ID">tstate</span>.<span class="ID">state</span>(<span class="String">&quot;</span><span class="String">On</span><span class="String">&quot;</span>, [<span class="ID">_toggle_off</span>],</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_106"> 106</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_106"></span><span class="anchor" id="line-106-4"></span>                          [<span class="String">&quot;</span><span class="String">Off</span><span class="String">&quot;</span>])</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_107"> 107</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_107"></span><span class="anchor" id="line-107-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_108"> 108</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_108"></span><span class="anchor" id="line-108-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_109"> 109</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_109"></span><span class="anchor" id="line-109-4"></span><span class="ResWord">def</span> <span class="ID">main</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_110"> 110</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_110"></span><span class="anchor" id="line-110-4"></span>    <span class="ID">big_machine</span> = <span class="ID">MyMachine</span>(<span class="String">&quot;</span><span class="String">big</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_111"> 111</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_111"></span><span class="anchor" id="line-111-4"></span>    <span class="ID">lil_machine</span> = <span class="ID">MyMachine</span>(<span class="String">&quot;</span><span class="String">lil</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_112"> 112</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_112"></span><span class="anchor" id="line-112-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_113"> 113</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_113"></span><span class="anchor" id="line-113-4"></span>    <span class="ID">big_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_114"> 114</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_114"></span><span class="anchor" id="line-114-4"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_115"> 115</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_115"></span><span class="anchor" id="line-115-4"></span>    <span class="ID">big_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_116"> 116</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_116"></span><span class="anchor" id="line-116-4"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_117"> 117</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_117"></span><span class="anchor" id="line-117-3"></span>    <span class="ID">big_machine</span>.<span class="ID">event_b</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_118"> 118</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_118"></span><span class="anchor" id="line-118-3"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_b</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_119"> 119</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_119"></span><span class="anchor" id="line-119-3"></span>    <span class="ID">big_machine</span>.<span class="ID">event_c</span>(<span class="Number">4</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_120"> 120</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_120"></span><span class="anchor" id="line-120-3"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_c</span>(<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_121"> 121</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_121"></span><span class="anchor" id="line-121-3"></span>    <span class="ID">big_machine</span>.<span class="ID">event_c</span>(<span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_122"> 122</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_122"></span><span class="anchor" id="line-122-3"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_c</span>(<span class="Number">3</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_123"> 123</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_123"></span><span class="anchor" id="line-123-3"></span>    <span class="ID">big_machine</span>.<span class="ID">event_b</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_124"> 124</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_124"></span><span class="anchor" id="line-124-3"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_b</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_125"> 125</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_125"></span><span class="anchor" id="line-125-3"></span>    <span class="ID">big_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_126"> 126</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_126"></span><span class="anchor" id="line-126-3"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_127"> 127</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_127"></span><span class="anchor" id="line-127-3"></span>    <span class="ID">big_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_128"> 128</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_128"></span><span class="anchor" id="line-128-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_129"> 129</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_129"></span><span class="anchor" id="line-129-2"></span>    <span class="ID">big_machine</span>.<span class="ID">toggle</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_130"> 130</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_130"></span><span class="anchor" id="line-130-2"></span>    <span class="ID">big_machine</span>.<span class="ID">toggle</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_131"> 131</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_131"></span><span class="anchor" id="line-131-2"></span>    <span class="ID">big_machine</span>.<span class="ID">toggle</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_132"> 132</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_132"></span><span class="anchor" id="line-132-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_133"> 133</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_133"></span><span class="anchor" id="line-133-1"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_134"> 134</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_134"></span><span class="anchor" id="line-134-1"></span>    <span class="ID">big_machine</span>.<span class="ID">event_b</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_135"> 135</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_135"></span><span class="anchor" id="line-135-1"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_b</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_136"> 136</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_136"></span><span class="anchor" id="line-136-1"></span>    <span class="ID">big_machine</span>.<span class="ID">event_c</span>(<span class="Number">3</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_137"> 137</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_137"></span><span class="anchor" id="line-137-1"></span>    <span class="ID">big_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_138"> 138</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_138"></span><span class="anchor" id="line-138-1"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_c</span>(<span class="Number">2</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_139"> 139</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_139"></span><span class="anchor" id="line-139-1"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_a</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_140"> 140</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_140"></span><span class="anchor" id="line-140-1"></span>    <span class="ID">big_machine</span>.<span class="ID">event_b</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_141"> 141</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_141"></span><span class="anchor" id="line-141-1"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_b</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_142"> 142</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_142"></span><span class="anchor" id="line-142-1"></span>    <span class="ID">big_machine</span>.<span class="ID">event_c</span>(<span class="Number">7</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_143"> 143</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_143"></span><span class="anchor" id="line-143-1"></span>    <span class="ID">lil_machine</span>.<span class="ID">event_c</span>(<span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_144"> 144</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_144"></span><span class="anchor" id="line-144-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_145"> 145</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_145"></span><span class="anchor" id="line-145-1"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Event A count </span><span class="String">&quot;</span>, <span class="ID">big_machine</span>.<span class="ID">a_count</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_146"> 146</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_146"></span><span class="anchor" id="line-146-1"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Event B count </span><span class="String">&quot;</span>, <span class="ID">big_machine</span>.<span class="ID">b_count</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_147"> 147</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_147"></span><span class="anchor" id="line-147-1"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Event C count </span><span class="String">&quot;</span>, <span class="ID">big_machine</span>.<span class="ID">c_count</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_148"> 148</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_148"></span><span class="anchor" id="line-148-1"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">LilMachine C count </span><span class="String">&quot;</span>, <span class="ID">lil_machine</span>.<span class="ID">c_count</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_149"> 149</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_149"></span><span class="anchor" id="line-149-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_150"> 150</a> </span><span class="LineAnchor" id="CA-04cf1d306f68f716cb11f18b08e42f84fddf7a03_150"></span><span class="anchor" id="line-150-1"></span><span class="ID">main</span>()</span>
</pre></div></div><span class="anchor" id="line-1407"></span><p class="line874">And now the imported statedefn.py <span class="anchor" id="line-1408"></span><span class="anchor" id="line-1409"></span><p class="line867"><span class="anchor" id="line-1410"></span><span class="anchor" id="line-1411"></span><span class="anchor" id="line-1412"></span><span class="anchor" id="line-1413"></span><span class="anchor" id="line-1414"></span><span class="anchor" id="line-1415"></span><span class="anchor" id="line-1416"></span><span class="anchor" id="line-1417"></span><span class="anchor" id="line-1418"></span><span class="anchor" id="line-1419"></span><span class="anchor" id="line-1420"></span><span class="anchor" id="line-1421"></span><span class="anchor" id="line-1422"></span><span class="anchor" id="line-1423"></span><span class="anchor" id="line-1424"></span><span class="anchor" id="line-1425"></span><span class="anchor" id="line-1426"></span><span class="anchor" id="line-1427"></span><span class="anchor" id="line-1428"></span><span class="anchor" id="line-1429"></span><span class="anchor" id="line-1430"></span><span class="anchor" id="line-1431"></span><span class="anchor" id="line-1432"></span><span class="anchor" id="line-1433"></span><span class="anchor" id="line-1434"></span><span class="anchor" id="line-1435"></span><span class="anchor" id="line-1436"></span><span class="anchor" id="line-1437"></span><span class="anchor" id="line-1438"></span><span class="anchor" id="line-1439"></span><span class="anchor" id="line-1440"></span><span class="anchor" id="line-1441"></span><span class="anchor" id="line-1442"></span><span class="anchor" id="line-1443"></span><span class="anchor" id="line-1444"></span><span class="anchor" id="line-1445"></span><span class="anchor" id="line-1446"></span><span class="anchor" id="line-1447"></span><span class="anchor" id="line-1448"></span><span class="anchor" id="line-1449"></span><span class="anchor" id="line-1450"></span><span class="anchor" id="line-1451"></span><span class="anchor" id="line-1452"></span><span class="anchor" id="line-1453"></span><span class="anchor" id="line-1454"></span><span class="anchor" id="line-1455"></span><span class="anchor" id="line-1456"></span><span class="anchor" id="line-1457"></span><span class="anchor" id="line-1458"></span><span class="anchor" id="line-1459"></span><span class="anchor" id="line-1460"></span><span class="anchor" id="line-1461"></span><span class="anchor" id="line-1462"></span><span class="anchor" id="line-1463"></span><span class="anchor" id="line-1464"></span><span class="anchor" id="line-1465"></span><span class="anchor" id="line-1466"></span><span class="anchor" id="line-1467"></span><span class="anchor" id="line-1468"></span><span class="anchor" id="line-1469"></span><span class="anchor" id="line-1470"></span><span class="anchor" id="line-1471"></span><span class="anchor" id="line-1472"></span><span class="anchor" id="line-1473"></span><span class="anchor" id="line-1474"></span><span class="anchor" id="line-1475"></span><span class="anchor" id="line-1476"></span><span class="anchor" id="line-1477"></span><span class="anchor" id="line-1478"></span><span class="anchor" id="line-1479"></span><span class="anchor" id="line-1480"></span><span class="anchor" id="line-1481"></span><span class="anchor" id="line-1482"></span><span class="anchor" id="line-1483"></span><span class="anchor" id="line-1484"></span><span class="anchor" id="line-1485"></span><span class="anchor" id="line-1486"></span><span class="anchor" id="line-1487"></span><span class="anchor" id="line-1488"></span><span class="anchor" id="line-1489"></span><span class="anchor" id="line-1490"></span><span class="anchor" id="line-1491"></span><span class="anchor" id="line-1492"></span><span class="anchor" id="line-1493"></span><span class="anchor" id="line-1494"></span><span class="anchor" id="line-1495"></span><span class="anchor" id="line-1496"></span><span class="anchor" id="line-1497"></span><span class="anchor" id="line-1498"></span><span class="anchor" id="line-1499"></span><span class="anchor" id="line-1500"></span><span class="anchor" id="line-1501"></span><span class="anchor" id="line-1502"></span><span class="anchor" id="line-1503"></span><span class="anchor" id="line-1504"></span><span class="anchor" id="line-1505"></span><span class="anchor" id="line-1506"></span><span class="anchor" id="line-1507"></span><span class="anchor" id="line-1508"></span><span class="anchor" id="line-1509"></span><span class="anchor" id="line-1510"></span><span class="anchor" id="line-1511"></span><span class="anchor" id="line-1512"></span><span class="anchor" id="line-1513"></span><span class="anchor" id="line-1514"></span><span class="anchor" id="line-1515"></span><span class="anchor" id="line-1516"></span><span class="anchor" id="line-1517"></span><span class="anchor" id="line-1518"></span><span class="anchor" id="line-1519"></span><span class="anchor" id="line-1520"></span><span class="anchor" id="line-1521"></span><span class="anchor" id="line-1522"></span><span class="anchor" id="line-1523"></span><span class="anchor" id="line-1524"></span><span class="anchor" id="line-1525"></span><span class="anchor" id="line-1526"></span><span class="anchor" id="line-1527"></span><span class="anchor" id="line-1528"></span><span class="anchor" id="line-1529"></span><span class="anchor" id="line-1530"></span><span class="anchor" id="line-1531"></span><span class="anchor" id="line-1532"></span><span class="anchor" id="line-1533"></span><span class="anchor" id="line-1534"></span><span class="anchor" id="line-1535"></span><span class="anchor" id="line-1536"></span><span class="anchor" id="line-1537"></span><span class="anchor" id="line-1538"></span><span class="anchor" id="line-1539"></span><span class="anchor" id="line-1540"></span><span class="anchor" id="line-1541"></span><span class="anchor" id="line-1542"></span><span class="anchor" id="line-1543"></span><span class="anchor" id="line-1544"></span><span class="anchor" id="line-1545"></span><span class="anchor" id="line-1546"></span><span class="anchor" id="line-1547"></span><span class="anchor" id="line-1548"></span><span class="anchor" id="line-1549"></span><span class="anchor" id="line-1550"></span><span class="anchor" id="line-1551"></span><span class="anchor" id="line-1552"></span><span class="anchor" id="line-1553"></span><span class="anchor" id="line-1554"></span><span class="anchor" id="line-1555"></span><span class="anchor" id="line-1556"></span><span class="anchor" id="line-1557"></span><span class="anchor" id="line-1558"></span><span class="anchor" id="line-1559"></span><span class="anchor" id="line-1560"></span><span class="anchor" id="line-1561"></span><span class="anchor" id="line-1562"></span><span class="anchor" id="line-1563"></span><span class="anchor" id="line-1564"></span><span class="anchor" id="line-1565"></span><span class="anchor" id="line-1566"></span><span class="anchor" id="line-1567"></span><span class="anchor" id="line-1568"></span><span class="anchor" id="line-1569"></span><span class="anchor" id="line-1570"></span><span class="anchor" id="line-1571"></span><span class="anchor" id="line-1572"></span><span class="anchor" id="line-1573"></span><span class="anchor" id="line-1574"></span><span class="anchor" id="line-1575"></span><span class="anchor" id="line-1576"></span><span class="anchor" id="line-1577"></span><span class="anchor" id="line-1578"></span><span class="anchor" id="line-1579"></span><span class="anchor" id="line-1580"></span><span class="anchor" id="line-1581"></span><span class="anchor" id="line-1582"></span><span class="anchor" id="line-1583"></span><span class="anchor" id="line-1584"></span><span class="anchor" id="line-1585"></span><span class="anchor" id="line-1586"></span><span class="anchor" id="line-1587"></span><span class="anchor" id="line-1588"></span><span class="anchor" id="line-1589"></span><span class="anchor" id="line-1590"></span><span class="anchor" id="line-1591"></span><span class="anchor" id="line-1592"></span><span class="anchor" id="line-1593"></span><span class="anchor" id="line-1594"></span><span class="anchor" id="line-1595"></span><span class="anchor" id="line-1596"></span><span class="anchor" id="line-1597"></span><span class="anchor" id="line-1598"></span><span class="anchor" id="line-1599"></span><span class="anchor" id="line-1-61"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_1">   1</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_1"></span><span class="anchor" id="line-1-62"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_2">   2</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_2"></span><span class="anchor" id="line-2-31"></span><span class="Comment"># Support for State Machines.  ref - Design Patterns by GoF</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_3">   3</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_3"></span><span class="anchor" id="line-3-31"></span><span class="Comment">#  Many of the methods in these classes get called behind the scenes.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_4">   4</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_4"></span><span class="anchor" id="line-4-30"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_5">   5</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_5"></span><span class="anchor" id="line-5-30"></span><span class="Comment">#  Notable exceptions are methods of the StateVar class.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_6">   6</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_6"></span><span class="anchor" id="line-6-30"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_7">   7</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_7"></span><span class="anchor" id="line-7-30"></span><span class="Comment">#  See example programs for how this module is intended to be used.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_8">   8</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_8"></span><span class="anchor" id="line-8-30"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_9">   9</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_9"></span><span class="anchor" id="line-9-30"></span><span class="ResWord">class</span> <span class="ID">StateMachineError</span>(<span class="ID">Exception</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_10">  10</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_10"></span><span class="anchor" id="line-10-30"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">args</span> = <span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_11">  11</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_11"></span><span class="anchor" id="line-11-28"></span>       <span class="ResWord">self</span>.<span class="ID">args</span> = <span class="ID">args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_12">  12</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_12"></span><span class="anchor" id="line-12-28"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_13">  13</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_13"></span><span class="anchor" id="line-13-28"></span><span class="ResWord">class</span> <span class="ID">StateVar</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_14">  14</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_14"></span><span class="anchor" id="line-14-28"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">initial_state</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_15">  15</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_15"></span><span class="anchor" id="line-15-28"></span>        <span class="ResWord">self</span>.<span class="ID">_current_state</span> = <span class="ID">initial_state</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_16">  16</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_16"></span><span class="anchor" id="line-16-28"></span>        <span class="ResWord">self</span>.<span class="ID">next_state</span> = <span class="ID">initial_state</span>            <span class="Comment"># publicly settable in an event handling routine.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_17">  17</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_17"></span><span class="anchor" id="line-17-27"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_18">  18</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_18"></span><span class="anchor" id="line-18-27"></span>    <span class="ResWord">def</span> <span class="ID">set_state</span>(<span class="ResWord">self</span>, <span class="ID">owner</span>, <span class="ID">new_state</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_19">  19</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_19"></span><span class="anchor" id="line-19-26"></span>        <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_20">  20</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_20"></span><span class="anchor" id="line-20-25"></span><span class="String">        Forces a state change to new_state</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_21">  21</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_21"></span><span class="anchor" id="line-21-25"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_22">  22</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_22"></span><span class="anchor" id="line-22-25"></span>        <span class="ResWord">self</span>.<span class="ID">next_state</span> = <span class="ID">new_state</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_23">  23</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_23"></span><span class="anchor" id="line-23-25"></span>        <span class="ResWord">self</span>.<span class="ID">__to_next_state</span>(<span class="ID">owner</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_24">  24</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_24"></span><span class="anchor" id="line-24-22"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_25">  25</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_25"></span><span class="anchor" id="line-25-22"></span>    <span class="ResWord">def</span> <span class="ID">__to_next_state</span>(<span class="ResWord">self</span>, <span class="ID">owner</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_26">  26</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_26"></span><span class="anchor" id="line-26-21"></span>        <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_27">  27</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_27"></span><span class="anchor" id="line-27-18"></span><span class="String">        The low-level state change function which calls leave state &amp; enter state functions as</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_28">  28</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_28"></span><span class="anchor" id="line-28-16"></span><span class="String">        needed.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_29">  29</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_29"></span><span class="anchor" id="line-29-16"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_30">  30</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_30"></span><span class="anchor" id="line-30-14"></span><span class="String">        LeaveState and EnterState functions are called as needed when state transitions.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_31">  31</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_31"></span><span class="anchor" id="line-31-13"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_32">  32</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_32"></span><span class="anchor" id="line-32-13"></span>        <span class="ResWord">if</span> <span class="ResWord">self</span>.<span class="ID">next_state</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">self</span>.<span class="ID">_current_state</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_33">  33</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_33"></span><span class="anchor" id="line-33-13"></span>            <span class="ResWord">if</span> <span class="ResWord">hasattr</span>(<span class="ResWord">self</span>.<span class="ID">_current_state</span>, <span class="String">&quot;</span><span class="String">leave</span><span class="String">&quot;</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_34">  34</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_34"></span><span class="anchor" id="line-34-12"></span>                <span class="ResWord">self</span>.<span class="ID">_current_state</span>.<span class="ID">leave</span>(<span class="ID">owner</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_35">  35</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_35"></span><span class="anchor" id="line-35-12"></span>            <span class="ResWord">elif</span> <span class="ResWord">hasattr</span>(<span class="ResWord">self</span>, <span class="String">&quot;</span><span class="String">leave</span><span class="String">&quot;</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_36">  36</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_36"></span><span class="anchor" id="line-36-12"></span>                <span class="ResWord">self</span>.<span class="ID">leave</span>(<span class="ID">owner</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_37">  37</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_37"></span><span class="anchor" id="line-37-12"></span>            <span class="ResWord">self</span>.<span class="ID">_current_state</span> =  <span class="ResWord">self</span>.<span class="ID">next_state</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_38">  38</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_38"></span><span class="anchor" id="line-38-11"></span>            <span class="ResWord">if</span> <span class="ResWord">hasattr</span>(<span class="ResWord">self</span>.<span class="ID">_current_state</span>, <span class="String">&quot;</span><span class="String">enter</span><span class="String">&quot;</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_39">  39</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_39"></span><span class="anchor" id="line-39-11"></span>                <span class="ResWord">self</span>.<span class="ID">_current_state</span>.<span class="ID">enter</span>(<span class="ID">owner</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_40">  40</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_40"></span><span class="anchor" id="line-40-11"></span>            <span class="ResWord">elif</span> <span class="ResWord">hasattr</span>(<span class="ResWord">self</span>, <span class="String">&quot;</span><span class="String">enter</span><span class="String">&quot;</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_41">  41</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_41"></span><span class="anchor" id="line-41-10"></span>                <span class="ResWord">self</span>.<span class="ID">enter</span>(<span class="ID">owner</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_42">  42</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_42"></span><span class="anchor" id="line-42-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_43">  43</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_43"></span><span class="anchor" id="line-43-8"></span>    <span class="ResWord">def</span> <span class="ID">__fctn</span>(<span class="ResWord">self</span>, <span class="ID">func_name</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_44">  44</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_44"></span><span class="anchor" id="line-44-8"></span>        <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_45">  45</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_45"></span><span class="anchor" id="line-45-8"></span><span class="String">        Returns the owning class's method for handling an event for the current state.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_46">  46</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_46"></span><span class="anchor" id="line-46-8"></span><span class="String">        This method not for public consumption.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_47">  47</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_47"></span><span class="anchor" id="line-47-8"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_48">  48</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_48"></span><span class="anchor" id="line-48-7"></span>        <span class="ID">vf</span> = <span class="ResWord">self</span>.<span class="ID">_current_state</span>.<span class="ID">get_fe</span>(<span class="ID">func_name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_49">  49</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_49"></span><span class="anchor" id="line-49-7"></span>        <span class="ResWord">return</span> <span class="ID">vf</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_50">  50</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_50"></span><span class="anchor" id="line-50-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_51">  51</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_51"></span><span class="anchor" id="line-51-6"></span>    <span class="ResWord">def</span> <span class="ID">name</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_52">  52</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_52"></span><span class="anchor" id="line-52-6"></span>        <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_53">  53</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_53"></span><span class="anchor" id="line-53-6"></span><span class="String">        Returns the current state name.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_54">  54</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_54"></span><span class="anchor" id="line-54-6"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_55">  55</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_55"></span><span class="anchor" id="line-55-6"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">_current_state</span>.<span class="ID">name</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_56">  56</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_56"></span><span class="anchor" id="line-56-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_57">  57</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_57"></span><span class="anchor" id="line-57-6"></span><span class="ResWord">class</span> <span class="ID">STState</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_58">  58</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_58"></span><span class="anchor" id="line-58-6"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">state_name</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_59">  59</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_59"></span><span class="anchor" id="line-59-6"></span>        <span class="ResWord">self</span>.<span class="ID">name</span> = <span class="ID">state_name</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_60">  60</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_60"></span><span class="anchor" id="line-60-6"></span>        <span class="ResWord">self</span>.<span class="ID">fctn_dict</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_61">  61</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_61"></span><span class="anchor" id="line-61-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_62">  62</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_62"></span><span class="anchor" id="line-62-5"></span>    <span class="ResWord">def</span> <span class="ID">set_events</span>(<span class="ResWord">self</span>, <span class="ID">event_list</span>, <span class="ID">event_hdlr_list</span>, <span class="ID">next_states</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_63">  63</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_63"></span><span class="anchor" id="line-63-5"></span>        <span class="ID">dictionary</span> = <span class="ResWord">self</span>.<span class="ID">fctn_dict</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_64">  64</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_64"></span><span class="anchor" id="line-64-5"></span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ID">next_states</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_65">  65</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_65"></span><span class="anchor" id="line-65-5"></span>            <span class="ResWord">def</span> <span class="ID">set_row</span>(<span class="ID">event</span>, <span class="ID">method</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_66">  66</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_66"></span><span class="anchor" id="line-66-5"></span>                <span class="ID">dictionary</span>[<span class="ID">event</span>] = [<span class="ID">method</span>, <span class="ResWord">None</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_67">  67</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_67"></span><span class="anchor" id="line-67-5"></span>            <span class="ResWord">map</span>(<span class="ID">set_row</span>, <span class="ID">event_list</span>, <span class="ID">event_hdlr_list</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_68">  68</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_68"></span><span class="anchor" id="line-68-5"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_69">  69</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_69"></span><span class="anchor" id="line-69-5"></span>            <span class="ResWord">def</span> <span class="ID">set_row2</span>(<span class="ID">event</span>, <span class="ID">method</span>, <span class="ID">next_state</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_70">  70</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_70"></span><span class="anchor" id="line-70-5"></span>                <span class="ID">dictionary</span>[<span class="ID">event</span>] = [<span class="ID">method</span>, <span class="ID">next_state</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_71">  71</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_71"></span><span class="anchor" id="line-71-5"></span>            <span class="ResWord">map</span>(<span class="ID">set_row2</span>, <span class="ID">event_list</span>, <span class="ID">event_hdlr_list</span>, <span class="ID">next_states</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_72">  72</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_72"></span><span class="anchor" id="line-72-5"></span>        <span class="ResWord">self</span>.<span class="ID">fctn_dict</span> = <span class="ID">dictionary</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_73">  73</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_73"></span><span class="anchor" id="line-73-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_74">  74</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_74"></span><span class="anchor" id="line-74-5"></span>    <span class="ResWord">def</span> <span class="ID">get_fe</span>(<span class="ResWord">self</span>, <span class="ID">fctn_name</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_75">  75</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_75"></span><span class="anchor" id="line-75-5"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">fctn_dict</span>[<span class="ID">fctn_name</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_76">  76</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_76"></span><span class="anchor" id="line-76-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_77">  77</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_77"></span><span class="anchor" id="line-77-5"></span>    <span class="ResWord">def</span> <span class="ID">map_next_states</span>(<span class="ResWord">self</span>, <span class="ID">state_dict</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_78">  78</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_78"></span><span class="anchor" id="line-78-5"></span>        <span class="String">''' Changes second dict value from name of state to actual state.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_79">  79</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_79"></span><span class="anchor" id="line-79-5"></span>        <span class="ResWord">for</span> <span class="ID">de</span> <span class="ResWord">in</span> <span class="ResWord">self</span>.<span class="ID">fctn_dict</span>.<span class="ID">values</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_80">  80</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_80"></span><span class="anchor" id="line-80-5"></span>            <span class="ID">next_state_name</span> = <span class="ID">de</span>[<span class="Number">1</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_81">  81</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_81"></span><span class="anchor" id="line-81-5"></span>            <span class="ResWord">if</span> <span class="ID">next_state_name</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_82">  82</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_82"></span><span class="anchor" id="line-82-5"></span>                <span class="ResWord">if</span> <span class="ID">next_state_name</span> <span class="ResWord">in</span> <span class="ID">state_dict</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_83">  83</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_83"></span><span class="anchor" id="line-83-5"></span>                    <span class="ID">de</span>[<span class="Number">1</span>] = <span class="ID">state_dict</span>[<span class="ID">next_state_name</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_84">  84</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_84"></span><span class="anchor" id="line-84-5"></span>                <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_85">  85</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_85"></span><span class="anchor" id="line-85-5"></span>                    <span class="ResWord">raise</span> <span class="ID">StateMachineError</span>(<span class="String">'</span><span class="String">Invalid Name for next state: {}</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ID">next_state_name</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_86">  86</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_86"></span><span class="anchor" id="line-86-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_87">  87</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_87"></span><span class="anchor" id="line-87-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_88">  88</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_88"></span><span class="anchor" id="line-88-5"></span><span class="ResWord">class</span> <span class="ID">StateTable</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_89">  89</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_89"></span><span class="anchor" id="line-89-5"></span>    <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_90">  90</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_90"></span><span class="anchor" id="line-90-5"></span><span class="String">    Magical class to define a state machine, with the help of several decorator functions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_91">  91</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_91"></span><span class="anchor" id="line-91-5"></span><span class="String">    which follow.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_92">  92</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_92"></span><span class="anchor" id="line-92-5"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_93">  93</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_93"></span><span class="anchor" id="line-93-5"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">declname</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_94">  94</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_94"></span><span class="anchor" id="line-94-5"></span>        <span class="ResWord">self</span>.<span class="ID">machine_var</span> = <span class="ID">declname</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_95">  95</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_95"></span><span class="anchor" id="line-95-5"></span>        <span class="ResWord">self</span>.<span class="ID">_initial_state</span> = <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_96">  96</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_96"></span><span class="anchor" id="line-96-5"></span>        <span class="ResWord">self</span>.<span class="ID">_state_list</span> = {}</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_97">  97</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_97"></span><span class="anchor" id="line-97-5"></span>        <span class="ResWord">self</span>.<span class="ID">_event_list</span> = []</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_98">  98</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_98"></span><span class="anchor" id="line-98-5"></span>        <span class="ResWord">self</span>.<span class="ID">need_initialize</span> = <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_99">  99</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_99"></span><span class="anchor" id="line-99-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_100"> 100</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_100"></span><span class="anchor" id="line-100-5"></span>    <span class="ResWord">def</span> <span class="ID">initialize</span>(<span class="ResWord">self</span>, <span class="ID">parent</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_101"> 101</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_101"></span><span class="anchor" id="line-101-5"></span>        <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_102"> 102</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_102"></span><span class="anchor" id="line-102-5"></span><span class="String">        Initializes the parent class's state variable for this StateTable class.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_103"> 103</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_103"></span><span class="anchor" id="line-103-5"></span><span class="String">        Must call this method in the parent' object's __init__ method.  You can have</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_104"> 104</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_104"></span><span class="anchor" id="line-104-5"></span><span class="String">        Multiple state machines within a parent class. Call this method for each</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_105"> 105</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_105"></span><span class="anchor" id="line-105-5"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_106"> 106</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_106"></span><span class="anchor" id="line-106-5"></span>        <span class="ID">statevar</span>= <span class="ID">StateVar</span>(<span class="ResWord">self</span>.<span class="ID">_initial_state</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_107"> 107</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_107"></span><span class="anchor" id="line-107-5"></span>        <span class="ResWord">setattr</span>(<span class="ID">parent</span>, <span class="ResWord">self</span>.<span class="ID">machine_var</span>, <span class="ID">statevar</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_108"> 108</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_108"></span><span class="anchor" id="line-108-5"></span>        <span class="ResWord">if</span> <span class="ResWord">hasattr</span>(<span class="ResWord">self</span>, <span class="String">&quot;</span><span class="String">enter</span><span class="String">&quot;</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_109"> 109</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_109"></span><span class="anchor" id="line-109-5"></span>            <span class="ID">statevar</span>.<span class="ID">enter</span> = <span class="ResWord">self</span>.<span class="ID">enter</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_110"> 110</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_110"></span><span class="anchor" id="line-110-5"></span>        <span class="ResWord">if</span> <span class="ResWord">hasattr</span>(<span class="ResWord">self</span>, <span class="String">&quot;</span><span class="String">leave</span><span class="String">&quot;</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_111"> 111</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_111"></span><span class="anchor" id="line-111-5"></span>            <span class="ID">statevar</span>.<span class="ID">leave</span> = <span class="ResWord">self</span>.<span class="ID">leave</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_112"> 112</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_112"></span><span class="anchor" id="line-112-5"></span>        <span class="Comment">#Magic happens here - in the 'next state' table, translate names into state objects.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_113"> 113</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_113"></span><span class="anchor" id="line-113-5"></span>        <span class="ResWord">if</span>  <span class="ResWord">self</span>.<span class="ID">need_initialize</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_114"> 114</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_114"></span><span class="anchor" id="line-114-5"></span>            <span class="ResWord">for</span> <span class="ID">xstate</span> <span class="ResWord">in</span> <span class="ResWord">list</span>(<span class="ResWord">self</span>.<span class="ID">_state_list</span>.<span class="ID">values</span>()):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_115"> 115</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_115"></span><span class="anchor" id="line-115-5"></span>                <span class="ID">xstate</span>.<span class="ID">map_next_states</span>(<span class="ResWord">self</span>.<span class="ID">_state_list</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_116"> 116</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_116"></span><span class="anchor" id="line-116-5"></span>            <span class="ResWord">self</span>.<span class="ID">need_initialize</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_117"> 117</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_117"></span><span class="anchor" id="line-117-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_118"> 118</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_118"></span><span class="anchor" id="line-118-4"></span>    <span class="ResWord">def</span> <span class="ID">def_state</span>(<span class="ResWord">self</span>, <span class="ID">event_hdlr_list</span>, <span class="ID">name</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_119"> 119</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_119"></span><span class="anchor" id="line-119-4"></span>        <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_120"> 120</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_120"></span><span class="anchor" id="line-120-4"></span><span class="String">        This is used to define a state. the event handler list is a list of functions that</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_121"> 121</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_121"></span><span class="anchor" id="line-121-4"></span><span class="String">        are called for corresponding events. name is the name of the state.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_122"> 122</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_122"></span><span class="anchor" id="line-122-4"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_123"> 123</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_123"></span><span class="anchor" id="line-123-4"></span>        <span class="ID">state_table_row</span> = <span class="ID">STState</span>(<span class="ID">name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_124"> 124</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_124"></span><span class="anchor" id="line-124-4"></span>        <span class="ResWord">if</span> <span class="ResWord">len</span>(<span class="ID">event_hdlr_list</span>) != <span class="ResWord">len</span>(<span class="ResWord">self</span>.<span class="ID">_event_list</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_125"> 125</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_125"></span><span class="anchor" id="line-125-4"></span>            <span class="ResWord">raise</span> <span class="ID">StateMachineError</span>(<span class="String">'</span><span class="String">Mismatch between number of event handlers and the methods specified for the state.</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_126"> 126</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_126"></span><span class="anchor" id="line-126-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_127"> 127</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_127"></span><span class="anchor" id="line-127-4"></span>        <span class="ID">state_table_row</span>.<span class="ID">set_events</span>(<span class="ResWord">self</span>.<span class="ID">_event_list</span>, <span class="ID">event_hdlr_list</span>, <span class="ResWord">None</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_128"> 128</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_128"></span><span class="anchor" id="line-128-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_129"> 129</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_129"></span><span class="anchor" id="line-129-3"></span>        <span class="ResWord">if</span> <span class="ResWord">self</span>.<span class="ID">_initial_state</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_130"> 130</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_130"></span><span class="anchor" id="line-130-3"></span>            <span class="ResWord">self</span>.<span class="ID">_initial_state</span> = <span class="ID">state_table_row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_131"> 131</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_131"></span><span class="anchor" id="line-131-3"></span>        <span class="ResWord">self</span>.<span class="ID">_state_list</span>[<span class="ID">name</span>] = <span class="ID">state_table_row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_132"> 132</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_132"></span><span class="anchor" id="line-132-2"></span>        <span class="ResWord">return</span> <span class="ID">state_table_row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_133"> 133</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_133"></span><span class="anchor" id="line-133-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_134"> 134</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_134"></span><span class="anchor" id="line-134-2"></span>    <span class="ResWord">def</span> <span class="ID">state</span>(<span class="ResWord">self</span>, <span class="ID">name</span>, <span class="ID">event_hdlr_list</span>, <span class="ID">next_states</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_135"> 135</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_135"></span><span class="anchor" id="line-135-2"></span>        <span class="ID">state_table_row</span> = <span class="ID">STState</span>(<span class="ID">name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_136"> 136</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_136"></span><span class="anchor" id="line-136-2"></span>        <span class="ResWord">if</span> <span class="ResWord">len</span>(<span class="ID">event_hdlr_list</span>) != <span class="ResWord">len</span>(<span class="ResWord">self</span>.<span class="ID">_event_list</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_137"> 137</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_137"></span><span class="anchor" id="line-137-2"></span>            <span class="ResWord">raise</span> <span class="ID">StateMachineError</span>(<span class="String">'</span><span class="String">Mismatch between number of event handlers and the methods specified for the state.</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_138"> 138</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_138"></span><span class="anchor" id="line-138-2"></span>        <span class="ResWord">if</span> <span class="ID">next_states</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span> <span class="ResWord">and</span> <span class="ResWord">len</span>(<span class="ID">next_states</span>) != <span class="ResWord">len</span>(<span class="ResWord">self</span>.<span class="ID">_event_list</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_139"> 139</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_139"></span><span class="anchor" id="line-139-2"></span>            <span class="ResWord">raise</span> <span class="ID">StateMachineError</span>(<span class="String">'</span><span class="String">Mismatch between number of event handlers and the next states specified for the state.</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_140"> 140</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_140"></span><span class="anchor" id="line-140-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_141"> 141</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_141"></span><span class="anchor" id="line-141-2"></span>        <span class="ID">state_table_row</span>.<span class="ID">set_events</span>(<span class="ResWord">self</span>.<span class="ID">_event_list</span>, <span class="ID">event_hdlr_list</span>, <span class="ID">next_states</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_142"> 142</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_142"></span><span class="anchor" id="line-142-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_143"> 143</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_143"></span><span class="anchor" id="line-143-2"></span>        <span class="ResWord">if</span> <span class="ResWord">self</span>.<span class="ID">_initial_state</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_144"> 144</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_144"></span><span class="anchor" id="line-144-2"></span>            <span class="ResWord">self</span>.<span class="ID">_initial_state</span> = <span class="ID">state_table_row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_145"> 145</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_145"></span><span class="anchor" id="line-145-2"></span>        <span class="ResWord">self</span>.<span class="ID">_state_list</span>[<span class="ID">name</span>] = <span class="ID">state_table_row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_146"> 146</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_146"></span><span class="anchor" id="line-146-2"></span>        <span class="ResWord">return</span> <span class="ID">state_table_row</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_147"> 147</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_147"></span><span class="anchor" id="line-147-2"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_148"> 148</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_148"></span><span class="anchor" id="line-148-2"></span>    <span class="ResWord">def</span> <span class="ID">__add_ev_hdlr</span>(<span class="ResWord">self</span>, <span class="ID">func_name</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_149"> 149</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_149"></span><span class="anchor" id="line-149-2"></span>        <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_150"> 150</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_150"></span><span class="anchor" id="line-150-2"></span><span class="String">        Informs the class of an event handler to be added. We just need the name here. The</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_151"> 151</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_151"></span><span class="anchor" id="line-151-1"></span><span class="String">        function name will later be associated with one of the functions in a list when a state is defined.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_152"> 152</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_152"></span><span class="anchor" id="line-152-1"></span><span class="String">        '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_153"> 153</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_153"></span><span class="anchor" id="line-153-1"></span>        <span class="ResWord">self</span>.<span class="ID">_event_list</span>.<span class="ID">append</span>(<span class="ID">func_name</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_154"> 154</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_154"></span><span class="anchor" id="line-154-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_155"> 155</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_155"></span><span class="anchor" id="line-155-1"></span><span class="Comment"># Decorator functions ...</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_156"> 156</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_156"></span><span class="anchor" id="line-156-1"></span><span class="ResWord">def</span> <span class="ID">event_handler</span>(<span class="ID">state_class</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_157"> 157</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_157"></span><span class="anchor" id="line-157-1"></span>    <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_158"> 158</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_158"></span><span class="anchor" id="line-158-1"></span><span class="String">    Declare a method that handles a type of event.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_159"> 159</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_159"></span><span class="anchor" id="line-159-1"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_160"> 160</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_160"></span><span class="anchor" id="line-160-1"></span>    <span class="ResWord">def</span> <span class="ID">wrapper</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_161"> 161</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_161"></span><span class="anchor" id="line-161-1"></span>        <span class="ID">state_class</span>.<span class="ID">_StateTable__add_ev_hdlr</span>(<span class="ID">func</span>.<span class="ID">__name__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_162"> 162</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_162"></span><span class="anchor" id="line-162-1"></span>        <span class="ResWord">def</span> <span class="ID">obj_call</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>, **<span class="ID">keywords</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_163"> 163</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_163"></span><span class="anchor" id="line-163-1"></span>            <span class="ID">state_var</span> = <span class="ResWord">getattr</span>(<span class="ResWord">self</span>, <span class="ID">state_class</span>.<span class="ID">machine_var</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_164"> 164</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_164"></span><span class="anchor" id="line-164-1"></span>            <span class="ID">funky</span>, <span class="ID">next_state</span> = <span class="ID">state_var</span>.<span class="ID">_StateVar__fctn</span>(<span class="ID">func</span>.<span class="ID">__name__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_165"> 165</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_165"></span><span class="anchor" id="line-165-1"></span>            <span class="ResWord">if</span> <span class="ID">next_state</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_166"> 166</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_166"></span><span class="anchor" id="line-166-1"></span>                <span class="ID">state_var</span>.<span class="ID">next_state</span> = <span class="ID">next_state</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_167"> 167</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_167"></span><span class="anchor" id="line-167-1"></span>            <span class="ID">rv</span> = <span class="ID">funky</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>, **<span class="ID">keywords</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_168"> 168</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_168"></span><span class="anchor" id="line-168-1"></span>            <span class="ID">state_var</span>.<span class="ID">_StateVar__to_next_state</span>(<span class="ResWord">self</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_169"> 169</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_169"></span><span class="anchor" id="line-169-1"></span>            <span class="ResWord">return</span> <span class="ID">rv</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_170"> 170</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_170"></span><span class="anchor" id="line-170-1"></span>        <span class="ResWord">return</span> <span class="ID">obj_call</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_171"> 171</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_171"></span><span class="anchor" id="line-171-1"></span>    <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_172"> 172</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_172"></span><span class="anchor" id="line-172-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_173"> 173</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_173"></span><span class="anchor" id="line-173-1"></span><span class="ResWord">def</span> <span class="ID">on_enter_function</span>(<span class="ID">state_class</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_174"> 174</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_174"></span><span class="anchor" id="line-174-1"></span>    <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_175"> 175</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_175"></span><span class="anchor" id="line-175-1"></span><span class="String">    Declare that this method should be called whenever a new state is entered.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_176"> 176</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_176"></span><span class="anchor" id="line-176-1"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_177"> 177</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_177"></span><span class="anchor" id="line-177-1"></span>    <span class="ResWord">def</span> <span class="ID">wrapper</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_178"> 178</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_178"></span><span class="anchor" id="line-178-1"></span>        <span class="ID">state_class</span>.<span class="ID">enter</span> = <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_179"> 179</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_179"></span><span class="anchor" id="line-179-1"></span>        <span class="ResWord">return</span> <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_180"> 180</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_180"></span><span class="anchor" id="line-180-1"></span>    <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_181"> 181</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_181"></span><span class="anchor" id="line-181-1"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_182"> 182</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_182"></span><span class="anchor" id="line-182-1"></span><span class="ResWord">def</span> <span class="ID">on_leave_function</span>(<span class="ID">state_class</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_183"> 183</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_183"></span><span class="anchor" id="line-183-1"></span>    <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_184"> 184</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_184"></span><span class="anchor" id="line-184-1"></span><span class="String">    Declares that this method should be called whenever leaving a state.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_185"> 185</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_185"></span><span class="anchor" id="line-185-1"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_186"> 186</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_186"></span><span class="anchor" id="line-186-1"></span>    <span class="ResWord">def</span> <span class="ID">wrapper</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_187"> 187</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_187"></span><span class="anchor" id="line-187-1"></span>        <span class="ID">state_class</span>.<span class="ID">leave</span> = <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_188"> 188</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_188"></span><span class="anchor" id="line-188-1"></span>        <span class="ResWord">return</span> <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_189"> 189</a> </span><span class="LineAnchor" id="CA-3d383c2d611c97b8390ca0b5edde6b96cad1debd_189"></span><span class="anchor" id="line-189-1"></span>    <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
</pre></div></div><span class="anchor" id="line-1600"></span><p class="line867">
<h2 id="C.2B-.2B-.2FJava-keyword-like_function_decorators">C++/Java-keyword-like function decorators</h2>
<span class="anchor" id="line-1601"></span><p class="line874">@abstractMethod, @deprecatedMethod, @privateMethod, @protectedMethod, @raises, @parameterTypes, @returnType <span class="anchor" id="line-1602"></span><span class="anchor" id="line-1603"></span><p class="line874">The annotations provide run-time type checking and an alternative way to document code. <span class="anchor" id="line-1604"></span><span class="anchor" id="line-1605"></span><p class="line862">The code and documentation are long, so I offer a link: <a class="http" href="http://fightingquaker.com/pyanno/">http://fightingquaker.com/pyanno/</a> <span class="anchor" id="line-1606"></span><span class="anchor" id="line-1607"></span><p class="line867">
<h2 id="Different_Decorator_Forms">Different Decorator Forms</h2>
<span class="anchor" id="line-1608"></span><p class="line874">There are operational differences between: <span class="anchor" id="line-1609"></span><span class="anchor" id="line-1610"></span><ul><li>Decorator with no arguments <span class="anchor" id="line-1611"></span></li><li>Decorator with arguments <span class="anchor" id="line-1612"></span></li><li>Decorator with wrapped class instance awareness <span class="anchor" id="line-1613"></span><span class="anchor" id="line-1614"></span></li></ul><p class="line874">This example demonstrates the operational differences between the three using a skit taken from Episode 22: Bruces. <span class="anchor" id="line-1615"></span><span class="anchor" id="line-1616"></span><p class="line867"><span class="anchor" id="line-1617"></span><span class="anchor" id="line-1618"></span><span class="anchor" id="line-1619"></span><span class="anchor" id="line-1620"></span><span class="anchor" id="line-1621"></span><span class="anchor" id="line-1622"></span><span class="anchor" id="line-1623"></span><span class="anchor" id="line-1624"></span><span class="anchor" id="line-1625"></span><span class="anchor" id="line-1626"></span><span class="anchor" id="line-1627"></span><span class="anchor" id="line-1628"></span><span class="anchor" id="line-1629"></span><span class="anchor" id="line-1630"></span><span class="anchor" id="line-1631"></span><span class="anchor" id="line-1632"></span><span class="anchor" id="line-1633"></span><span class="anchor" id="line-1634"></span><span class="anchor" id="line-1635"></span><span class="anchor" id="line-1636"></span><span class="anchor" id="line-1637"></span><span class="anchor" id="line-1638"></span><span class="anchor" id="line-1639"></span><span class="anchor" id="line-1640"></span><span class="anchor" id="line-1641"></span><span class="anchor" id="line-1642"></span><span class="anchor" id="line-1643"></span><span class="anchor" id="line-1644"></span><span class="anchor" id="line-1645"></span><span class="anchor" id="line-1646"></span><span class="anchor" id="line-1647"></span><span class="anchor" id="line-1648"></span><span class="anchor" id="line-1649"></span><span class="anchor" id="line-1650"></span><span class="anchor" id="line-1651"></span><span class="anchor" id="line-1652"></span><span class="anchor" id="line-1653"></span><span class="anchor" id="line-1654"></span><span class="anchor" id="line-1655"></span><span class="anchor" id="line-1656"></span><span class="anchor" id="line-1657"></span><span class="anchor" id="line-1658"></span><span class="anchor" id="line-1659"></span><span class="anchor" id="line-1660"></span><span class="anchor" id="line-1661"></span><span class="anchor" id="line-1662"></span><span class="anchor" id="line-1663"></span><span class="anchor" id="line-1664"></span><span class="anchor" id="line-1665"></span><span class="anchor" id="line-1666"></span><span class="anchor" id="line-1667"></span><span class="anchor" id="line-1668"></span><span class="anchor" id="line-1669"></span><span class="anchor" id="line-1670"></span><span class="anchor" id="line-1671"></span><span class="anchor" id="line-1672"></span><span class="anchor" id="line-1673"></span><span class="anchor" id="line-1674"></span><span class="anchor" id="line-1675"></span><span class="anchor" id="line-1676"></span><span class="anchor" id="line-1677"></span><span class="anchor" id="line-1678"></span><span class="anchor" id="line-1679"></span><span class="anchor" id="line-1680"></span><span class="anchor" id="line-1681"></span><span class="anchor" id="line-1682"></span><span class="anchor" id="line-1683"></span><span class="anchor" id="line-1684"></span><span class="anchor" id="line-1685"></span><span class="anchor" id="line-1686"></span><span class="anchor" id="line-1687"></span><span class="anchor" id="line-1688"></span><span class="anchor" id="line-1689"></span><span class="anchor" id="line-1690"></span><span class="anchor" id="line-1691"></span><span class="anchor" id="line-1692"></span><span class="anchor" id="line-1693"></span><span class="anchor" id="line-1694"></span><span class="anchor" id="line-1695"></span><span class="anchor" id="line-1696"></span><span class="anchor" id="line-1697"></span><span class="anchor" id="line-1698"></span><span class="anchor" id="line-1699"></span><span class="anchor" id="line-1700"></span><span class="anchor" id="line-1701"></span><span class="anchor" id="line-1702"></span><span class="anchor" id="line-1703"></span><span class="anchor" id="line-1704"></span><span class="anchor" id="line-1705"></span><span class="anchor" id="line-1706"></span><span class="anchor" id="line-1707"></span><span class="anchor" id="line-1708"></span><span class="anchor" id="line-1709"></span><span class="anchor" id="line-1710"></span><span class="anchor" id="line-1711"></span><span class="anchor" id="line-1712"></span><span class="anchor" id="line-1713"></span><span class="anchor" id="line-1714"></span><span class="anchor" id="line-1715"></span><span class="anchor" id="line-1716"></span><span class="anchor" id="line-1717"></span><span class="anchor" id="line-1718"></span><span class="anchor" id="line-1719"></span><span class="anchor" id="line-1720"></span><span class="anchor" id="line-1721"></span><span class="anchor" id="line-1722"></span><span class="anchor" id="line-1723"></span><span class="anchor" id="line-1724"></span><span class="anchor" id="line-1725"></span><span class="anchor" id="line-1726"></span><span class="anchor" id="line-1727"></span><span class="anchor" id="line-1728"></span><span class="anchor" id="line-1729"></span><span class="anchor" id="line-1730"></span><span class="anchor" id="line-1731"></span><span class="anchor" id="line-1732"></span><span class="anchor" id="line-1733"></span><span class="anchor" id="line-1734"></span><span class="anchor" id="line-1735"></span><span class="anchor" id="line-1736"></span><span class="anchor" id="line-1737"></span><span class="anchor" id="line-1738"></span><span class="anchor" id="line-1739"></span><span class="anchor" id="line-1740"></span><span class="anchor" id="line-1741"></span><span class="anchor" id="line-1742"></span><span class="anchor" id="line-1743"></span><span class="anchor" id="line-1744"></span><span class="anchor" id="line-1745"></span><span class="anchor" id="line-1746"></span><span class="anchor" id="line-1747"></span><span class="anchor" id="line-1748"></span><span class="anchor" id="line-1749"></span><span class="anchor" id="line-1750"></span><span class="anchor" id="line-1751"></span><span class="anchor" id="line-1752"></span><span class="anchor" id="line-1753"></span><span class="anchor" id="line-1754"></span><span class="anchor" id="line-1755"></span><span class="anchor" id="line-1756"></span><span class="anchor" id="line-1757"></span><span class="anchor" id="line-1758"></span><span class="anchor" id="line-1759"></span><span class="anchor" id="line-1760"></span><span class="anchor" id="line-1761"></span><span class="anchor" id="line-1762"></span><span class="anchor" id="line-1763"></span><span class="anchor" id="line-1764"></span><span class="anchor" id="line-1765"></span><span class="anchor" id="line-1766"></span><span class="anchor" id="line-1767"></span><span class="anchor" id="line-1768"></span><span class="anchor" id="line-1769"></span><span class="anchor" id="line-1770"></span><span class="anchor" id="line-1-63"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_1">   1</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_1"></span><span class="anchor" id="line-1-64"></span><span class="ResWord">from</span> <span class="ID">sys</span> <span class="ResWord">import</span> <span class="ID">stdout</span>,<span class="ID">stderr</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_2">   2</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_2"></span><span class="anchor" id="line-2-32"></span><span class="ResWord">from</span> <span class="ID">pdb</span> <span class="ResWord">import</span> <span class="ID">set_trace</span> <span class="ResWord">as</span> <span class="ID">bp</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_3">   3</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_3"></span><span class="anchor" id="line-3-32"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_4">   4</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_4"></span><span class="anchor" id="line-4-31"></span><span class="ResWord">class</span> <span class="ID">DecoTrace</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_5">   5</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_5"></span><span class="anchor" id="line-5-31"></span>    <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_6">   6</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_6"></span><span class="anchor" id="line-6-31"></span><span class="String">    Decorator class with no arguments</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_7">   7</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_7"></span><span class="anchor" id="line-7-31"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_8">   8</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_8"></span><span class="anchor" id="line-8-31"></span><span class="String">    This can only be used for functions or methods where the instance</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_9">   9</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_9"></span><span class="anchor" id="line-9-31"></span><span class="String">    is not necessary</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_10">  10</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_10"></span><span class="anchor" id="line-10-31"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_11">  11</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_11"></span><span class="anchor" id="line-11-29"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_12">  12</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_12"></span><span class="anchor" id="line-12-29"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_13">  13</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_13"></span><span class="anchor" id="line-13-29"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_14">  14</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_14"></span><span class="anchor" id="line-14-29"></span>        <span class="ResWord">self</span>.<span class="ID">f</span> = <span class="ID">f</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_15">  15</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_15"></span><span class="anchor" id="line-15-29"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_16">  16</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_16"></span><span class="anchor" id="line-16-29"></span>    <span class="ResWord">def</span> <span class="ID">_showargs</span>(<span class="ResWord">self</span>, *<span class="ID">fargs</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_17">  17</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_17"></span><span class="anchor" id="line-17-28"></span>        <span class="ResWord">print</span> &gt;&gt; <span class="ID">stderr</span>, <span class="String">'</span><span class="String">T: enter {} with args={}, kw={}</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ResWord">self</span>.<span class="ID">f</span>.<span class="ID">__name__</span>, <span class="ResWord">str</span>(<span class="ID">fargs</span>), <span class="ResWord">str</span>(<span class="ID">kw</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_18">  18</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_18"></span><span class="anchor" id="line-18-28"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_19">  19</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_19"></span><span class="anchor" id="line-19-27"></span>    <span class="ResWord">def</span> <span class="ID">_aftercall</span>(<span class="ResWord">self</span>, <span class="ID">status</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_20">  20</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_20"></span><span class="anchor" id="line-20-26"></span>        <span class="ResWord">print</span> &gt;&gt; <span class="ID">stderr</span>, <span class="String">'</span><span class="String">T: exit {} with status={}</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ResWord">self</span>.<span class="ID">f</span>.<span class="ID">__name__</span>, <span class="ResWord">str</span>(<span class="ID">status</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_21">  21</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_21"></span><span class="anchor" id="line-21-26"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_22">  22</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_22"></span><span class="anchor" id="line-22-26"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">fargs</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_23">  23</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_23"></span><span class="anchor" id="line-23-26"></span>        <span class="String">'''Pass *just* function arguments to wrapped function.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_24">  24</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_24"></span><span class="anchor" id="line-24-23"></span>        <span class="ResWord">self</span>.<span class="ID">_showargs</span>(*<span class="ID">fargs</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_25">  25</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_25"></span><span class="anchor" id="line-25-23"></span>        <span class="ID">ret</span>=<span class="ResWord">self</span>.<span class="ID">f</span>(*<span class="ID">fargs</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_26">  26</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_26"></span><span class="anchor" id="line-26-22"></span>        <span class="ResWord">self</span>.<span class="ID">_aftercall</span>(<span class="ID">ret</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_27">  27</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_27"></span><span class="anchor" id="line-27-19"></span>        <span class="ResWord">return</span> <span class="ID">ret</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_28">  28</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_28"></span><span class="anchor" id="line-28-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_29">  29</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_29"></span><span class="anchor" id="line-29-17"></span>    <span class="ResWord">def</span> <span class="ID">__repr__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_30">  30</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_30"></span><span class="anchor" id="line-30-15"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">f</span>.<span class="ID">func_name</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_31">  31</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_31"></span><span class="anchor" id="line-31-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_32">  32</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_32"></span><span class="anchor" id="line-32-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_33">  33</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_33"></span><span class="anchor" id="line-33-14"></span><span class="ResWord">class</span> <span class="ID">DecoTraceWithArgs</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_34">  34</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_34"></span><span class="anchor" id="line-34-13"></span>    <span class="String">'''decorator class with ARGUMENTS</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_35">  35</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_35"></span><span class="anchor" id="line-35-13"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_36">  36</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_36"></span><span class="anchor" id="line-36-13"></span><span class="String">       This can be used for unbounded functions and methods.  If this wraps a</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_37">  37</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_37"></span><span class="anchor" id="line-37-13"></span><span class="String">       class instance, then extract it and pass to the wrapped method as the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_38">  38</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_38"></span><span class="anchor" id="line-38-12"></span><span class="String">       first arg.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_39">  39</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_39"></span><span class="anchor" id="line-39-12"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_40">  40</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_40"></span><span class="anchor" id="line-40-12"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_41">  41</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_41"></span><span class="anchor" id="line-41-11"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, *<span class="ID">dec_args</span>, **<span class="ID">dec_kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_42">  42</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_42"></span><span class="anchor" id="line-42-9"></span>        <span class="String">'''The decorator arguments are passed here.  Save them for runtime.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_43">  43</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_43"></span><span class="anchor" id="line-43-9"></span>        <span class="ResWord">self</span>.<span class="ID">dec_args</span> = <span class="ID">dec_args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_44">  44</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_44"></span><span class="anchor" id="line-44-9"></span>        <span class="ResWord">self</span>.<span class="ID">dec_kw</span> = <span class="ID">dec_kw</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_45">  45</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_45"></span><span class="anchor" id="line-45-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_46">  46</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_46"></span><span class="anchor" id="line-46-9"></span>        <span class="ResWord">self</span>.<span class="ID">label</span> = <span class="ID">dec_kw</span>.<span class="ID">get</span>(<span class="String">'</span><span class="String">label</span><span class="String">'</span>, <span class="String">'</span><span class="String">T</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_47">  47</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_47"></span><span class="anchor" id="line-47-9"></span>        <span class="ResWord">self</span>.<span class="ID">fid</span> = <span class="ID">dec_kw</span>.<span class="ID">get</span>(<span class="String">'</span><span class="String">stream</span><span class="String">'</span>, <span class="ID">stderr</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_48">  48</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_48"></span><span class="anchor" id="line-48-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_49">  49</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_49"></span><span class="anchor" id="line-49-8"></span>    <span class="ResWord">def</span> <span class="ID">_showargs</span>(<span class="ResWord">self</span>, *<span class="ID">fargs</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_50">  50</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_50"></span><span class="anchor" id="line-50-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_51">  51</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_51"></span><span class="anchor" id="line-51-7"></span>        <span class="ResWord">print</span> &gt;&gt; <span class="ResWord">self</span>.<span class="ID">fid</span>, \</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_52">  52</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_52"></span><span class="anchor" id="line-52-7"></span>              <span class="String">'</span><span class="String">{}: enter {} with args={}, kw={}</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ResWord">self</span>.<span class="ID">label</span>, <span class="ResWord">self</span>.<span class="ID">f</span>.<span class="ID">__name__</span>, <span class="ResWord">str</span>(<span class="ID">fargs</span>), <span class="ResWord">str</span>(<span class="ID">kw</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_53">  53</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_53"></span><span class="anchor" id="line-53-7"></span>        <span class="ResWord">print</span> &gt;&gt; <span class="ResWord">self</span>.<span class="ID">fid</span>, \</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_54">  54</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_54"></span><span class="anchor" id="line-54-7"></span>              <span class="String">'</span><span class="String">{}:   passing decorator args={}, kw={}</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ResWord">self</span>.<span class="ID">label</span>, <span class="ResWord">str</span>(<span class="ResWord">self</span>.<span class="ID">dec_args</span>), <span class="ResWord">str</span>(<span class="ResWord">self</span>.<span class="ID">dec_kw</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_55">  55</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_55"></span><span class="anchor" id="line-55-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_56">  56</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_56"></span><span class="anchor" id="line-56-7"></span>    <span class="ResWord">def</span> <span class="ID">_aftercall</span>(<span class="ResWord">self</span>, <span class="ID">status</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_57">  57</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_57"></span><span class="anchor" id="line-57-7"></span>        <span class="ResWord">print</span> &gt;&gt; <span class="ResWord">self</span>.<span class="ID">fid</span>, <span class="String">'</span><span class="String">{}: exit {} with status={}</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ResWord">self</span>.<span class="ID">label</span>, <span class="ResWord">self</span>.<span class="ID">f</span>.<span class="ID">__name__</span>, <span class="ResWord">str</span>(<span class="ID">status</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_58">  58</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_58"></span><span class="anchor" id="line-58-7"></span>    <span class="ResWord">def</span> <span class="ID">_showinstance</span>(<span class="ResWord">self</span>, <span class="ID">instance</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_59">  59</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_59"></span><span class="anchor" id="line-59-7"></span>        <span class="ResWord">print</span> &gt;&gt; <span class="ResWord">self</span>.<span class="ID">fid</span>, <span class="String">'</span><span class="String">{}: instance={}</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ResWord">self</span>.<span class="ID">label</span>, <span class="ID">instance</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_60">  60</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_60"></span><span class="anchor" id="line-60-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_61">  61</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_61"></span><span class="anchor" id="line-61-7"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, <span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_62">  62</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_62"></span><span class="anchor" id="line-62-6"></span>        <span class="ResWord">def</span> <span class="ID">wrapper</span>(*<span class="ID">fargs</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_63">  63</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_63"></span><span class="anchor" id="line-63-6"></span>            <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_64">  64</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_64"></span><span class="anchor" id="line-64-6"></span><span class="String">              Combine decorator arguments and function arguments and pass to wrapped</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_65">  65</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_65"></span><span class="anchor" id="line-65-6"></span><span class="String">              class instance-aware function/method.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_66">  66</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_66"></span><span class="anchor" id="line-66-6"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_67">  67</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_67"></span><span class="anchor" id="line-67-6"></span><span class="String">              Note: the first argument cannot be &quot;self&quot; because we get a parse error</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_68">  68</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_68"></span><span class="anchor" id="line-68-6"></span><span class="String">              &quot;takes at least 1 argument&quot; unless the instance is actually included in</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_69">  69</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_69"></span><span class="anchor" id="line-69-6"></span><span class="String">              the argument list, which is redundant.  If this wraps a class instance,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_70">  70</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_70"></span><span class="anchor" id="line-70-6"></span><span class="String">              the &quot;self&quot; will be the first argument.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_71">  71</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_71"></span><span class="anchor" id="line-71-6"></span><span class="String">            '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_72">  72</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_72"></span><span class="anchor" id="line-72-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_73">  73</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_73"></span><span class="anchor" id="line-73-6"></span>            <span class="ResWord">self</span>.<span class="ID">_showargs</span>(*<span class="ID">fargs</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_74">  74</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_74"></span><span class="anchor" id="line-74-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_75">  75</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_75"></span><span class="anchor" id="line-75-6"></span>            <span class="Comment"># merge decorator keywords into the kw argument list</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_76">  76</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_76"></span><span class="anchor" id="line-76-6"></span>            <span class="ID">kw</span>.<span class="ID">update</span>(<span class="ResWord">self</span>.<span class="ID">dec_kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_77">  77</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_77"></span><span class="anchor" id="line-77-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_78">  78</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_78"></span><span class="anchor" id="line-78-6"></span>            <span class="Comment"># Does this wrap a class instance?</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_79">  79</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_79"></span><span class="anchor" id="line-79-6"></span>            <span class="ResWord">if</span> <span class="ID">fargs</span> <span class="ResWord">and</span> <span class="ResWord">getattr</span>(<span class="ID">fargs</span>[<span class="Number">0</span>], <span class="String">'</span><span class="String">__class__</span><span class="String">'</span>, <span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_80">  80</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_80"></span><span class="anchor" id="line-80-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_81">  81</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_81"></span><span class="anchor" id="line-81-6"></span>                <span class="Comment"># pull out the instance and combine function and</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_82">  82</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_82"></span><span class="anchor" id="line-82-6"></span>                <span class="Comment"># decorator args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_83">  83</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_83"></span><span class="anchor" id="line-83-6"></span>                <span class="ID">instance</span>, <span class="ID">fargs</span> = <span class="ID">fargs</span>[<span class="Number">0</span>], <span class="ID">fargs</span>[<span class="Number">1</span>:]+<span class="ResWord">self</span>.<span class="ID">dec_args</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_84">  84</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_84"></span><span class="anchor" id="line-84-6"></span>                <span class="ResWord">self</span>.<span class="ID">_showinstance</span>(<span class="ID">instance</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_85">  85</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_85"></span><span class="anchor" id="line-85-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_86">  86</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_86"></span><span class="anchor" id="line-86-6"></span>                <span class="Comment"># call the method</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_87">  87</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_87"></span><span class="anchor" id="line-87-6"></span>                <span class="ID">ret</span>=<span class="ID">f</span>(<span class="ID">instance</span>, *<span class="ID">fargs</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_88">  88</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_88"></span><span class="anchor" id="line-88-6"></span>            <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_89">  89</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_89"></span><span class="anchor" id="line-89-6"></span>                <span class="Comment"># just send in the give args and kw</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_90">  90</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_90"></span><span class="anchor" id="line-90-6"></span>                <span class="ID">ret</span>=<span class="ID">f</span>(*(<span class="ID">fargs</span> + <span class="ResWord">self</span>.<span class="ID">dec_args</span>), **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_91">  91</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_91"></span><span class="anchor" id="line-91-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_92">  92</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_92"></span><span class="anchor" id="line-92-6"></span>            <span class="ResWord">self</span>.<span class="ID">_aftercall</span>(<span class="ID">ret</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_93">  93</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_93"></span><span class="anchor" id="line-93-6"></span>            <span class="ResWord">return</span> <span class="ID">ret</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_94">  94</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_94"></span><span class="anchor" id="line-94-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_95">  95</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_95"></span><span class="anchor" id="line-95-6"></span>        <span class="Comment"># Save wrapped function reference</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_96">  96</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_96"></span><span class="anchor" id="line-96-6"></span>        <span class="ResWord">self</span>.<span class="ID">f</span> = <span class="ID">f</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_97">  97</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_97"></span><span class="anchor" id="line-97-6"></span>        <span class="ID">wrapper</span>.<span class="ID">__name__</span> = <span class="ID">f</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_98">  98</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_98"></span><span class="anchor" id="line-98-6"></span>        <span class="ID">wrapper</span>.<span class="ID">__dict__</span>.<span class="ID">update</span>(<span class="ID">f</span>.<span class="ID">__dict__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_99">  99</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_99"></span><span class="anchor" id="line-99-6"></span>        <span class="ID">wrapper</span>.<span class="ID">__doc__</span> = <span class="ID">f</span>.<span class="ID">__doc__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_100"> 100</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_100"></span><span class="anchor" id="line-100-6"></span>        <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_101"> 101</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_101"></span><span class="anchor" id="line-101-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_102"> 102</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_102"></span><span class="anchor" id="line-102-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_103"> 103</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_103"></span><span class="anchor" id="line-103-6"></span><span class="ID">@DecoTrace</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_104"> 104</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_104"></span><span class="anchor" id="line-104-6"></span><span class="ResWord">def</span> <span class="ID">FirstBruce</span>(*<span class="ID">fargs</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_105"> 105</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_105"></span><span class="anchor" id="line-105-6"></span>    <span class="String">'</span><span class="String">Simple function using simple decorator.</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_106"> 106</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_106"></span><span class="anchor" id="line-106-6"></span>    <span class="ResWord">if</span> <span class="ID">fargs</span> <span class="ResWord">and</span> <span class="ID">fargs</span>[<span class="Number">0</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_107"> 107</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_107"></span><span class="anchor" id="line-107-6"></span>        <span class="ResWord">print</span> <span class="ID">fargs</span>[<span class="Number">0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_108"> 108</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_108"></span><span class="anchor" id="line-108-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_109"> 109</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_109"></span><span class="anchor" id="line-109-6"></span><span class="ID">@DecoTraceWithArgs</span>(<span class="ID">name</span>=<span class="String">&quot;</span><span class="String">Second Bruce</span><span class="String">&quot;</span>, <span class="ID">standardline</span>=<span class="String">&quot;</span><span class="String">G</span><span class="String">'</span><span class="String">day, Bruce!</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_110"> 110</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_110"></span><span class="anchor" id="line-110-6"></span><span class="ResWord">def</span> <span class="ID">SecondBruce</span>(*<span class="ID">fargs</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_111"> 111</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_111"></span><span class="anchor" id="line-111-6"></span>    <span class="String">'</span><span class="String">Simple function using decorator with arguments.</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_112"> 112</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_112"></span><span class="anchor" id="line-112-6"></span>    <span class="ResWord">print</span> <span class="String">'</span><span class="String">{}:</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ID">kwargs</span>.<span class="ID">get</span>(<span class="String">'</span><span class="String">name</span><span class="String">'</span>, <span class="String">'</span><span class="String">Unknown Bruce</span><span class="String">'</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_113"> 113</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_113"></span><span class="anchor" id="line-113-6"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_114"> 114</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_114"></span><span class="anchor" id="line-114-6"></span>    <span class="ResWord">if</span> <span class="ID">fargs</span> <span class="ResWord">and</span> <span class="ID">fargs</span>[<span class="Number">0</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_115"> 115</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_115"></span><span class="anchor" id="line-115-6"></span>        <span class="ResWord">print</span> <span class="ID">fargs</span>[<span class="Number">0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_116"> 116</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_116"></span><span class="anchor" id="line-116-6"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_117"> 117</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_117"></span><span class="anchor" id="line-117-5"></span>        <span class="ResWord">print</span> <span class="ID">kwargs</span>.<span class="ID">get</span>(<span class="String">'</span><span class="String">standardline</span><span class="String">'</span>, <span class="ResWord">None</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_118"> 118</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_118"></span><span class="anchor" id="line-118-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_119"> 119</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_119"></span><span class="anchor" id="line-119-5"></span><span class="ResWord">class</span> <span class="ID">Bruce</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_120"> 120</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_120"></span><span class="anchor" id="line-120-5"></span>    <span class="String">'</span><span class="String">Simple class.</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_121"> 121</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_121"></span><span class="anchor" id="line-121-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_122"> 122</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_122"></span><span class="anchor" id="line-122-5"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ResWord">id</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_123"> 123</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_123"></span><span class="anchor" id="line-123-5"></span>        <span class="ResWord">self</span>.<span class="ID">id</span> = <span class="ResWord">id</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_124"> 124</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_124"></span><span class="anchor" id="line-124-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_125"> 125</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_125"></span><span class="anchor" id="line-125-5"></span>    <span class="ResWord">def</span> <span class="ID">__str__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_126"> 126</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_126"></span><span class="anchor" id="line-126-5"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">id</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_127"> 127</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_127"></span><span class="anchor" id="line-127-5"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_128"> 128</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_128"></span><span class="anchor" id="line-128-5"></span>    <span class="ResWord">def</span> <span class="ID">__repr__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_129"> 129</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_129"></span><span class="anchor" id="line-129-4"></span>        <span class="ResWord">return</span> <span class="String">'</span><span class="String">Bruce</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_130"> 130</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_130"></span><span class="anchor" id="line-130-4"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_131"> 131</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_131"></span><span class="anchor" id="line-131-4"></span>    <span class="ID">@DecoTraceWithArgs</span>(<span class="ID">label</span>=<span class="String">&quot;</span><span class="String">Trace a class</span><span class="String">&quot;</span>, <span class="ID">standardline</span>=<span class="String">&quot;</span><span class="String">How are yer Bruce?</span><span class="String">&quot;</span>, <span class="ID">stream</span>=<span class="ID">stdout</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_132"> 132</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_132"></span><span class="anchor" id="line-132-3"></span>    <span class="ResWord">def</span> <span class="ID">talk</span>(<span class="ResWord">self</span>, *<span class="ID">fargs</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_133"> 133</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_133"></span><span class="anchor" id="line-133-3"></span>        <span class="String">'</span><span class="String">Simple function using decorator with arguments.</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_134"> 134</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_134"></span><span class="anchor" id="line-134-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_135"> 135</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_135"></span><span class="anchor" id="line-135-3"></span>        <span class="ResWord">print</span> <span class="String">'</span><span class="String">{}:</span><span class="String">'</span>.<span class="ID">format</span>(<span class="ResWord">self</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_136"> 136</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_136"></span><span class="anchor" id="line-136-3"></span>        <span class="ResWord">if</span> <span class="ID">fargs</span> <span class="ResWord">and</span> <span class="ID">fargs</span>[<span class="Number">0</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_137"> 137</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_137"></span><span class="anchor" id="line-137-3"></span>            <span class="ResWord">print</span> <span class="ID">fargs</span>[<span class="Number">0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_138"> 138</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_138"></span><span class="anchor" id="line-138-3"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_139"> 139</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_139"></span><span class="anchor" id="line-139-3"></span>            <span class="ResWord">print</span> <span class="ID">kwargs</span>.<span class="ID">get</span>(<span class="String">'</span><span class="String">standardline</span><span class="String">'</span>, <span class="ResWord">None</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_140"> 140</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_140"></span><span class="anchor" id="line-140-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_141"> 141</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_141"></span><span class="anchor" id="line-141-3"></span><span class="ID">ThirdBruce</span> = <span class="ID">Bruce</span>(<span class="String">'</span><span class="String">Third Bruce</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_142"> 142</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_142"></span><span class="anchor" id="line-142-3"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_143"> 143</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_143"></span><span class="anchor" id="line-143-3"></span><span class="ID">SecondBruce</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_144"> 144</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_144"></span><span class="anchor" id="line-144-3"></span><span class="ID">FirstBruce</span>(<span class="String">&quot;</span><span class="String">First Bruce: Oh, Hello Bruce!</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_145"> 145</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_145"></span><span class="anchor" id="line-145-3"></span><span class="ID">ThirdBruce</span>.<span class="ID">talk</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_146"> 146</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_146"></span><span class="anchor" id="line-146-3"></span><span class="ID">FirstBruce</span>(<span class="String">&quot;</span><span class="String">First Bruce: Bit crook, Bruce.</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_147"> 147</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_147"></span><span class="anchor" id="line-147-3"></span><span class="ID">SecondBruce</span>(<span class="String">&quot;</span><span class="String">Where</span><span class="String">'</span><span class="String">s Bruce?</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_148"> 148</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_148"></span><span class="anchor" id="line-148-3"></span><span class="ID">FirstBruce</span>(<span class="String">&quot;</span><span class="String">First Bruce: He</span><span class="String">'</span><span class="String">s not here, Bruce</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_149"> 149</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_149"></span><span class="anchor" id="line-149-3"></span><span class="ID">ThirdBruce</span>.<span class="ID">talk</span>(<span class="String">&quot;</span><span class="String">Blimey, s</span><span class="String">'</span><span class="String">hot in here, Bruce.</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_150"> 150</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_150"></span><span class="anchor" id="line-150-3"></span><span class="ID">FirstBruce</span>(<span class="String">&quot;</span><span class="String">First Bruce: S</span><span class="String">'</span><span class="String">hot enough to boil a monkey</span><span class="String">'</span><span class="String">s bum!</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_151"> 151</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_151"></span><span class="anchor" id="line-151-2"></span><span class="ID">SecondBruce</span>(<span class="String">&quot;</span><span class="String">That</span><span class="String">'</span><span class="String">s a strange expression, Bruce.</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_152"> 152</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_152"></span><span class="anchor" id="line-152-2"></span><span class="ID">FirstBruce</span>(<span class="String">&quot;</span><span class="String">First Bruce: Well Bruce, I heard the Prime Minister use it. S</span><span class="String">'</span><span class="String">hot enough to boil a monkey</span><span class="String">'</span><span class="String">s bum in </span><span class="String">'</span><span class="String">ere, your Majesty,</span><span class="String">'</span><span class="String"> he said and she smiled quietly to herself.</span><span class="String">&quot;</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_153"> 153</a> </span><span class="LineAnchor" id="CA-fe69fc169ae8de937559f9cf3c72407de0ba33bc_153"></span><span class="anchor" id="line-153-2"></span><span class="ID">ThirdBruce</span>.<span class="ID">talk</span>(<span class="String">&quot;</span><span class="String">She</span><span class="String">'</span><span class="String">s a good Sheila, Bruce and not at all stuck up.</span><span class="String">&quot;</span>)</span>
</pre></div></div><span class="anchor" id="line-1771"></span><p class="line867">
<h2 id="Unimplemented_function_replacement">Unimplemented function replacement</h2>
<span class="anchor" id="line-1772"></span><p class="line874">Allows you to test unimplemented code in a development environment by specifying a default argument as an argument to the decorator (or you can leave it off to specify None to be returned. <span class="anchor" id="line-1773"></span><span class="anchor" id="line-1774"></span><p class="line867"><span class="anchor" id="line-1775"></span><span class="anchor" id="line-1776"></span><span class="anchor" id="line-1777"></span><span class="anchor" id="line-1778"></span><span class="anchor" id="line-1779"></span><span class="anchor" id="line-1780"></span><span class="anchor" id="line-1781"></span><span class="anchor" id="line-1782"></span><span class="anchor" id="line-1783"></span><span class="anchor" id="line-1784"></span><span class="anchor" id="line-1785"></span><span class="anchor" id="line-1786"></span><span class="anchor" id="line-1787"></span><span class="anchor" id="line-1-65"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-3246af8678b85e6b8dd3396e8b39b60d184fec61\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_1">   1</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_1"></span><span class="anchor" id="line-1-66"></span><span class="Comment"># Annotation wrapper annotation method</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_2">   2</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_2"></span><span class="anchor" id="line-2-33"></span><span class="ResWord">def</span> <span class="ID">unimplemented</span>(<span class="ID">defaultval</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_3">   3</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_3"></span><span class="anchor" id="line-3-33"></span>    <span class="ResWord">if</span>(<span class="ResWord">type</span>(<span class="ID">defaultval</span>) == <span class="ResWord">type</span>(<span class="ID">unimplemented</span>)):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_4">   4</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_4"></span><span class="anchor" id="line-4-32"></span>        <span class="ResWord">return</span> <span class="ResWord">lambda</span>: <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_5">   5</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_5"></span><span class="anchor" id="line-5-32"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_6">   6</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_6"></span><span class="anchor" id="line-6-32"></span>        <span class="Comment"># Actual annotation</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_7">   7</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_7"></span><span class="anchor" id="line-7-32"></span>        <span class="ResWord">def</span> <span class="ID">unimp_wrapper</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_8">   8</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_8"></span><span class="anchor" id="line-8-32"></span>            <span class="Comment"># What we replace the function with</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_9">   9</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_9"></span><span class="anchor" id="line-9-32"></span>            <span class="ResWord">def</span> <span class="ID">wrapper</span>(*<span class="ID">arg</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_10">  10</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_10"></span><span class="anchor" id="line-10-32"></span>                <span class="ResWord">return</span> <span class="ID">defaultval</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_11">  11</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_11"></span><span class="anchor" id="line-11-30"></span>            <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_12">  12</a> </span><span class="LineAnchor" id="CA-3246af8678b85e6b8dd3396e8b39b60d184fec61_12"></span><span class="anchor" id="line-12-30"></span>        <span class="ResWord">return</span> <span class="ID">unimp_wrapper</span></span>
</pre></div></div><span class="anchor" id="line-1788"></span><p class="line867">
<h2 id="Redirects_stdout_printing_to_python_standard_logging.">Redirects stdout printing to python standard logging.</h2>
<span class="anchor" id="line-1789"></span><p class="line867"><span class="anchor" id="line-1790"></span><span class="anchor" id="line-1791"></span><span class="anchor" id="line-1792"></span><span class="anchor" id="line-1793"></span><span class="anchor" id="line-1794"></span><span class="anchor" id="line-1795"></span><span class="anchor" id="line-1796"></span><span class="anchor" id="line-1797"></span><span class="anchor" id="line-1798"></span><span class="anchor" id="line-1799"></span><span class="anchor" id="line-1800"></span><span class="anchor" id="line-1801"></span><span class="anchor" id="line-1802"></span><span class="anchor" id="line-1803"></span><span class="anchor" id="line-1804"></span><span class="anchor" id="line-1805"></span><span class="anchor" id="line-1806"></span><span class="anchor" id="line-1807"></span><span class="anchor" id="line-1808"></span><span class="anchor" id="line-1809"></span><span class="anchor" id="line-1810"></span><span class="anchor" id="line-1811"></span><span class="anchor" id="line-1812"></span><span class="anchor" id="line-1813"></span><span class="anchor" id="line-1814"></span><span class="anchor" id="line-1815"></span><span class="anchor" id="line-1-67"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_1">   1</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_1"></span><span class="anchor" id="line-1-68"></span><span class="ResWord">class</span> <span class="ID">LogPrinter</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_2">   2</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_2"></span><span class="anchor" id="line-2-34"></span>    <span class="String">'''LogPrinter class which serves to emulates a file object and logs</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_3">   3</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_3"></span><span class="anchor" id="line-3-34"></span><span class="String">       whatever it gets sent to a Logger object at the INFO level.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_4">   4</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_4"></span><span class="anchor" id="line-4-33"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_5">   5</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_5"></span><span class="anchor" id="line-5-33"></span>        <span class="String">'''Grabs the specific logger to use for logprinting.'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_6">   6</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_6"></span><span class="anchor" id="line-6-33"></span>        <span class="ResWord">self</span>.<span class="ID">ilogger</span> = <span class="ID">logging</span>.<span class="ID">getLogger</span>(<span class="String">'</span><span class="String">logprinter</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_7">   7</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_7"></span><span class="anchor" id="line-7-33"></span>        <span class="ID">il</span> = <span class="ResWord">self</span>.<span class="ID">ilogger</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_8">   8</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_8"></span><span class="anchor" id="line-8-33"></span>        <span class="ID">logging</span>.<span class="ID">basicConfig</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_9">   9</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_9"></span><span class="anchor" id="line-9-33"></span>        <span class="ID">il</span>.<span class="ID">setLevel</span>(<span class="ID">logging</span>.<span class="ID">INFO</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_10">  10</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_10"></span><span class="anchor" id="line-10-33"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_11">  11</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_11"></span><span class="anchor" id="line-11-31"></span>    <span class="ResWord">def</span> <span class="ID">write</span>(<span class="ResWord">self</span>, <span class="ID">text</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_12">  12</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_12"></span><span class="anchor" id="line-12-31"></span>        <span class="String">'''Logs written output to a specific logger'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_13">  13</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_13"></span><span class="anchor" id="line-13-30"></span>        <span class="ResWord">self</span>.<span class="ID">ilogger</span>.<span class="ID">info</span>(<span class="ID">text</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_14">  14</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_14"></span><span class="anchor" id="line-14-30"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_15">  15</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_15"></span><span class="anchor" id="line-15-30"></span><span class="ResWord">def</span> <span class="ID">logprintinfo</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_16">  16</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_16"></span><span class="anchor" id="line-16-30"></span>    <span class="String">'''Wraps a method so that any calls made to print get logged instead'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_17">  17</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_17"></span><span class="anchor" id="line-17-29"></span>    <span class="ResWord">def</span> <span class="ID">pwrapper</span>(*<span class="ID">arg</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_18">  18</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_18"></span><span class="anchor" id="line-18-29"></span>        <span class="ID">stdobak</span> = <span class="ID">sys</span>.<span class="ID">stdout</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_19">  19</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_19"></span><span class="anchor" id="line-19-28"></span>        <span class="ID">lpinstance</span> = <span class="ID">LogPrinter</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_20">  20</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_20"></span><span class="anchor" id="line-20-27"></span>        <span class="ID">sys</span>.<span class="ID">stdout</span> = <span class="ID">lpinstance</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_21">  21</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_21"></span><span class="anchor" id="line-21-27"></span>        <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_22">  22</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_22"></span><span class="anchor" id="line-22-27"></span>            <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">arg</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_23">  23</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_23"></span><span class="anchor" id="line-23-27"></span>        <span class="ResWord">finally</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_24">  24</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_24"></span><span class="anchor" id="line-24-24"></span>            <span class="ID">sys</span>.<span class="ID">stdout</span> = <span class="ID">stdobak</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_25">  25</a> </span><span class="LineAnchor" id="CA-a26c0dcaeffb503db012fe8eb46a0a0cab4300e6_25"></span><span class="anchor" id="line-25-24"></span>    <span class="ResWord">return</span> <span class="ID">pwrapper</span></span>
</pre></div></div><span class="anchor" id="line-1816"></span><p class="line867">
<h2 id="Access_control">Access control</h2>
<span class="anchor" id="line-1817"></span><p class="line874">This example prevents users from getting access to places where they are not authorised to go <span class="anchor" id="line-1818"></span><span class="anchor" id="line-1819"></span><p class="line867"><span class="anchor" id="line-1820"></span><span class="anchor" id="line-1821"></span><span class="anchor" id="line-1822"></span><span class="anchor" id="line-1823"></span><span class="anchor" id="line-1824"></span><span class="anchor" id="line-1825"></span><span class="anchor" id="line-1826"></span><span class="anchor" id="line-1827"></span><span class="anchor" id="line-1828"></span><span class="anchor" id="line-1829"></span><span class="anchor" id="line-1830"></span><span class="anchor" id="line-1831"></span><span class="anchor" id="line-1832"></span><span class="anchor" id="line-1833"></span><span class="anchor" id="line-1834"></span><span class="anchor" id="line-1835"></span><span class="anchor" id="line-1836"></span><span class="anchor" id="line-1837"></span><span class="anchor" id="line-1838"></span><span class="anchor" id="line-1839"></span><span class="anchor" id="line-1840"></span><span class="anchor" id="line-1841"></span><span class="anchor" id="line-1842"></span><span class="anchor" id="line-1843"></span><span class="anchor" id="line-1844"></span><span class="anchor" id="line-1845"></span><span class="anchor" id="line-1846"></span><span class="anchor" id="line-1847"></span><span class="anchor" id="line-1848"></span><span class="anchor" id="line-1-69"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-256edc63978290c24d34b7e2e5491cfec6467936\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-256edc63978290c24d34b7e2e5491cfec6467936" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_1">   1</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_1"></span><span class="anchor" id="line-1-70"></span><span class="ResWord">class</span> <span class="ID">LoginCheck</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_2">   2</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_2"></span><span class="anchor" id="line-2-35"></span>    <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_3">   3</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_3"></span><span class="anchor" id="line-3-35"></span><span class="String">    This class checks whether a user</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_4">   4</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_4"></span><span class="anchor" id="line-4-34"></span><span class="String">    has logged in properly via</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_5">   5</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_5"></span><span class="anchor" id="line-5-34"></span><span class="String">    the global &quot;check_function&quot;. If so,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_6">   6</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_6"></span><span class="anchor" id="line-6-34"></span><span class="String">    the requested routine is called.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_7">   7</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_7"></span><span class="anchor" id="line-7-34"></span><span class="String">    Otherwise, an alternative page is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_8">   8</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_8"></span><span class="anchor" id="line-8-34"></span><span class="String">    displayed via the global &quot;alt_function&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_9">   9</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_9"></span><span class="anchor" id="line-9-34"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_10">  10</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_10"></span><span class="anchor" id="line-10-34"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_11">  11</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_11"></span><span class="anchor" id="line-11-32"></span>        <span class="ResWord">self</span>.<span class="ID">_f</span> = <span class="ID">f</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_12">  12</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_12"></span><span class="anchor" id="line-12-32"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_13">  13</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_13"></span><span class="anchor" id="line-13-31"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_14">  14</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_14"></span><span class="anchor" id="line-14-31"></span>        <span class="ID">Status</span> = <span class="ID">check_function</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_15">  15</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_15"></span><span class="anchor" id="line-15-31"></span>        <span class="ResWord">if</span> <span class="ID">Status</span> <span class="ResWord">is</span> <span class="Number">1</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_16">  16</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_16"></span><span class="anchor" id="line-16-31"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">_f</span>(*<span class="ID">args</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_17">  17</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_17"></span><span class="anchor" id="line-17-30"></span>        <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_18">  18</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_18"></span><span class="anchor" id="line-18-30"></span>            <span class="ResWord">return</span> <span class="ID">alt_function</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_19">  19</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_19"></span><span class="anchor" id="line-19-29"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_20">  20</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_20"></span><span class="anchor" id="line-20-28"></span><span class="ResWord">def</span> <span class="ID">check_function</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_21">  21</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_21"></span><span class="anchor" id="line-21-28"></span>    <span class="ResWord">return</span> <span class="ID">test</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_22">  22</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_22"></span><span class="anchor" id="line-22-28"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_23">  23</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_23"></span><span class="anchor" id="line-23-28"></span><span class="ResWord">def</span> <span class="ID">alt_function</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_24">  24</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_24"></span><span class="anchor" id="line-24-25"></span>    <span class="ResWord">return</span> <span class="String">'</span><span class="String">Sorry - this is the forced behaviour</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_25">  25</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_25"></span><span class="anchor" id="line-25-25"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_26">  26</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_26"></span><span class="anchor" id="line-26-23"></span><span class="ID">@LoginCheck</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_27">  27</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_27"></span><span class="anchor" id="line-27-20"></span><span class="ResWord">def</span> <span class="ID">display_members_page</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-256edc63978290c24d34b7e2e5491cfec6467936_28">  28</a> </span><span class="LineAnchor" id="CA-256edc63978290c24d34b7e2e5491cfec6467936_28"></span><span class="anchor" id="line-28-18"></span>    <span class="ResWord">print</span> <span class="String">'</span><span class="String">This is the members page</span><span class="String">'</span></span>
</pre></div></div><span class="anchor" id="line-1849"></span><p class="line874">Example: <span class="anchor" id="line-1850"></span><span class="anchor" id="line-1851"></span><p class="line867"><span class="anchor" id="line-1852"></span><span class="anchor" id="line-1853"></span><span class="anchor" id="line-1854"></span><span class="anchor" id="line-1855"></span><span class="anchor" id="line-1856"></span><span class="anchor" id="line-1857"></span><span class="anchor" id="line-1858"></span><span class="anchor" id="line-1859"></span><span class="anchor" id="line-1-71"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-797896343c325cfc2bc59c4f016b4a6de586a2d1\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-797896343c325cfc2bc59c4f016b4a6de586a2d1" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_1">   1</a> </span><span class="LineAnchor" id="CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_1"></span><span class="anchor" id="line-1-72"></span><span class="ID">test</span> = <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_2">   2</a> </span><span class="LineAnchor" id="CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_2"></span><span class="anchor" id="line-2-36"></span><span class="ID">DisplayMembersPage</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_3">   3</a> </span><span class="LineAnchor" id="CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_3"></span><span class="anchor" id="line-3-36"></span><span class="Comment"># Displays &quot;Sorry - this is the forced behaviour&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_4">   4</a> </span><span class="LineAnchor" id="CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_4"></span><span class="anchor" id="line-4-35"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_5">   5</a> </span><span class="LineAnchor" id="CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_5"></span><span class="anchor" id="line-5-35"></span><span class="ID">test</span> = <span class="Number">1</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_6">   6</a> </span><span class="LineAnchor" id="CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_6"></span><span class="anchor" id="line-6-35"></span><span class="ID">DisplayMembersPage</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_7">   7</a> </span><span class="LineAnchor" id="CA-797896343c325cfc2bc59c4f016b4a6de586a2d1_7"></span><span class="anchor" id="line-7-35"></span><span class="Comment"># Displays &quot;This is the members page&quot;</span></span>
</pre></div></div><span class="anchor" id="line-1860"></span><p class="line867">
<h2 id="Events_rising_and_handling">Events rising and handling</h2>
<span class="anchor" id="line-1861"></span><p class="line862">Please see the code and examples here: <a class="http" href="http://pypi.python.org/pypi/Decovent">http://pypi.python.org/pypi/Decovent</a> <span class="anchor" id="line-1862"></span><span class="anchor" id="line-1863"></span><p class="line867">
<h2 id="Singleton">Singleton</h2>
<span class="anchor" id="line-1864"></span><p class="line867"><span class="anchor" id="line-1865"></span><span class="anchor" id="line-1866"></span><span class="anchor" id="line-1867"></span><span class="anchor" id="line-1868"></span><span class="anchor" id="line-1869"></span><span class="anchor" id="line-1870"></span><span class="anchor" id="line-1871"></span><span class="anchor" id="line-1872"></span><span class="anchor" id="line-1873"></span><span class="anchor" id="line-1874"></span><span class="anchor" id="line-1875"></span><span class="anchor" id="line-1876"></span><span class="anchor" id="line-1877"></span><span class="anchor" id="line-1878"></span><span class="anchor" id="line-1879"></span><span class="anchor" id="line-1880"></span><span class="anchor" id="line-1881"></span><span class="anchor" id="line-1882"></span><span class="anchor" id="line-1883"></span><span class="anchor" id="line-1884"></span><span class="anchor" id="line-1885"></span><span class="anchor" id="line-1886"></span><span class="anchor" id="line-1887"></span><span class="anchor" id="line-1888"></span><span class="anchor" id="line-1889"></span><span class="anchor" id="line-1890"></span><span class="anchor" id="line-1891"></span><span class="anchor" id="line-1892"></span><span class="anchor" id="line-1893"></span><span class="anchor" id="line-1894"></span><span class="anchor" id="line-1895"></span><span class="anchor" id="line-1896"></span><span class="anchor" id="line-1897"></span><span class="anchor" id="line-1898"></span><span class="anchor" id="line-1899"></span><span class="anchor" id="line-1900"></span><span class="anchor" id="line-1901"></span><span class="anchor" id="line-1902"></span><span class="anchor" id="line-1903"></span><span class="anchor" id="line-1904"></span><span class="anchor" id="line-1905"></span><span class="anchor" id="line-1-73"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-0c3a436acba24849ab4004c16b8868d60d69653c\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_1">   1</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_1"></span><span class="anchor" id="line-1-74"></span><span class="ResWord">import</span> <span class="ID">functools</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_2">   2</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_2"></span><span class="anchor" id="line-2-37"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_3">   3</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_3"></span><span class="anchor" id="line-3-37"></span><span class="ResWord">def</span> <span class="ID">singleton</span>(<span class="ID">cls</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_4">   4</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_4"></span><span class="anchor" id="line-4-36"></span>    <span class="String">''' Use class as singleton. '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_5">   5</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_5"></span><span class="anchor" id="line-5-36"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_6">   6</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_6"></span><span class="anchor" id="line-6-36"></span>    <span class="ID">cls</span>.<span class="ID">__new_original__</span> = <span class="ID">cls</span>.<span class="ID">__new__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_7">   7</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_7"></span><span class="anchor" id="line-7-36"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_8">   8</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_8"></span><span class="anchor" id="line-8-35"></span>    <span class="ID">@functools.wraps</span>(<span class="ID">cls</span>.<span class="ID">__new__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_9">   9</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_9"></span><span class="anchor" id="line-9-35"></span>    <span class="ResWord">def</span> <span class="ID">singleton_new</span>(<span class="ID">cls</span>, *<span class="ID">args</span>, **<span class="ID">kw</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_10">  10</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_10"></span><span class="anchor" id="line-10-35"></span>        <span class="ID">it</span> =  <span class="ID">cls</span>.<span class="ID">__dict__</span>.<span class="ID">get</span>(<span class="String">'</span><span class="String">__it__</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_11">  11</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_11"></span><span class="anchor" id="line-11-33"></span>        <span class="ResWord">if</span> <span class="ID">it</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_12">  12</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_12"></span><span class="anchor" id="line-12-33"></span>            <span class="ResWord">return</span> <span class="ID">it</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_13">  13</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_13"></span><span class="anchor" id="line-13-32"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_14">  14</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_14"></span><span class="anchor" id="line-14-32"></span>        <span class="ID">cls</span>.<span class="ID">__it__</span> = <span class="ID">it</span> = <span class="ID">cls</span>.<span class="ID">__new_original__</span>(<span class="ID">cls</span>, *<span class="ID">args</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_15">  15</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_15"></span><span class="anchor" id="line-15-32"></span>        <span class="ID">it</span>.<span class="ID">__init_original__</span>(*<span class="ID">args</span>, **<span class="ID">kw</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_16">  16</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_16"></span><span class="anchor" id="line-16-32"></span>        <span class="ResWord">return</span> <span class="ID">it</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_17">  17</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_17"></span><span class="anchor" id="line-17-31"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_18">  18</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_18"></span><span class="anchor" id="line-18-31"></span>    <span class="ID">cls</span>.<span class="ID">__new__</span> = <span class="ID">singleton_new</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_19">  19</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_19"></span><span class="anchor" id="line-19-30"></span>    <span class="ID">cls</span>.<span class="ID">__init_original__</span> = <span class="ID">cls</span>.<span class="ID">__init__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_20">  20</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_20"></span><span class="anchor" id="line-20-29"></span>    <span class="ID">cls</span>.<span class="ID">__init__</span> = <span class="ResWord">object</span>.<span class="ID">__init__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_21">  21</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_21"></span><span class="anchor" id="line-21-29"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_22">  22</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_22"></span><span class="anchor" id="line-22-29"></span>    <span class="ResWord">return</span> <span class="ID">cls</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_23">  23</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_23"></span><span class="anchor" id="line-23-29"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_24">  24</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_24"></span><span class="anchor" id="line-24-26"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_25">  25</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_25"></span><span class="anchor" id="line-25-26"></span><span class="Comment"># Sample use:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_26">  26</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_26"></span><span class="anchor" id="line-26-24"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_27">  27</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_27"></span><span class="anchor" id="line-27-21"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_28">  28</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_28"></span><span class="anchor" id="line-28-19"></span><span class="ID">@singleton</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_29">  29</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_29"></span><span class="anchor" id="line-29-18"></span><span class="ResWord">class</span> <span class="ID">Foo</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_30">  30</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_30"></span><span class="anchor" id="line-30-16"></span>    <span class="ResWord">def</span> <span class="ID">__new__</span>(<span class="ID">cls</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_31">  31</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_31"></span><span class="anchor" id="line-31-15"></span>        <span class="ID">cls</span>.<span class="ID">x</span> = <span class="Number">10</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_32">  32</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_32"></span><span class="anchor" id="line-32-15"></span>        <span class="ResWord">return</span> <span class="ResWord">object</span>.<span class="ID">__new__</span>(<span class="ID">cls</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_33">  33</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_33"></span><span class="anchor" id="line-33-15"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_34">  34</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_34"></span><span class="anchor" id="line-34-14"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_35">  35</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_35"></span><span class="anchor" id="line-35-14"></span>        <span class="ResWord">assert</span> <span class="ResWord">self</span>.<span class="ID">x</span> == <span class="Number">10</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_36">  36</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_36"></span><span class="anchor" id="line-36-14"></span>        <span class="ResWord">self</span>.<span class="ID">x</span> = <span class="Number">15</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_37">  37</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_37"></span><span class="anchor" id="line-37-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_38">  38</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_38"></span><span class="anchor" id="line-38-13"></span><span class="ResWord">assert</span> <span class="ID">Foo</span>().<span class="ID">x</span> == <span class="Number">15</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_39">  39</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_39"></span><span class="anchor" id="line-39-13"></span><span class="ID">Foo</span>().<span class="ID">x</span> = <span class="Number">20</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0c3a436acba24849ab4004c16b8868d60d69653c_40">  40</a> </span><span class="LineAnchor" id="CA-0c3a436acba24849ab4004c16b8868d60d69653c_40"></span><span class="anchor" id="line-40-13"></span><span class="ResWord">assert</span> <span class="ID">Foo</span>().<span class="ID">x</span> == <span class="Number">20</span></span>
</pre></div></div><span class="anchor" id="line-1906"></span><p class="line867">
<h2 id="Asynchronous_Call">Asynchronous Call</h2>
<span class="anchor" id="line-1907"></span><p class="line867"><span class="anchor" id="line-1908"></span><span class="anchor" id="line-1909"></span><span class="anchor" id="line-1910"></span><span class="anchor" id="line-1911"></span><span class="anchor" id="line-1912"></span><span class="anchor" id="line-1913"></span><span class="anchor" id="line-1914"></span><span class="anchor" id="line-1915"></span><span class="anchor" id="line-1916"></span><span class="anchor" id="line-1917"></span><span class="anchor" id="line-1918"></span><span class="anchor" id="line-1919"></span><span class="anchor" id="line-1920"></span><span class="anchor" id="line-1921"></span><span class="anchor" id="line-1922"></span><span class="anchor" id="line-1923"></span><span class="anchor" id="line-1924"></span><span class="anchor" id="line-1925"></span><span class="anchor" id="line-1926"></span><span class="anchor" id="line-1927"></span><span class="anchor" id="line-1928"></span><span class="anchor" id="line-1929"></span><span class="anchor" id="line-1930"></span><span class="anchor" id="line-1931"></span><span class="anchor" id="line-1932"></span><span class="anchor" id="line-1933"></span><span class="anchor" id="line-1934"></span><span class="anchor" id="line-1935"></span><span class="anchor" id="line-1936"></span><span class="anchor" id="line-1937"></span><span class="anchor" id="line-1938"></span><span class="anchor" id="line-1939"></span><span class="anchor" id="line-1940"></span><span class="anchor" id="line-1941"></span><span class="anchor" id="line-1942"></span><span class="anchor" id="line-1943"></span><span class="anchor" id="line-1944"></span><span class="anchor" id="line-1945"></span><span class="anchor" id="line-1946"></span><span class="anchor" id="line-1947"></span><span class="anchor" id="line-1948"></span><span class="anchor" id="line-1949"></span><span class="anchor" id="line-1950"></span><span class="anchor" id="line-1951"></span><span class="anchor" id="line-1952"></span><span class="anchor" id="line-1953"></span><span class="anchor" id="line-1954"></span><span class="anchor" id="line-1955"></span><span class="anchor" id="line-1956"></span><span class="anchor" id="line-1957"></span><span class="anchor" id="line-1958"></span><span class="anchor" id="line-1959"></span><span class="anchor" id="line-1960"></span><span class="anchor" id="line-1961"></span><span class="anchor" id="line-1962"></span><span class="anchor" id="line-1963"></span><span class="anchor" id="line-1964"></span><span class="anchor" id="line-1965"></span><span class="anchor" id="line-1966"></span><span class="anchor" id="line-1967"></span><span class="anchor" id="line-1968"></span><span class="anchor" id="line-1969"></span><span class="anchor" id="line-1970"></span><span class="anchor" id="line-1971"></span><span class="anchor" id="line-1972"></span><span class="anchor" id="line-1973"></span><span class="anchor" id="line-1974"></span><span class="anchor" id="line-1975"></span><span class="anchor" id="line-1976"></span><span class="anchor" id="line-1-75"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-9e7236b82987f1c18304be2eb1a94f02fa787578\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_1">   1</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_1"></span><span class="anchor" id="line-1-76"></span><span class="ResWord">from</span> <span class="ID">Queue</span> <span class="ResWord">import</span> <span class="ID">Queue</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_2">   2</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_2"></span><span class="anchor" id="line-2-38"></span><span class="ResWord">from</span> <span class="ID">threading</span> <span class="ResWord">import</span> <span class="ID">Thread</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_3">   3</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_3"></span><span class="anchor" id="line-3-38"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_4">   4</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_4"></span><span class="anchor" id="line-4-37"></span><span class="ResWord">class</span> <span class="ID">asynchronous</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_5">   5</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_5"></span><span class="anchor" id="line-5-37"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_6">   6</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_6"></span><span class="anchor" id="line-6-37"></span>        <span class="ResWord">self</span>.<span class="ID">func</span> = <span class="ID">func</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_7">   7</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_7"></span><span class="anchor" id="line-7-37"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_8">   8</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_8"></span><span class="anchor" id="line-8-36"></span>        <span class="ResWord">def</span> <span class="ID">threaded</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_9">   9</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_9"></span><span class="anchor" id="line-9-36"></span>            <span class="ResWord">self</span>.<span class="ID">queue</span>.<span class="ID">put</span>(<span class="ResWord">self</span>.<span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_10">  10</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_10"></span><span class="anchor" id="line-10-36"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_11">  11</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_11"></span><span class="anchor" id="line-11-34"></span>        <span class="ResWord">self</span>.<span class="ID">threaded</span> = <span class="ID">threaded</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_12">  12</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_12"></span><span class="anchor" id="line-12-34"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_13">  13</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_13"></span><span class="anchor" id="line-13-33"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_14">  14</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_14"></span><span class="anchor" id="line-14-33"></span>        <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_15">  15</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_15"></span><span class="anchor" id="line-15-33"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_16">  16</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_16"></span><span class="anchor" id="line-16-33"></span>    <span class="ResWord">def</span> <span class="ID">start</span>(<span class="ResWord">self</span>, *<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_17">  17</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_17"></span><span class="anchor" id="line-17-32"></span>        <span class="ResWord">self</span>.<span class="ID">queue</span> = <span class="ID">Queue</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_18">  18</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_18"></span><span class="anchor" id="line-18-32"></span>        <span class="ID">thread</span> = <span class="ID">Thread</span>(<span class="ID">target</span>=<span class="ResWord">self</span>.<span class="ID">threaded</span>, <span class="ID">args</span>=<span class="ID">args</span>, <span class="ID">kwargs</span>=<span class="ID">kwargs</span>);</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_19">  19</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_19"></span><span class="anchor" id="line-19-31"></span>        <span class="ID">thread</span>.<span class="ID">start</span>();</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_20">  20</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_20"></span><span class="anchor" id="line-20-30"></span>        <span class="ResWord">return</span> <span class="ID">asynchronous</span>.<span class="ID">Result</span>(<span class="ResWord">self</span>.<span class="ID">queue</span>, <span class="ID">thread</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_21">  21</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_21"></span><span class="anchor" id="line-21-30"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_22">  22</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_22"></span><span class="anchor" id="line-22-30"></span>    <span class="ResWord">class</span> <span class="ID">NotYetDoneException</span>(<span class="ID">Exception</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_23">  23</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_23"></span><span class="anchor" id="line-23-30"></span>        <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">message</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_24">  24</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_24"></span><span class="anchor" id="line-24-27"></span>            <span class="ResWord">self</span>.<span class="ID">message</span> = <span class="ID">message</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_25">  25</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_25"></span><span class="anchor" id="line-25-27"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_26">  26</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_26"></span><span class="anchor" id="line-26-25"></span>    <span class="ResWord">class</span> <span class="ID">Result</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_27">  27</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_27"></span><span class="anchor" id="line-27-22"></span>        <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">queue</span>, <span class="ID">thread</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_28">  28</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_28"></span><span class="anchor" id="line-28-20"></span>            <span class="ResWord">self</span>.<span class="ID">queue</span> = <span class="ID">queue</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_29">  29</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_29"></span><span class="anchor" id="line-29-19"></span>            <span class="ResWord">self</span>.<span class="ID">thread</span> = <span class="ID">thread</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_30">  30</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_30"></span><span class="anchor" id="line-30-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_31">  31</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_31"></span><span class="anchor" id="line-31-16"></span>        <span class="ResWord">def</span> <span class="ID">is_done</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_32">  32</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_32"></span><span class="anchor" id="line-32-16"></span>            <span class="ResWord">return</span> <span class="ResWord">not</span> <span class="ResWord">self</span>.<span class="ID">thread</span>.<span class="ID">is_alive</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_33">  33</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_33"></span><span class="anchor" id="line-33-16"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_34">  34</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_34"></span><span class="anchor" id="line-34-15"></span>        <span class="ResWord">def</span> <span class="ID">get_result</span>(<span class="ResWord">self</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_35">  35</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_35"></span><span class="anchor" id="line-35-15"></span>            <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">self</span>.<span class="ID">is_done</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_36">  36</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_36"></span><span class="anchor" id="line-36-15"></span>                <span class="ResWord">raise</span> <span class="ID">asynchronous</span>.<span class="ID">NotYetDoneException</span>(<span class="String">'</span><span class="String">the call has not yet completed its task</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_37">  37</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_37"></span><span class="anchor" id="line-37-15"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_38">  38</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_38"></span><span class="anchor" id="line-38-14"></span>            <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">hasattr</span>(<span class="ResWord">self</span>, <span class="String">'</span><span class="String">result</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_39">  39</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_39"></span><span class="anchor" id="line-39-14"></span>                <span class="ResWord">self</span>.<span class="ID">result</span> = <span class="ResWord">self</span>.<span class="ID">queue</span>.<span class="ID">get</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_40">  40</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_40"></span><span class="anchor" id="line-40-14"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_41">  41</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_41"></span><span class="anchor" id="line-41-12"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_42">  42</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_42"></span><span class="anchor" id="line-42-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_43">  43</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_43"></span><span class="anchor" id="line-43-10"></span><span class="ResWord">if</span> <span class="ID">__name__</span> == <span class="String">'</span><span class="String">__main__</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_44">  44</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_44"></span><span class="anchor" id="line-44-10"></span>    <span class="Comment"># sample usage</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_45">  45</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_45"></span><span class="anchor" id="line-45-10"></span>    <span class="ResWord">import</span> <span class="ID">time</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_46">  46</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_46"></span><span class="anchor" id="line-46-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_47">  47</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_47"></span><span class="anchor" id="line-47-10"></span>    <span class="ID">@asynchronous</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_48">  48</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_48"></span><span class="anchor" id="line-48-9"></span>    <span class="ResWord">def</span> <span class="ID">long_process</span>(<span class="ID">num</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_49">  49</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_49"></span><span class="anchor" id="line-49-9"></span>        <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">10</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_50">  50</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_50"></span><span class="anchor" id="line-50-8"></span>        <span class="ResWord">return</span> <span class="ID">num</span> * <span class="ID">num</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_51">  51</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_51"></span><span class="anchor" id="line-51-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_52">  52</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_52"></span><span class="anchor" id="line-52-8"></span>    <span class="ID">result</span> = <span class="ID">long_process</span>.<span class="ID">start</span>(<span class="Number">12</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_53">  53</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_53"></span><span class="anchor" id="line-53-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_54">  54</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_54"></span><span class="anchor" id="line-54-8"></span>    <span class="ResWord">for</span> <span class="ID">i</span> <span class="ResWord">in</span> <span class="ResWord">range</span>(<span class="Number">20</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_55">  55</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_55"></span><span class="anchor" id="line-55-8"></span>        <span class="ResWord">print</span> <span class="ID">i</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_56">  56</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_56"></span><span class="anchor" id="line-56-8"></span>        <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_57">  57</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_57"></span><span class="anchor" id="line-57-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_58">  58</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_58"></span><span class="anchor" id="line-58-8"></span>        <span class="ResWord">if</span> <span class="ID">result</span>.<span class="ID">is_done</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_59">  59</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_59"></span><span class="anchor" id="line-59-8"></span>            <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">result {0}</span><span class="String">&quot;</span>.<span class="ID">format</span>(<span class="ID">result</span>.<span class="ID">get_result</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_60">  60</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_60"></span><span class="anchor" id="line-60-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_61">  61</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_61"></span><span class="anchor" id="line-61-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_62">  62</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_62"></span><span class="anchor" id="line-62-7"></span>    <span class="ID">result2</span> = <span class="ID">long_process</span>.<span class="ID">start</span>(<span class="Number">13</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_63">  63</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_63"></span><span class="anchor" id="line-63-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_64">  64</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_64"></span><span class="anchor" id="line-64-7"></span>    <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_65">  65</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_65"></span><span class="anchor" id="line-65-7"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">result2 {0}</span><span class="String">&quot;</span>.<span class="ID">format</span>(<span class="ID">result2</span>.<span class="ID">get_result</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_66">  66</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_66"></span><span class="anchor" id="line-66-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_67">  67</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_67"></span><span class="anchor" id="line-67-7"></span>    <span class="ResWord">except</span> <span class="ID">asynchronous</span>.<span class="ID">NotYetDoneException</span> <span class="ResWord">as</span> <span class="ID">ex</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-9e7236b82987f1c18304be2eb1a94f02fa787578_68">  68</a> </span><span class="LineAnchor" id="CA-9e7236b82987f1c18304be2eb1a94f02fa787578_68"></span><span class="anchor" id="line-68-7"></span>        <span class="ResWord">print</span> <span class="ID">ex</span>.<span class="ID">message</span></span>
</pre></div></div><span class="anchor" id="line-1977"></span><p class="line867">
<h2 id="Class_method_decorator_using_instance">Class method decorator using instance</h2>
<span class="anchor" id="line-1978"></span><p class="line874">When decorating a class method, the decorator receives an function not yet bound to an instance. <span class="anchor" id="line-1979"></span><span class="anchor" id="line-1980"></span><p class="line874">The decorator can't to do anything on the instance invocating it, unless it actually is a descriptor. <span class="anchor" id="line-1981"></span><span class="anchor" id="line-1982"></span><p class="line867"><span class="anchor" id="line-1983"></span><span class="anchor" id="line-1984"></span><span class="anchor" id="line-1985"></span><span class="anchor" id="line-1986"></span><span class="anchor" id="line-1987"></span><span class="anchor" id="line-1988"></span><span class="anchor" id="line-1989"></span><span class="anchor" id="line-1990"></span><span class="anchor" id="line-1991"></span><span class="anchor" id="line-1992"></span><span class="anchor" id="line-1993"></span><span class="anchor" id="line-1994"></span><span class="anchor" id="line-1995"></span><span class="anchor" id="line-1996"></span><span class="anchor" id="line-1997"></span><span class="anchor" id="line-1998"></span><span class="anchor" id="line-1999"></span><span class="anchor" id="line-2000"></span><span class="anchor" id="line-2001"></span><span class="anchor" id="line-2002"></span><span class="anchor" id="line-2003"></span><span class="anchor" id="line-2004"></span><span class="anchor" id="line-2005"></span><span class="anchor" id="line-2006"></span><span class="anchor" id="line-2007"></span><span class="anchor" id="line-2008"></span><span class="anchor" id="line-2009"></span><span class="anchor" id="line-2010"></span><span class="anchor" id="line-2011"></span><span class="anchor" id="line-2012"></span><span class="anchor" id="line-2013"></span><span class="anchor" id="line-2014"></span><span class="anchor" id="line-2015"></span><span class="anchor" id="line-2016"></span><span class="anchor" id="line-2017"></span><span class="anchor" id="line-2018"></span><span class="anchor" id="line-2019"></span><span class="anchor" id="line-2020"></span><span class="anchor" id="line-2021"></span><span class="anchor" id="line-2022"></span><span class="anchor" id="line-2023"></span><span class="anchor" id="line-2024"></span><span class="anchor" id="line-2025"></span><span class="anchor" id="line-2026"></span><span class="anchor" id="line-1-77"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-1f74040af898602b483f2d7691d29b4a5644cce2\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_1">   1</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_1"></span><span class="anchor" id="line-1-78"></span><span class="ResWord">from</span> <span class="ID">functools</span> <span class="ResWord">import</span> <span class="ID">wraps</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_2">   2</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_2"></span><span class="anchor" id="line-2-39"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_3">   3</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_3"></span><span class="anchor" id="line-3-39"></span><span class="ResWord">def</span> <span class="ID">decorate</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_4">   4</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_4"></span><span class="anchor" id="line-4-38"></span>    <span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_5">   5</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_5"></span><span class="anchor" id="line-5-38"></span><span class="String">    Class method decorator specific to the instance.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_6">   6</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_6"></span><span class="anchor" id="line-6-38"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_7">   7</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_7"></span><span class="anchor" id="line-7-38"></span><span class="String">    It uses a descriptor to delay the definition of the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_8">   8</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_8"></span><span class="anchor" id="line-8-37"></span><span class="String">    method wrapper.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_9">   9</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_9"></span><span class="anchor" id="line-9-37"></span><span class="String">    '''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_10">  10</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_10"></span><span class="anchor" id="line-10-37"></span>    <span class="ResWord">class</span> <span class="ID">descript</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_11">  11</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_11"></span><span class="anchor" id="line-11-35"></span>        <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_12">  12</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_12"></span><span class="anchor" id="line-12-35"></span>            <span class="ResWord">self</span>.<span class="ID">f</span> = <span class="ID">f</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_13">  13</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_13"></span><span class="anchor" id="line-13-34"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_14">  14</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_14"></span><span class="anchor" id="line-14-34"></span>        <span class="ResWord">def</span> <span class="ID">__get__</span>(<span class="ResWord">self</span>, <span class="ID">instance</span>, <span class="ID">klass</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_15">  15</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_15"></span><span class="anchor" id="line-15-34"></span>            <span class="ResWord">if</span> <span class="ID">instance</span> <span class="ResWord">is</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_16">  16</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_16"></span><span class="anchor" id="line-16-34"></span>                <span class="Comment"># Class method was requested</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_17">  17</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_17"></span><span class="anchor" id="line-17-33"></span>                <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">make_unbound</span>(<span class="ID">klass</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_18">  18</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_18"></span><span class="anchor" id="line-18-33"></span>            <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">make_bound</span>(<span class="ID">instance</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_19">  19</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_19"></span><span class="anchor" id="line-19-32"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_20">  20</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_20"></span><span class="anchor" id="line-20-31"></span>        <span class="ResWord">def</span> <span class="ID">make_unbound</span>(<span class="ResWord">self</span>, <span class="ID">klass</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_21">  21</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_21"></span><span class="anchor" id="line-21-31"></span>            <span class="ID">@wraps</span>(<span class="ResWord">self</span>.<span class="ID">f</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_22">  22</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_22"></span><span class="anchor" id="line-22-31"></span>            <span class="ResWord">def</span> <span class="ID">wrapper</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_23">  23</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_23"></span><span class="anchor" id="line-23-31"></span>                <span class="String">'''This documentation will vanish :)'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_24">  24</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_24"></span><span class="anchor" id="line-24-28"></span>                <span class="ResWord">raise</span> <span class="ID">TypeError</span>(</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_25">  25</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_25"></span><span class="anchor" id="line-25-28"></span>                    <span class="String">'</span><span class="String">unbound method {}() must be called with {} instance </span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_26">  26</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_26"></span><span class="anchor" id="line-26-26"></span>                    <span class="String">'</span><span class="String">as first argument (got nothing instead)</span><span class="String">'</span>.<span class="ID">format</span>(</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_27">  27</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_27"></span><span class="anchor" id="line-27-23"></span>                        <span class="ResWord">self</span>.<span class="ID">f</span>.<span class="ID">__name__</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_28">  28</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_28"></span><span class="anchor" id="line-28-21"></span>                        <span class="ID">klass</span>.<span class="ID">__name__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_29">  29</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_29"></span><span class="anchor" id="line-29-20"></span>                )</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_30">  30</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_30"></span><span class="anchor" id="line-30-18"></span>            <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_31">  31</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_31"></span><span class="anchor" id="line-31-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_32">  32</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_32"></span><span class="anchor" id="line-32-17"></span>        <span class="ResWord">def</span> <span class="ID">make_bound</span>(<span class="ResWord">self</span>, <span class="ID">instance</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_33">  33</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_33"></span><span class="anchor" id="line-33-17"></span>            <span class="ID">@wraps</span>(<span class="ResWord">self</span>.<span class="ID">f</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_34">  34</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_34"></span><span class="anchor" id="line-34-16"></span>            <span class="ResWord">def</span> <span class="ID">wrapper</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_35">  35</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_35"></span><span class="anchor" id="line-35-16"></span>                <span class="String">'''This documentation will disapear :)'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_36">  36</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_36"></span><span class="anchor" id="line-36-16"></span>                <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Called the decorated method {} of {}</span><span class="String">&quot;</span>.<span class="ID">format</span>(<span class="ResWord">self</span>.<span class="ID">f</span>.<span class="ID">__name__</span>, <span class="ID">instance</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_37">  37</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_37"></span><span class="anchor" id="line-37-16"></span>                <span class="ResWord">return</span> <span class="ResWord">self</span>.<span class="ID">f</span>(<span class="ID">instance</span>, *<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_38">  38</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_38"></span><span class="anchor" id="line-38-15"></span>            <span class="Comment"># This instance does not need the descriptor anymore,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_39">  39</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_39"></span><span class="anchor" id="line-39-15"></span>            <span class="Comment"># let it find the wrapper directly next time:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_40">  40</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_40"></span><span class="anchor" id="line-40-15"></span>            <span class="ResWord">setattr</span>(<span class="ID">instance</span>, <span class="ResWord">self</span>.<span class="ID">f</span>.<span class="ID">__name__</span>, <span class="ID">wrapper</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_41">  41</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_41"></span><span class="anchor" id="line-41-13"></span>            <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_42">  42</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_42"></span><span class="anchor" id="line-42-11"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-1f74040af898602b483f2d7691d29b4a5644cce2_43">  43</a> </span><span class="LineAnchor" id="CA-1f74040af898602b483f2d7691d29b4a5644cce2_43"></span><span class="anchor" id="line-43-11"></span>    <span class="ResWord">return</span> <span class="ID">descript</span>(<span class="ID">f</span>)</span>
</pre></div></div><span class="anchor" id="line-2027"></span><p class="line874">This implementation replaces the descriptor by the actual decorated function ASAP to avoid overhead, but you could keep it to do even more (counting calls, etc...) <span class="anchor" id="line-2028"></span><span class="anchor" id="line-2029"></span><p class="line867">
<h2 id="Another_Retrying_Decorator">Another Retrying Decorator</h2>
<span class="anchor" id="line-2030"></span><p class="line874">Here's another decorator for causing a function to be retried a certain number of times. This decorator is superior IMHO because it should work with any old function that raises an exception on failure. <span class="anchor" id="line-2031"></span><span class="anchor" id="line-2032"></span><p class="line874">Features: <span class="anchor" id="line-2033"></span><span class="anchor" id="line-2034"></span><ul><li>Works with any function that signals failure by raising an exception (I.E. just about any function) <span class="anchor" id="line-2035"></span></li><li>Supports retry delay and backoff <span class="anchor" id="line-2036"></span></li><li><p class="line862">User can specify which exceptions are caught for retrying. E.g. networking code might be expected to raise <a class="nonexistent" href="/moin/SocketError">SocketError</a> in the event of communications difficulties, while any other exception likely indicates a bug in the code. <span class="anchor" id="line-2037"></span></li><li>Hook for custom logging <span class="anchor" id="line-2038"></span><span class="anchor" id="line-2039"></span></li></ul><p class="line862">GIST: <a class="https" href="https://gist.github.com/2570004">https://gist.github.com/2570004</a> <span class="anchor" id="line-2040"></span><span class="anchor" id="line-2041"></span><p class="line867"><span class="anchor" id="line-2042"></span><span class="anchor" id="line-2043"></span><span class="anchor" id="line-2044"></span><span class="anchor" id="line-2045"></span><span class="anchor" id="line-2046"></span><span class="anchor" id="line-2047"></span><span class="anchor" id="line-2048"></span><span class="anchor" id="line-2049"></span><span class="anchor" id="line-2050"></span><span class="anchor" id="line-2051"></span><span class="anchor" id="line-2052"></span><span class="anchor" id="line-2053"></span><span class="anchor" id="line-2054"></span><span class="anchor" id="line-2055"></span><span class="anchor" id="line-2056"></span><span class="anchor" id="line-2057"></span><span class="anchor" id="line-2058"></span><span class="anchor" id="line-2059"></span><span class="anchor" id="line-2060"></span><span class="anchor" id="line-2061"></span><span class="anchor" id="line-2062"></span><span class="anchor" id="line-2063"></span><span class="anchor" id="line-2064"></span><span class="anchor" id="line-2065"></span><span class="anchor" id="line-2066"></span><span class="anchor" id="line-2067"></span><span class="anchor" id="line-2068"></span><span class="anchor" id="line-2069"></span><span class="anchor" id="line-2070"></span><span class="anchor" id="line-2071"></span><span class="anchor" id="line-2072"></span><span class="anchor" id="line-2073"></span><span class="anchor" id="line-2074"></span><span class="anchor" id="line-2075"></span><span class="anchor" id="line-2076"></span><span class="anchor" id="line-2077"></span><span class="anchor" id="line-2078"></span><span class="anchor" id="line-2079"></span><span class="anchor" id="line-2080"></span><span class="anchor" id="line-2081"></span><span class="anchor" id="line-2082"></span><span class="anchor" id="line-2083"></span><span class="anchor" id="line-2084"></span><span class="anchor" id="line-2085"></span><span class="anchor" id="line-2086"></span><span class="anchor" id="line-2087"></span><span class="anchor" id="line-2088"></span><span class="anchor" id="line-2089"></span><span class="anchor" id="line-2090"></span><span class="anchor" id="line-2091"></span><span class="anchor" id="line-2092"></span><span class="anchor" id="line-2093"></span><span class="anchor" id="line-2094"></span><span class="anchor" id="line-2095"></span><span class="anchor" id="line-2096"></span><span class="anchor" id="line-2097"></span><span class="anchor" id="line-2098"></span><span class="anchor" id="line-2099"></span><span class="anchor" id="line-2100"></span><span class="anchor" id="line-2101"></span><span class="anchor" id="line-2102"></span><span class="anchor" id="line-2103"></span><span class="anchor" id="line-2104"></span><span class="anchor" id="line-2105"></span><span class="anchor" id="line-2106"></span><span class="anchor" id="line-2107"></span><span class="anchor" id="line-2108"></span><span class="anchor" id="line-2109"></span><span class="anchor" id="line-2110"></span><span class="anchor" id="line-2111"></span><span class="anchor" id="line-2112"></span><span class="anchor" id="line-2113"></span><span class="anchor" id="line-2114"></span><span class="anchor" id="line-2115"></span><span class="anchor" id="line-2116"></span><span class="anchor" id="line-2117"></span><span class="anchor" id="line-2118"></span><span class="anchor" id="line-2119"></span><span class="anchor" id="line-2120"></span><span class="anchor" id="line-1-79"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-f2e727a456f87645ea4bd16da0195a9b25a72159\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_1">   1</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_1"></span><span class="anchor" id="line-1-80"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_2">   2</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_2"></span><span class="anchor" id="line-2-40"></span><span class="Comment"># Copyright 2012 by Jeff Laughlin Consulting LLC</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_3">   3</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_3"></span><span class="anchor" id="line-3-40"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_4">   4</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_4"></span><span class="anchor" id="line-4-39"></span><span class="Comment"># Permission is hereby granted, free of charge, to any person obtaining a copy</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_5">   5</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_5"></span><span class="anchor" id="line-5-39"></span><span class="Comment"># of this software and associated documentation files (the &quot;Software&quot;), to deal</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_6">   6</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_6"></span><span class="anchor" id="line-6-39"></span><span class="Comment"># in the Software without restriction, including without limitation the rights</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_7">   7</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_7"></span><span class="anchor" id="line-7-39"></span><span class="Comment"># to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_8">   8</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_8"></span><span class="anchor" id="line-8-38"></span><span class="Comment"># copies of the Software, and to permit persons to whom the Software is</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_9">   9</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_9"></span><span class="anchor" id="line-9-38"></span><span class="Comment"># furnished to do so, subject to the following conditions:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_10">  10</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_10"></span><span class="anchor" id="line-10-38"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_11">  11</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_11"></span><span class="anchor" id="line-11-36"></span><span class="Comment"># The above copyright notice and this permission notice shall be included in</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_12">  12</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_12"></span><span class="anchor" id="line-12-36"></span><span class="Comment"># all copies or substantial portions of the Software.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_13">  13</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_13"></span><span class="anchor" id="line-13-35"></span><span class="Comment">#</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_14">  14</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_14"></span><span class="anchor" id="line-14-35"></span><span class="Comment"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_15">  15</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_15"></span><span class="anchor" id="line-15-35"></span><span class="Comment"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_16">  16</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_16"></span><span class="anchor" id="line-16-35"></span><span class="Comment"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_17">  17</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_17"></span><span class="anchor" id="line-17-34"></span><span class="Comment"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_18">  18</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_18"></span><span class="anchor" id="line-18-34"></span><span class="Comment"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_19">  19</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_19"></span><span class="anchor" id="line-19-33"></span><span class="Comment"># OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_20">  20</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_20"></span><span class="anchor" id="line-20-32"></span><span class="Comment"># SOFTWARE.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_21">  21</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_21"></span><span class="anchor" id="line-21-32"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_22">  22</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_22"></span><span class="anchor" id="line-22-32"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_23">  23</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_23"></span><span class="anchor" id="line-23-32"></span><span class="ResWord">import</span> <span class="ID">sys</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_24">  24</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_24"></span><span class="anchor" id="line-24-29"></span><span class="ResWord">from</span> <span class="ID">time</span> <span class="ResWord">import</span> <span class="ID">sleep</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_25">  25</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_25"></span><span class="anchor" id="line-25-29"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_26">  26</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_26"></span><span class="anchor" id="line-26-27"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_27">  27</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_27"></span><span class="anchor" id="line-27-24"></span><span class="ResWord">def</span> <span class="ID">example_exc_handler</span>(<span class="ID">tries_remaining</span>, <span class="ID">exception</span>, <span class="ID">delay</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_28">  28</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_28"></span><span class="anchor" id="line-28-22"></span>    <span class="String">&quot;&quot;&quot;Example exception handler; prints a warning to stderr.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_29">  29</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_29"></span><span class="anchor" id="line-29-21"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_30">  30</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_30"></span><span class="anchor" id="line-30-19"></span><span class="String">    tries_remaining: The number of tries remaining.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_31">  31</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_31"></span><span class="anchor" id="line-31-18"></span><span class="String">    exception: The exception instance which was raised.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_32">  32</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_32"></span><span class="anchor" id="line-32-18"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_33">  33</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_33"></span><span class="anchor" id="line-33-18"></span>    <span class="ResWord">print</span> &gt;&gt; <span class="ID">sys</span>.<span class="ID">stderr</span>, <span class="String">&quot;</span><span class="String">Caught </span><span class="String">'</span><span class="String">%s</span><span class="String">'</span><span class="String">, </span><span class="String">%d</span><span class="String"> tries remaining, sleeping for </span><span class="String">%s</span><span class="String"> seconds</span><span class="String">&quot;</span> % (<span class="ID">exception</span>, <span class="ID">tries_remaining</span>, <span class="ID">delay</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_34">  34</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_34"></span><span class="anchor" id="line-34-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_35">  35</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_35"></span><span class="anchor" id="line-35-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_36">  36</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_36"></span><span class="anchor" id="line-36-17"></span><span class="ResWord">def</span> <span class="ID">retries</span>(<span class="ID">max_tries</span>, <span class="ID">delay</span>=<span class="Number">1</span>, <span class="ID">backoff</span>=<span class="Number">2</span>, <span class="ID">exceptions</span>=(<span class="ID">Exception</span>,), <span class="ID">hook</span>=<span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_37">  37</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_37"></span><span class="anchor" id="line-37-17"></span>    <span class="String">&quot;&quot;&quot;Function decorator implementing retrying logic.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_38">  38</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_38"></span><span class="anchor" id="line-38-16"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_39">  39</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_39"></span><span class="anchor" id="line-39-16"></span><span class="String">    delay: Sleep this many seconds * backoff * try number after failure</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_40">  40</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_40"></span><span class="anchor" id="line-40-16"></span><span class="String">    backoff: Multiply delay by this factor after each failure</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_41">  41</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_41"></span><span class="anchor" id="line-41-14"></span><span class="String">    exceptions: A tuple of exception classes; default (Exception,)</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_42">  42</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_42"></span><span class="anchor" id="line-42-12"></span><span class="String">    hook: A function with the signature myhook(tries_remaining, exception);</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_43">  43</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_43"></span><span class="anchor" id="line-43-12"></span><span class="String">          default None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_44">  44</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_44"></span><span class="anchor" id="line-44-11"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_45">  45</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_45"></span><span class="anchor" id="line-45-11"></span><span class="String">    The decorator will call the function up to max_tries times if it raises</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_46">  46</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_46"></span><span class="anchor" id="line-46-11"></span><span class="String">    an exception.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_47">  47</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_47"></span><span class="anchor" id="line-47-11"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_48">  48</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_48"></span><span class="anchor" id="line-48-10"></span><span class="String">    By default it catches instances of the Exception class and subclasses.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_49">  49</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_49"></span><span class="anchor" id="line-49-10"></span><span class="String">    This will recover after all but the most fatal errors. You may specify a</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_50">  50</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_50"></span><span class="anchor" id="line-50-9"></span><span class="String">    custom tuple of exception classes with the 'exceptions' argument; the</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_51">  51</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_51"></span><span class="anchor" id="line-51-9"></span><span class="String">    function will only be retried if it raises one of the specified</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_52">  52</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_52"></span><span class="anchor" id="line-52-9"></span><span class="String">    exceptions.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_53">  53</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_53"></span><span class="anchor" id="line-53-9"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_54">  54</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_54"></span><span class="anchor" id="line-54-9"></span><span class="String">    Additionally you may specify a hook function which will be called prior</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_55">  55</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_55"></span><span class="anchor" id="line-55-9"></span><span class="String">    to retrying with the number of remaining tries and the exception instance;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_56">  56</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_56"></span><span class="anchor" id="line-56-9"></span><span class="String">    see given example. This is primarily intended to give the opportunity to</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_57">  57</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_57"></span><span class="anchor" id="line-57-9"></span><span class="String">    log the failure. Hook is not called after failure if no retries remain.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_58">  58</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_58"></span><span class="anchor" id="line-58-9"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_59">  59</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_59"></span><span class="anchor" id="line-59-9"></span>    <span class="ResWord">def</span> <span class="ID">dec</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_60">  60</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_60"></span><span class="anchor" id="line-60-9"></span>        <span class="ResWord">def</span> <span class="ID">f2</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_61">  61</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_61"></span><span class="anchor" id="line-61-9"></span>            <span class="ID">mydelay</span> = <span class="ID">delay</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_62">  62</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_62"></span><span class="anchor" id="line-62-8"></span>            <span class="ID">tries</span> = <span class="ResWord">range</span>(<span class="ID">max_tries</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_63">  63</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_63"></span><span class="anchor" id="line-63-8"></span>            <span class="ID">tries</span>.<span class="ID">reverse</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_64">  64</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_64"></span><span class="anchor" id="line-64-8"></span>            <span class="ResWord">for</span> <span class="ID">tries_remaining</span> <span class="ResWord">in</span> <span class="ID">tries</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_65">  65</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_65"></span><span class="anchor" id="line-65-8"></span>                <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_66">  66</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_66"></span><span class="anchor" id="line-66-8"></span>                   <span class="ResWord">return</span> <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_67">  67</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_67"></span><span class="anchor" id="line-67-8"></span>                <span class="ResWord">except</span> <span class="ID">exceptions</span> <span class="ResWord">as</span> <span class="ID">e</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_68">  68</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_68"></span><span class="anchor" id="line-68-8"></span>                    <span class="ResWord">if</span> <span class="ID">tries_remaining</span> &gt; <span class="Number">0</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_69">  69</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_69"></span><span class="anchor" id="line-69-7"></span>                        <span class="ResWord">if</span> <span class="ID">hook</span> <span class="ResWord">is</span> <span class="ResWord">not</span> <span class="ResWord">None</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_70">  70</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_70"></span><span class="anchor" id="line-70-7"></span>                            <span class="ID">hook</span>(<span class="ID">tries_remaining</span>, <span class="ID">e</span>, <span class="ID">mydelay</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_71">  71</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_71"></span><span class="anchor" id="line-71-7"></span>                        <span class="ID">sleep</span>(<span class="ID">mydelay</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_72">  72</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_72"></span><span class="anchor" id="line-72-7"></span>                        <span class="ID">mydelay</span> = <span class="ID">mydelay</span> * <span class="ID">backoff</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_73">  73</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_73"></span><span class="anchor" id="line-73-7"></span>                    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_74">  74</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_74"></span><span class="anchor" id="line-74-7"></span>                        <span class="ResWord">raise</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_75">  75</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_75"></span><span class="anchor" id="line-75-7"></span>                <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_76">  76</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_76"></span><span class="anchor" id="line-76-7"></span>                    <span class="ResWord">break</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_77">  77</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_77"></span><span class="anchor" id="line-77-7"></span>        <span class="ResWord">return</span> <span class="ID">f2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f2e727a456f87645ea4bd16da0195a9b25a72159_78">  78</a> </span><span class="LineAnchor" id="CA-f2e727a456f87645ea4bd16da0195a9b25a72159_78"></span><span class="anchor" id="line-78-7"></span>    <span class="ResWord">return</span> <span class="ID">dec</span></span>
</pre></div></div><span class="anchor" id="line-2121"></span><p class="line867">
<h2 id="Logging_decorator_with_specified_logger_.28or_default.29">Logging decorator with specified logger (or default)</h2>
<span class="anchor" id="line-2122"></span><p class="line874">This decorator will log entry and exit points of your funtion using the specified logger or it defaults to your function's module name logger. <span class="anchor" id="line-2123"></span><span class="anchor" id="line-2124"></span><p class="line874">In the current form it uses the logging.INFO level, but I can easily customized to use what ever level. Same for the entry and exit messages. <span class="anchor" id="line-2125"></span><span class="anchor" id="line-2126"></span><p class="line867"><span class="anchor" id="line-2127"></span><span class="anchor" id="line-2128"></span><span class="anchor" id="line-2129"></span><span class="anchor" id="line-2130"></span><span class="anchor" id="line-2131"></span><span class="anchor" id="line-2132"></span><span class="anchor" id="line-2133"></span><span class="anchor" id="line-2134"></span><span class="anchor" id="line-2135"></span><span class="anchor" id="line-2136"></span><span class="anchor" id="line-2137"></span><span class="anchor" id="line-2138"></span><span class="anchor" id="line-2139"></span><span class="anchor" id="line-2140"></span><span class="anchor" id="line-2141"></span><span class="anchor" id="line-2142"></span><span class="anchor" id="line-2143"></span><span class="anchor" id="line-2144"></span><span class="anchor" id="line-2145"></span><span class="anchor" id="line-2146"></span><span class="anchor" id="line-2147"></span><span class="anchor" id="line-2148"></span><span class="anchor" id="line-2149"></span><span class="anchor" id="line-2150"></span><span class="anchor" id="line-2151"></span><span class="anchor" id="line-2152"></span><span class="anchor" id="line-2153"></span><span class="anchor" id="line-2154"></span><span class="anchor" id="line-2155"></span><span class="anchor" id="line-2156"></span><span class="anchor" id="line-2157"></span><span class="anchor" id="line-2158"></span><span class="anchor" id="line-2159"></span><span class="anchor" id="line-2160"></span><span class="anchor" id="line-2161"></span><span class="anchor" id="line-2162"></span><span class="anchor" id="line-1-81"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_1">   1</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_1"></span><span class="anchor" id="line-1-82"></span><span class="ResWord">import</span> <span class="ID">functools</span>, <span class="ID">logging</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_2">   2</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_2"></span><span class="anchor" id="line-2-41"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_3">   3</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_3"></span><span class="anchor" id="line-3-41"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_4">   4</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_4"></span><span class="anchor" id="line-4-40"></span><span class="ID">log</span> = <span class="ID">logging</span>.<span class="ID">getLogger</span>(<span class="ID">__name__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_5">   5</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_5"></span><span class="anchor" id="line-5-40"></span><span class="ID">log</span>.<span class="ID">setLevel</span>(<span class="ID">logging</span>.<span class="ID">DEBUG</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_6">   6</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_6"></span><span class="anchor" id="line-6-40"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_7">   7</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_7"></span><span class="anchor" id="line-7-40"></span><span class="ResWord">class</span> <span class="ID">log_with</span>(<span class="ResWord">object</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_8">   8</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_8"></span><span class="anchor" id="line-8-39"></span>    <span class="String">'''Logging decorator that allows you to log with a</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_9">   9</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_9"></span><span class="anchor" id="line-9-39"></span><span class="String">specific logger.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_10">  10</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_10"></span><span class="anchor" id="line-10-39"></span><span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_11">  11</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_11"></span><span class="anchor" id="line-11-37"></span>    <span class="Comment"># Customize these messages</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_12">  12</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_12"></span><span class="anchor" id="line-12-37"></span>    <span class="ID">ENTRY_MESSAGE</span> = <span class="String">'</span><span class="String">Entering {}</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_13">  13</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_13"></span><span class="anchor" id="line-13-36"></span>    <span class="ID">EXIT_MESSAGE</span> = <span class="String">'</span><span class="String">Exiting {}</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_14">  14</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_14"></span><span class="anchor" id="line-14-36"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_15">  15</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_15"></span><span class="anchor" id="line-15-36"></span>    <span class="ResWord">def</span> <span class="ID">__init__</span>(<span class="ResWord">self</span>, <span class="ID">logger</span>=<span class="ResWord">None</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_16">  16</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_16"></span><span class="anchor" id="line-16-36"></span>        <span class="ResWord">self</span>.<span class="ID">logger</span> = <span class="ID">logger</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_17">  17</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_17"></span><span class="anchor" id="line-17-35"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_18">  18</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_18"></span><span class="anchor" id="line-18-35"></span>    <span class="ResWord">def</span> <span class="ID">__call__</span>(<span class="ResWord">self</span>, <span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_19">  19</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_19"></span><span class="anchor" id="line-19-34"></span>        <span class="String">'''Returns a wrapper that wraps func.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_20">  20</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_20"></span><span class="anchor" id="line-20-33"></span><span class="String">The wrapper will log the entry and exit points of the function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_21">  21</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_21"></span><span class="anchor" id="line-21-33"></span><span class="String">with logging.INFO level.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_22">  22</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_22"></span><span class="anchor" id="line-22-33"></span><span class="String">'''</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_23">  23</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_23"></span><span class="anchor" id="line-23-33"></span>        <span class="Comment"># set logger if it was not set earlier</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_24">  24</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_24"></span><span class="anchor" id="line-24-30"></span>        <span class="ResWord">if</span> <span class="ResWord">not</span> <span class="ResWord">self</span>.<span class="ID">logger</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_25">  25</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_25"></span><span class="anchor" id="line-25-30"></span>            <span class="ID">logging</span>.<span class="ID">basicConfig</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_26">  26</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_26"></span><span class="anchor" id="line-26-28"></span>            <span class="ResWord">self</span>.<span class="ID">logger</span> = <span class="ID">logging</span>.<span class="ID">getLogger</span>(<span class="ID">func</span>.<span class="ID">__module__</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_27">  27</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_27"></span><span class="anchor" id="line-27-25"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_28">  28</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_28"></span><span class="anchor" id="line-28-23"></span>        <span class="ID">@functools.wraps</span>(<span class="ID">func</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_29">  29</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_29"></span><span class="anchor" id="line-29-22"></span>        <span class="ResWord">def</span> <span class="ID">wrapper</span>(*<span class="ID">args</span>, **<span class="ID">kwds</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_30">  30</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_30"></span><span class="anchor" id="line-30-20"></span>            <span class="ResWord">self</span>.<span class="ID">logger</span>.<span class="ID">info</span>(<span class="ResWord">self</span>.<span class="ID">ENTRY_MESSAGE</span>.<span class="ID">format</span>(<span class="ID">func</span>.<span class="ID">__name__</span>))  <span class="Comment"># logging level .info(). Set to .debug() if you want to</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_31">  31</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_31"></span><span class="anchor" id="line-31-19"></span>            <span class="ID">f_result</span> = <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwds</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_32">  32</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_32"></span><span class="anchor" id="line-32-19"></span>            <span class="ResWord">self</span>.<span class="ID">logger</span>.<span class="ID">info</span>(<span class="ResWord">self</span>.<span class="ID">EXIT_MESSAGE</span>.<span class="ID">format</span>(<span class="ID">func</span>.<span class="ID">__name__</span>))   <span class="Comment"># logging level .info(). Set to .debug() if you want to</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_33">  33</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_33"></span><span class="anchor" id="line-33-19"></span>            <span class="ResWord">return</span> <span class="ID">f_result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_34">  34</a> </span><span class="LineAnchor" id="CA-c1ed8786b9a3c10be3bb9a82ef9c5e95fb72e873_34"></span><span class="anchor" id="line-34-18"></span>        <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
</pre></div></div><span class="anchor" id="line-2163"></span><p class="line867"><span class="anchor" id="line-2164"></span><span class="anchor" id="line-2165"></span><span class="anchor" id="line-2166"></span><span class="anchor" id="line-2167"></span><span class="anchor" id="line-2168"></span><span class="anchor" id="line-2169"></span><span class="anchor" id="line-2170"></span><span class="anchor" id="line-2171"></span><span class="anchor" id="line-2172"></span><span class="anchor" id="line-2173"></span><span class="anchor" id="line-2174"></span><span class="anchor" id="line-2175"></span><span class="anchor" id="line-2176"></span><span class="anchor" id="line-2177"></span><span class="anchor" id="line-2178"></span><span class="anchor" id="line-2179"></span><span class="anchor" id="line-2180"></span><span class="anchor" id="line-2181"></span><span class="anchor" id="line-1-83"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_1">   1</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_1"></span><span class="anchor" id="line-1-84"></span><span class="Comment"># Sample use and output:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_2">   2</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_2"></span><span class="anchor" id="line-2-42"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_3">   3</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_3"></span><span class="anchor" id="line-3-42"></span><span class="ResWord">if</span> <span class="ID">__name__</span> == <span class="String">'</span><span class="String">__main__</span><span class="String">'</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_4">   4</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_4"></span><span class="anchor" id="line-4-41"></span>    <span class="ID">logging</span>.<span class="ID">basicConfig</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_5">   5</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_5"></span><span class="anchor" id="line-5-41"></span>    <span class="ID">log</span> = <span class="ID">logging</span>.<span class="ID">getLogger</span>(<span class="String">'</span><span class="String">custom_log</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_6">   6</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_6"></span><span class="anchor" id="line-6-41"></span>    <span class="ID">log</span>.<span class="ID">setLevel</span>(<span class="ID">logging</span>.<span class="ID">DEBUG</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_7">   7</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_7"></span><span class="anchor" id="line-7-41"></span>    <span class="ID">log</span>.<span class="ID">info</span>(<span class="String">'</span><span class="String">ciao</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_8">   8</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_8"></span><span class="anchor" id="line-8-40"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_9">   9</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_9"></span><span class="anchor" id="line-9-40"></span>    <span class="ID">@log_with</span>(<span class="ID">log</span>)     <span class="Comment"># user specified logger</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_10">  10</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_10"></span><span class="anchor" id="line-10-40"></span>    <span class="ResWord">def</span> <span class="ID">foo</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_11">  11</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_11"></span><span class="anchor" id="line-11-38"></span>        <span class="ResWord">print</span> <span class="String">'</span><span class="String">this is foo</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_12">  12</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_12"></span><span class="anchor" id="line-12-38"></span>    <span class="ID">foo</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_13">  13</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_13"></span><span class="anchor" id="line-13-37"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_14">  14</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_14"></span><span class="anchor" id="line-14-37"></span>    <span class="ID">@log_with</span>()        <span class="Comment"># using default logger</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_15">  15</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_15"></span><span class="anchor" id="line-15-37"></span>    <span class="ResWord">def</span> <span class="ID">foo2</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_16">  16</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_16"></span><span class="anchor" id="line-16-37"></span>        <span class="ResWord">print</span> <span class="String">'</span><span class="String">this is foo2</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_17">  17</a> </span><span class="LineAnchor" id="CA-e203b8bea3f0ff44476febd6f774a747f0eb63f5_17"></span><span class="anchor" id="line-17-36"></span>    <span class="ID">foo2</span>()</span>
</pre></div></div><span class="anchor" id="line-2182"></span><p class="line867"><span class="anchor" id="line-2183"></span><span class="anchor" id="line-2184"></span><span class="anchor" id="line-2185"></span><span class="anchor" id="line-2186"></span><span class="anchor" id="line-2187"></span><span class="anchor" id="line-2188"></span><span class="anchor" id="line-2189"></span><span class="anchor" id="line-2190"></span><span class="anchor" id="line-2191"></span><span class="anchor" id="line-2192"></span><span class="anchor" id="line-2193"></span><span class="anchor" id="line-1-85"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e8160e64065de25d4fe577653a9c7af7d012b737\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_1">   1</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_1"></span><span class="anchor" id="line-1-86"></span><span class="Comment"># output</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_2">   2</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_2"></span><span class="anchor" id="line-2-43"></span>&gt;&gt;&gt; ================================ <span class="ID">RESTART</span> ================================</span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_3">   3</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_3"></span><span class="anchor" id="line-3-43"></span>&gt;&gt;&gt;</span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_4">   4</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_4"></span><span class="anchor" id="line-4-42"></span><span class="ID">INFO</span>:<span class="ID">custom_log</span>:<span class="ID">ciao</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_5">   5</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_5"></span><span class="anchor" id="line-5-42"></span><span class="ID">INFO</span>:<span class="ID">custom_log</span>:<span class="ID">Entering</span> <span class="ID">foo</span> <span class="Comment"># uses the correct logger</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_6">   6</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_6"></span><span class="anchor" id="line-6-42"></span><span class="ID">this</span> <span class="ResWord">is</span> <span class="ID">foo</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_7">   7</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_7"></span><span class="anchor" id="line-7-42"></span><span class="ID">INFO</span>:<span class="ID">custom_log</span>:<span class="ID">Exiting</span> <span class="ID">foo</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_8">   8</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_8"></span><span class="anchor" id="line-8-41"></span><span class="ID">INFO</span>:<span class="ID">__main__</span>:<span class="ID">Entering</span> <span class="ID">foo2</span>  <span class="Comment"># uses the correct logger</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_9">   9</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_9"></span><span class="anchor" id="line-9-41"></span><span class="ID">this</span> <span class="ResWord">is</span> <span class="ID">foo2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e8160e64065de25d4fe577653a9c7af7d012b737_10">  10</a> </span><span class="LineAnchor" id="CA-e8160e64065de25d4fe577653a9c7af7d012b737_10"></span><span class="anchor" id="line-10-41"></span><span class="ID">INFO</span>:<span class="ID">__main__</span>:<span class="ID">Exiting</span> <span class="ID">foo2</span></span>
</pre></div></div><span class="anchor" id="line-2194"></span><p class="line867">
<h2 id="Lazy_Thunkify">Lazy Thunkify</h2>
<span class="anchor" id="line-2195"></span><p class="line874">This decorator will cause any function to, instead of running its code, start a thread to run the code, returning a thunk (function with no args) that wait for the function's completion and returns the value (or raises the exception). <span class="anchor" id="line-2196"></span><span class="anchor" id="line-2197"></span><p class="line874">Useful if you have Computation A that takes x seconds and then uses Computation B, which takes y seconds. Instead of x+y seconds you only need max(x,y) seconds. <span class="anchor" id="line-2198"></span><span class="anchor" id="line-2199"></span><p class="line867"><span class="anchor" id="line-2200"></span><span class="anchor" id="line-2201"></span><span class="anchor" id="line-2202"></span><span class="anchor" id="line-2203"></span><span class="anchor" id="line-2204"></span><span class="anchor" id="line-2205"></span><span class="anchor" id="line-2206"></span><span class="anchor" id="line-2207"></span><span class="anchor" id="line-2208"></span><span class="anchor" id="line-2209"></span><span class="anchor" id="line-2210"></span><span class="anchor" id="line-2211"></span><span class="anchor" id="line-2212"></span><span class="anchor" id="line-2213"></span><span class="anchor" id="line-2214"></span><span class="anchor" id="line-2215"></span><span class="anchor" id="line-2216"></span><span class="anchor" id="line-2217"></span><span class="anchor" id="line-2218"></span><span class="anchor" id="line-2219"></span><span class="anchor" id="line-2220"></span><span class="anchor" id="line-2221"></span><span class="anchor" id="line-2222"></span><span class="anchor" id="line-2223"></span><span class="anchor" id="line-2224"></span><span class="anchor" id="line-2225"></span><span class="anchor" id="line-2226"></span><span class="anchor" id="line-2227"></span><span class="anchor" id="line-2228"></span><span class="anchor" id="line-2229"></span><span class="anchor" id="line-2230"></span><span class="anchor" id="line-2231"></span><span class="anchor" id="line-2232"></span><span class="anchor" id="line-2233"></span><span class="anchor" id="line-2234"></span><span class="anchor" id="line-2235"></span><span class="anchor" id="line-2236"></span><span class="anchor" id="line-2237"></span><span class="anchor" id="line-1-87"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_1">   1</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_1"></span><span class="anchor" id="line-1-88"></span><span class="ResWord">import</span> <span class="ID">threading</span>, <span class="ID">sys</span>, <span class="ID">functools</span>, <span class="ID">traceback</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_2">   2</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_2"></span><span class="anchor" id="line-2-44"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_3">   3</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_3"></span><span class="anchor" id="line-3-44"></span><span class="ResWord">def</span> <span class="ID">lazy_thunkify</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_4">   4</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_4"></span><span class="anchor" id="line-4-43"></span>    <span class="String">&quot;&quot;&quot;Make a function immediately return a function of no args which, when called,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_5">   5</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_5"></span><span class="anchor" id="line-5-43"></span><span class="String">    waits for the result, which will start being processed in another thread.&quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_6">   6</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_6"></span><span class="anchor" id="line-6-43"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_7">   7</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_7"></span><span class="anchor" id="line-7-43"></span>    <span class="ID">@functools.wraps</span>(<span class="ID">f</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_8">   8</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_8"></span><span class="anchor" id="line-8-42"></span>    <span class="ResWord">def</span> <span class="ID">lazy_thunked</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_9">   9</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_9"></span><span class="anchor" id="line-9-42"></span>        <span class="ID">wait_event</span> = <span class="ID">threading</span>.<span class="ID">Event</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_10">  10</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_10"></span><span class="anchor" id="line-10-42"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_11">  11</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_11"></span><span class="anchor" id="line-11-39"></span>        <span class="ID">result</span> = [<span class="ResWord">None</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_12">  12</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_12"></span><span class="anchor" id="line-12-39"></span>        <span class="ID">exc</span> = [<span class="ResWord">False</span>, <span class="ResWord">None</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_13">  13</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_13"></span><span class="anchor" id="line-13-38"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_14">  14</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_14"></span><span class="anchor" id="line-14-38"></span>        <span class="ResWord">def</span> <span class="ID">worker_func</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_15">  15</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_15"></span><span class="anchor" id="line-15-38"></span>            <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_16">  16</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_16"></span><span class="anchor" id="line-16-38"></span>                <span class="ID">func_result</span> = <span class="ID">f</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_17">  17</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_17"></span><span class="anchor" id="line-17-37"></span>                <span class="ID">result</span>[<span class="Number">0</span>] = <span class="ID">func_result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_18">  18</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_18"></span><span class="anchor" id="line-18-36"></span>            <span class="ResWord">except</span> <span class="ID">Exception</span>, <span class="ID">e</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_19">  19</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_19"></span><span class="anchor" id="line-19-35"></span>                <span class="ID">exc</span>[<span class="Number">0</span>] = <span class="ResWord">True</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_20">  20</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_20"></span><span class="anchor" id="line-20-34"></span>                <span class="ID">exc</span>[<span class="Number">1</span>] = <span class="ID">sys</span>.<span class="ID">exc_info</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_21">  21</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_21"></span><span class="anchor" id="line-21-34"></span>                <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Lazy thunk has thrown an exception (will be raised on thunk()):</span><span class="SPChar">\n</span><span class="String">%s</span><span class="String">&quot;</span> % (</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_22">  22</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_22"></span><span class="anchor" id="line-22-34"></span>                    <span class="ID">traceback</span>.<span class="ID">format_exc</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_23">  23</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_23"></span><span class="anchor" id="line-23-34"></span>            <span class="ResWord">finally</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_24">  24</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_24"></span><span class="anchor" id="line-24-31"></span>                <span class="ID">wait_event</span>.<span class="ID">set</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_25">  25</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_25"></span><span class="anchor" id="line-25-31"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_26">  26</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_26"></span><span class="anchor" id="line-26-29"></span>        <span class="ResWord">def</span> <span class="ID">thunk</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_27">  27</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_27"></span><span class="anchor" id="line-27-26"></span>            <span class="ID">wait_event</span>.<span class="ID">wait</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_28">  28</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_28"></span><span class="anchor" id="line-28-24"></span>            <span class="ResWord">if</span> <span class="ID">exc</span>[<span class="Number">0</span>]:</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_29">  29</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_29"></span><span class="anchor" id="line-29-23"></span>                <span class="ResWord">raise</span> <span class="ID">exc</span>[<span class="Number">1</span>][<span class="Number">0</span>], <span class="ID">exc</span>[<span class="Number">1</span>][<span class="Number">1</span>], <span class="ID">exc</span>[<span class="Number">1</span>][<span class="Number">2</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_30">  30</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_30"></span><span class="anchor" id="line-30-21"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_31">  31</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_31"></span><span class="anchor" id="line-31-20"></span>            <span class="ResWord">return</span> <span class="ID">result</span>[<span class="Number">0</span>]</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_32">  32</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_32"></span><span class="anchor" id="line-32-20"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_33">  33</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_33"></span><span class="anchor" id="line-33-20"></span>        <span class="ID">threading</span>.<span class="ID">Thread</span>(<span class="ID">target</span>=<span class="ID">worker_func</span>).<span class="ID">start</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_34">  34</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_34"></span><span class="anchor" id="line-34-19"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_35">  35</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_35"></span><span class="anchor" id="line-35-18"></span>        <span class="ResWord">return</span> <span class="ID">thunk</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_36">  36</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_36"></span><span class="anchor" id="line-36-18"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_37">  37</a> </span><span class="LineAnchor" id="CA-0ce7ee6fa120bf8d6cd869d8856f12a3448e4348_37"></span><span class="anchor" id="line-37-18"></span>    <span class="ResWord">return</span> <span class="ID">lazy_thunked</span></span>
</pre></div></div><span class="anchor" id="line-2238"></span><p class="line874">Example: <span class="anchor" id="line-2239"></span><span class="anchor" id="line-2240"></span><p class="line867"><span class="anchor" id="line-2241"></span><span class="anchor" id="line-2242"></span><span class="anchor" id="line-2243"></span><span class="anchor" id="line-2244"></span><span class="anchor" id="line-2245"></span><span class="anchor" id="line-2246"></span><span class="anchor" id="line-2247"></span><span class="anchor" id="line-2248"></span><span class="anchor" id="line-2249"></span><span class="anchor" id="line-2250"></span><span class="anchor" id="line-2251"></span><span class="anchor" id="line-2252"></span><span class="anchor" id="line-2253"></span><span class="anchor" id="line-2254"></span><span class="anchor" id="line-2255"></span><span class="anchor" id="line-2256"></span><span class="anchor" id="line-2257"></span><span class="anchor" id="line-2258"></span><span class="anchor" id="line-2259"></span><span class="anchor" id="line-2260"></span><span class="anchor" id="line-2261"></span><span class="anchor" id="line-2262"></span><span class="anchor" id="line-2263"></span><span class="anchor" id="line-2264"></span><span class="anchor" id="line-2265"></span><span class="anchor" id="line-2266"></span><span class="anchor" id="line-1-89"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-d281180b6b02b86f8404f2574851e91889b867fc\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-d281180b6b02b86f8404f2574851e91889b867fc" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_1">   1</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_1"></span><span class="anchor" id="line-1-90"></span><span class="ID">@lazy_thunkify</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_2">   2</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_2"></span><span class="anchor" id="line-2-45"></span><span class="ResWord">def</span> <span class="ID">slow_double</span>(<span class="ID">i</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_3">   3</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_3"></span><span class="anchor" id="line-3-45"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Multiplying...</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_4">   4</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_4"></span><span class="anchor" id="line-4-44"></span>    <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">5</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_5">   5</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_5"></span><span class="anchor" id="line-5-44"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Done multiplying!</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_6">   6</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_6"></span><span class="anchor" id="line-6-44"></span>    <span class="ResWord">return</span> <span class="ID">i</span>*<span class="Number">2</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_7">   7</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_7"></span><span class="anchor" id="line-7-44"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_8">   8</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_8"></span><span class="anchor" id="line-8-43"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_9">   9</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_9"></span><span class="anchor" id="line-9-43"></span><span class="ResWord">def</span> <span class="ID">maybe_multiply</span>(<span class="ID">x</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_10">  10</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_10"></span><span class="anchor" id="line-10-43"></span>    <span class="ID">double_thunk</span> = <span class="ID">slow_double</span>(<span class="ID">x</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_11">  11</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_11"></span><span class="anchor" id="line-11-40"></span>    <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Thinking...</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_12">  12</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_12"></span><span class="anchor" id="line-12-40"></span>    <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">3</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_13">  13</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_13"></span><span class="anchor" id="line-13-39"></span>    <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">3</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_14">  14</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_14"></span><span class="anchor" id="line-14-39"></span>    <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_15">  15</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_15"></span><span class="anchor" id="line-15-39"></span>    <span class="ResWord">if</span> <span class="ID">x</span> == <span class="Number">3</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_16">  16</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_16"></span><span class="anchor" id="line-16-39"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Using it!</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_17">  17</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_17"></span><span class="anchor" id="line-17-38"></span>        <span class="ID">res</span> = <span class="ID">double_thunk</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_18">  18</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_18"></span><span class="anchor" id="line-18-37"></span>    <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_19">  19</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_19"></span><span class="anchor" id="line-19-36"></span>        <span class="ResWord">print</span> <span class="String">&quot;</span><span class="String">Not using it.</span><span class="String">&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_20">  20</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_20"></span><span class="anchor" id="line-20-35"></span>        <span class="ID">res</span> = <span class="ResWord">None</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_21">  21</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_21"></span><span class="anchor" id="line-21-35"></span>    <span class="ResWord">return</span> <span class="ID">res</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_22">  22</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_22"></span><span class="anchor" id="line-22-35"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_23">  23</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_23"></span><span class="anchor" id="line-23-35"></span><span class="Comment">#both take 7 seconds</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_24">  24</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_24"></span><span class="anchor" id="line-24-32"></span><span class="ID">maybe_multiply</span>(<span class="Number">10</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-d281180b6b02b86f8404f2574851e91889b867fc_25">  25</a> </span><span class="LineAnchor" id="CA-d281180b6b02b86f8404f2574851e91889b867fc_25"></span><span class="anchor" id="line-25-32"></span><span class="ID">maybe_multiply</span>(<span class="Number">3</span>)</span>
</pre></div></div><span class="anchor" id="line-2267"></span><p class="line867">
<h2 id="Aggregative_decorators_for_generator_functions">Aggregative decorators for generator functions</h2>
<span class="anchor" id="line-2268"></span><p class="line874">This could be a whole family of decorators. The aim is applying an aggregation function to the iterated outcome of a generator-functions. <span class="anchor" id="line-2269"></span><span class="anchor" id="line-2270"></span><p class="line874">Two interesting aggregators could be sum and average: <span class="anchor" id="line-2271"></span><span class="anchor" id="line-2272"></span><p class="line867"><span class="anchor" id="line-2273"></span><span class="anchor" id="line-2274"></span><span class="anchor" id="line-2275"></span><span class="anchor" id="line-2276"></span><span class="anchor" id="line-2277"></span><span class="anchor" id="line-2278"></span><span class="anchor" id="line-2279"></span><span class="anchor" id="line-2280"></span><span class="anchor" id="line-2281"></span><span class="anchor" id="line-2282"></span><span class="anchor" id="line-2283"></span><span class="anchor" id="line-2284"></span><span class="anchor" id="line-2285"></span><span class="anchor" id="line-2286"></span><span class="anchor" id="line-2287"></span><span class="anchor" id="line-2288"></span><span class="anchor" id="line-1-91"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_1">   1</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_1"></span><span class="anchor" id="line-1-92"></span><span class="ResWord">import</span> <span class="ID">functools</span> <span class="ResWord">as</span> <span class="ID">ft</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_2">   2</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_2"></span><span class="anchor" id="line-2-46"></span><span class="ResWord">import</span> <span class="ID">operator</span> <span class="ResWord">as</span> <span class="ID">op</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_3">   3</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_3"></span><span class="anchor" id="line-3-46"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_4">   4</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_4"></span><span class="anchor" id="line-4-45"></span><span class="ResWord">def</span> <span class="ID">summed</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_5">   5</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_5"></span><span class="anchor" id="line-5-45"></span>  <span class="ResWord">return</span> <span class="ResWord">lambda</span> *<span class="ID">xs</span> : <span class="ResWord">sum</span>(<span class="ID">f</span>(*<span class="ID">xs</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_6">   6</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_6"></span><span class="anchor" id="line-6-45"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_7">   7</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_7"></span><span class="anchor" id="line-7-45"></span><span class="ResWord">def</span> <span class="ID">averaged</span>(<span class="ID">f</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_8">   8</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_8"></span><span class="anchor" id="line-8-44"></span>  <span class="ResWord">def</span> <span class="ID">aux</span>(<span class="ID">acc</span>, <span class="ID">x</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_9">   9</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_9"></span><span class="anchor" id="line-9-44"></span>    <span class="ResWord">return</span> (<span class="ID">acc</span>[<span class="Number">0</span>] + <span class="ID">x</span>, <span class="ID">acc</span>[<span class="Number">1</span>] + <span class="Number">1</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_10">  10</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_10"></span><span class="anchor" id="line-10-44"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_11">  11</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_11"></span><span class="anchor" id="line-11-41"></span>  <span class="ResWord">def</span> <span class="ID">out</span>(*<span class="ID">xs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_12">  12</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_12"></span><span class="anchor" id="line-12-41"></span>    <span class="ID">s</span>, <span class="ID">n</span> = <span class="ID">ft</span>.<span class="ID">reduce</span>(<span class="ID">aux</span>, <span class="ID">f</span>(*<span class="ID">xs</span>), (<span class="Number">0</span>, <span class="Number">0</span>))</span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_13">  13</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_13"></span><span class="anchor" id="line-13-40"></span>    <span class="ResWord">return</span> <span class="ID">s</span> / <span class="ID">n</span> <span class="ResWord">if</span> <span class="ID">n</span> &gt; <span class="Number">0</span> <span class="ResWord">else</span> <span class="Number">0</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_14">  14</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_14"></span><span class="anchor" id="line-14-40"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_15">  15</a> </span><span class="LineAnchor" id="CA-c67d423ae5b5d8cd330fc803eed7f61aeaf4e949_15"></span><span class="anchor" id="line-15-40"></span>  <span class="ResWord">return</span> <span class="ID">out</span></span>
</pre></div></div><span class="anchor" id="line-2289"></span><p class="line874">Examples for the two proposed decorators: <span class="anchor" id="line-2290"></span><span class="anchor" id="line-2291"></span><p class="line867"><span class="anchor" id="line-2292"></span><span class="anchor" id="line-2293"></span><span class="anchor" id="line-2294"></span><span class="anchor" id="line-2295"></span><span class="anchor" id="line-2296"></span><span class="anchor" id="line-2297"></span><span class="anchor" id="line-2298"></span><span class="anchor" id="line-2299"></span><span class="anchor" id="line-2300"></span><span class="anchor" id="line-2301"></span><span class="anchor" id="line-2302"></span><span class="anchor" id="line-2303"></span><span class="anchor" id="line-2304"></span><span class="anchor" id="line-2305"></span><span class="anchor" id="line-2306"></span><span class="anchor" id="line-2307"></span><span class="anchor" id="line-2308"></span><span class="anchor" id="line-2309"></span><span class="anchor" id="line-1-93"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-5fe186ebfb5444134bf443e45e1212b694296132\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-5fe186ebfb5444134bf443e45e1212b694296132" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_1">   1</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_1"></span><span class="anchor" id="line-1-94"></span><span class="ID">@averaged</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_2">   2</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_2"></span><span class="anchor" id="line-2-47"></span><span class="ResWord">def</span> <span class="ID">producer2</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_3">   3</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_3"></span><span class="anchor" id="line-3-47"></span>    <span class="ResWord">yield</span> <span class="Number">10</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_4">   4</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_4"></span><span class="anchor" id="line-4-46"></span>    <span class="ResWord">yield</span> <span class="Number">5</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_5">   5</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_5"></span><span class="anchor" id="line-5-46"></span>    <span class="ResWord">yield</span> <span class="Number">2.5</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_6">   6</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_6"></span><span class="anchor" id="line-6-46"></span>    <span class="ResWord">yield</span> <span class="Number">7.5</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_7">   7</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_7"></span><span class="anchor" id="line-7-46"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_8">   8</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_8"></span><span class="anchor" id="line-8-45"></span><span class="ResWord">assert</span> <span class="ID">producer2</span>() == (<span class="Number">10</span> + <span class="Number">5</span> + <span class="Number">2.5</span> + <span class="Number">7.5</span>) / <span class="Number">4</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_9">   9</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_9"></span><span class="anchor" id="line-9-45"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_10">  10</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_10"></span><span class="anchor" id="line-10-45"></span><span class="ID">@summed</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_11">  11</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_11"></span><span class="anchor" id="line-11-42"></span><span class="ResWord">def</span> <span class="ID">producer1</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_12">  12</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_12"></span><span class="anchor" id="line-12-42"></span>    <span class="ResWord">yield</span> <span class="Number">10</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_13">  13</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_13"></span><span class="anchor" id="line-13-41"></span>    <span class="ResWord">yield</span> <span class="Number">5</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_14">  14</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_14"></span><span class="anchor" id="line-14-41"></span>    <span class="ResWord">yield</span> <span class="Number">2.5</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_15">  15</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_15"></span><span class="anchor" id="line-15-41"></span>    <span class="ResWord">yield</span> <span class="Number">7.5</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_16">  16</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_16"></span><span class="anchor" id="line-16-40"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-5fe186ebfb5444134bf443e45e1212b694296132_17">  17</a> </span><span class="LineAnchor" id="CA-5fe186ebfb5444134bf443e45e1212b694296132_17"></span><span class="anchor" id="line-17-39"></span><span class="ResWord">assert</span> <span class="ID">producer1</span>() == (<span class="Number">10</span> + <span class="Number">5</span> + <span class="Number">2.5</span> + <span class="Number">7.5</span>)</span>
</pre></div></div><span class="anchor" id="line-2310"></span><p class="line867">
<h2 id="Function_Timeout">Function Timeout</h2>
<span class="anchor" id="line-2311"></span><p class="line874">Ever had a function take forever in weird edge cases?  In one case, a function was extracting URIs from a long string using regular expressions, and sometimes it was running into a bug in the Python regexp engine and would take minutes rather than milliseconds.  The best solution was to install a timeout using an alarm signal and simply abort processing.  This can conveniently be wrapped in a decorator: <span class="anchor" id="line-2312"></span><span class="anchor" id="line-2313"></span><p class="line867"><span class="anchor" id="line-2314"></span><span class="anchor" id="line-2315"></span><span class="anchor" id="line-2316"></span><span class="anchor" id="line-2317"></span><span class="anchor" id="line-2318"></span><span class="anchor" id="line-2319"></span><span class="anchor" id="line-2320"></span><span class="anchor" id="line-2321"></span><span class="anchor" id="line-2322"></span><span class="anchor" id="line-2323"></span><span class="anchor" id="line-2324"></span><span class="anchor" id="line-2325"></span><span class="anchor" id="line-2326"></span><span class="anchor" id="line-2327"></span><span class="anchor" id="line-2328"></span><span class="anchor" id="line-2329"></span><span class="anchor" id="line-2330"></span><span class="anchor" id="line-2331"></span><span class="anchor" id="line-2332"></span><span class="anchor" id="line-2333"></span><span class="anchor" id="line-2334"></span><span class="anchor" id="line-2335"></span><span class="anchor" id="line-2336"></span><span class="anchor" id="line-1-95"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_1">   1</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_1"></span><span class="anchor" id="line-1-96"></span><span class="ResWord">import</span> <span class="ID">signal</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_2">   2</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_2"></span><span class="anchor" id="line-2-48"></span><span class="ResWord">import</span> <span class="ID">functools</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_3">   3</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_3"></span><span class="anchor" id="line-3-48"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_4">   4</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_4"></span><span class="anchor" id="line-4-47"></span><span class="ResWord">class</span> <span class="ID">TimeoutError</span>(<span class="ID">Exception</span>): <span class="ResWord">pass</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_5">   5</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_5"></span><span class="anchor" id="line-5-47"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_6">   6</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_6"></span><span class="anchor" id="line-6-47"></span><span class="ResWord">def</span> <span class="ID">timeout</span>(<span class="ID">seconds</span>, <span class="ID">error_message</span> = <span class="String">'</span><span class="String">Function call timed out</span><span class="String">'</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_7">   7</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_7"></span><span class="anchor" id="line-7-47"></span>    <span class="ResWord">def</span> <span class="ID">decorated</span>(<span class="ID">func</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_8">   8</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_8"></span><span class="anchor" id="line-8-46"></span>        <span class="ResWord">def</span> <span class="ID">_handle_timeout</span>(<span class="ID">signum</span>, <span class="ID">frame</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_9">   9</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_9"></span><span class="anchor" id="line-9-46"></span>            <span class="ResWord">raise</span> <span class="ID">TimeoutError</span>(<span class="ID">error_message</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_10">  10</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_10"></span><span class="anchor" id="line-10-46"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_11">  11</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_11"></span><span class="anchor" id="line-11-43"></span>        <span class="ResWord">def</span> <span class="ID">wrapper</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_12">  12</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_12"></span><span class="anchor" id="line-12-43"></span>            <span class="ID">signal</span>.<span class="ID">signal</span>(<span class="ID">signal</span>.<span class="ID">SIGALRM</span>, <span class="ID">_handle_timeout</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_13">  13</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_13"></span><span class="anchor" id="line-13-42"></span>            <span class="ID">signal</span>.<span class="ID">alarm</span>(<span class="ID">seconds</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_14">  14</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_14"></span><span class="anchor" id="line-14-42"></span>            <span class="ResWord">try</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_15">  15</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_15"></span><span class="anchor" id="line-15-42"></span>                <span class="ID">result</span> = <span class="ID">func</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_16">  16</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_16"></span><span class="anchor" id="line-16-41"></span>            <span class="ResWord">finally</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_17">  17</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_17"></span><span class="anchor" id="line-17-40"></span>                <span class="ID">signal</span>.<span class="ID">alarm</span>(<span class="Number">0</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_18">  18</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_18"></span><span class="anchor" id="line-18-38"></span>            <span class="ResWord">return</span> <span class="ID">result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_19">  19</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_19"></span><span class="anchor" id="line-19-37"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_20">  20</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_20"></span><span class="anchor" id="line-20-36"></span>        <span class="ResWord">return</span> <span class="ID">functools</span>.<span class="ID">wraps</span>(<span class="ID">func</span>)(<span class="ID">wrapper</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_21">  21</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_21"></span><span class="anchor" id="line-21-36"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_22">  22</a> </span><span class="LineAnchor" id="CA-f6fc2504eb9d91e2c1444e5864eab811e96d4a78_22"></span><span class="anchor" id="line-22-36"></span>    <span class="ResWord">return</span> <span class="ID">decorated</span></span>
</pre></div></div><span class="anchor" id="line-2337"></span><p class="line874">Example: <span class="anchor" id="line-2338"></span><span class="anchor" id="line-2339"></span><p class="line867"><span class="anchor" id="line-2340"></span><span class="anchor" id="line-2341"></span><span class="anchor" id="line-2342"></span><span class="anchor" id="line-2343"></span><span class="anchor" id="line-2344"></span><span class="anchor" id="line-2345"></span><span class="anchor" id="line-1-97"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-71289694ca71513b85e10997c68b15e7e97f6240\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-71289694ca71513b85e10997c68b15e7e97f6240" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-71289694ca71513b85e10997c68b15e7e97f6240_1">   1</a> </span><span class="LineAnchor" id="CA-71289694ca71513b85e10997c68b15e7e97f6240_1"></span><span class="anchor" id="line-1-98"></span><span class="ResWord">import</span> <span class="ID">time</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-71289694ca71513b85e10997c68b15e7e97f6240_2">   2</a> </span><span class="LineAnchor" id="CA-71289694ca71513b85e10997c68b15e7e97f6240_2"></span><span class="anchor" id="line-2-49"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-71289694ca71513b85e10997c68b15e7e97f6240_3">   3</a> </span><span class="LineAnchor" id="CA-71289694ca71513b85e10997c68b15e7e97f6240_3"></span><span class="anchor" id="line-3-49"></span><span class="ID">@timeout</span>(<span class="Number">1</span>, <span class="String">'</span><span class="String">Function slow; aborted</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-71289694ca71513b85e10997c68b15e7e97f6240_4">   4</a> </span><span class="LineAnchor" id="CA-71289694ca71513b85e10997c68b15e7e97f6240_4"></span><span class="anchor" id="line-4-48"></span><span class="ResWord">def</span> <span class="ID">slow_function</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-71289694ca71513b85e10997c68b15e7e97f6240_5">   5</a> </span><span class="LineAnchor" id="CA-71289694ca71513b85e10997c68b15e7e97f6240_5"></span><span class="anchor" id="line-5-48"></span>    <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">5</span>)</span>
</pre></div></div><span class="anchor" id="line-2346"></span><p class="line867">
<h2 id="Collect_Data_Difference_Caused_by_Decorated_Function">Collect Data Difference Caused by Decorated Function</h2>
<span class="anchor" id="line-2347"></span><p class="line874">It calls a user function to collect some data before and after the decorated function runs. To calculate difference it calls the difference calculator user function. <span class="anchor" id="line-2348"></span><span class="anchor" id="line-2349"></span><p class="line874">Example: checking page numbers of a print job: get the number of all printed pages from printer before and after the printing. Then calculate difference to get the number of pages printed by the the decorated function <span class="anchor" id="line-2350"></span><span class="anchor" id="line-2351"></span><p class="line867"><span class="anchor" id="line-2352"></span><span class="anchor" id="line-2353"></span><span class="anchor" id="line-2354"></span><span class="anchor" id="line-2355"></span><span class="anchor" id="line-2356"></span><span class="anchor" id="line-2357"></span><span class="anchor" id="line-2358"></span><span class="anchor" id="line-2359"></span><span class="anchor" id="line-2360"></span><span class="anchor" id="line-2361"></span><span class="anchor" id="line-2362"></span><span class="anchor" id="line-2363"></span><span class="anchor" id="line-2364"></span><span class="anchor" id="line-2365"></span><span class="anchor" id="line-2366"></span><span class="anchor" id="line-2367"></span><span class="anchor" id="line-2368"></span><span class="anchor" id="line-2369"></span><span class="anchor" id="line-2370"></span><span class="anchor" id="line-2371"></span><span class="anchor" id="line-2372"></span><span class="anchor" id="line-2373"></span><span class="anchor" id="line-2374"></span><span class="anchor" id="line-2375"></span><span class="anchor" id="line-2376"></span><span class="anchor" id="line-2377"></span><span class="anchor" id="line-2378"></span><span class="anchor" id="line-2379"></span><span class="anchor" id="line-2380"></span><span class="anchor" id="line-2381"></span><span class="anchor" id="line-2382"></span><span class="anchor" id="line-2383"></span><span class="anchor" id="line-2384"></span><span class="anchor" id="line-2385"></span><span class="anchor" id="line-2386"></span><span class="anchor" id="line-2387"></span><span class="anchor" id="line-2388"></span><span class="anchor" id="line-2389"></span><span class="anchor" id="line-2390"></span><span class="anchor" id="line-2391"></span><span class="anchor" id="line-2392"></span><span class="anchor" id="line-2393"></span><span class="anchor" id="line-2394"></span><span class="anchor" id="line-2395"></span><span class="anchor" id="line-2396"></span><span class="anchor" id="line-2397"></span><span class="anchor" id="line-2398"></span><span class="anchor" id="line-2399"></span><span class="anchor" id="line-2400"></span><span class="anchor" id="line-2401"></span><span class="anchor" id="line-2402"></span><span class="anchor" id="line-2403"></span><span class="anchor" id="line-2404"></span><span class="anchor" id="line-2405"></span><span class="anchor" id="line-2406"></span><span class="anchor" id="line-2407"></span><span class="anchor" id="line-2408"></span><span class="anchor" id="line-2409"></span><span class="anchor" id="line-2410"></span><span class="anchor" id="line-2411"></span><span class="anchor" id="line-2412"></span><span class="anchor" id="line-2413"></span><span class="anchor" id="line-2414"></span><span class="anchor" id="line-2415"></span><span class="anchor" id="line-2416"></span><span class="anchor" id="line-2417"></span><span class="anchor" id="line-2418"></span><span class="anchor" id="line-2419"></span><span class="anchor" id="line-2420"></span><span class="anchor" id="line-2421"></span><span class="anchor" id="line-2422"></span><span class="anchor" id="line-2423"></span><span class="anchor" id="line-2424"></span><span class="anchor" id="line-2425"></span><span class="anchor" id="line-2426"></span><span class="anchor" id="line-2427"></span><span class="anchor" id="line-2428"></span><span class="anchor" id="line-2429"></span><span class="anchor" id="line-2430"></span><span class="anchor" id="line-2431"></span><span class="anchor" id="line-2432"></span><span class="anchor" id="line-2433"></span><span class="anchor" id="line-2434"></span><span class="anchor" id="line-2435"></span><span class="anchor" id="line-2436"></span><span class="anchor" id="line-2437"></span><span class="anchor" id="line-2438"></span><span class="anchor" id="line-2439"></span><span class="anchor" id="line-2440"></span><span class="anchor" id="line-2441"></span><span class="anchor" id="line-2442"></span><span class="anchor" id="line-2443"></span><span class="anchor" id="line-2444"></span><span class="anchor" id="line-2445"></span><span class="anchor" id="line-2446"></span><span class="anchor" id="line-2447"></span><span class="anchor" id="line-2448"></span><span class="anchor" id="line-2449"></span><span class="anchor" id="line-2450"></span><span class="anchor" id="line-2451"></span><span class="anchor" id="line-1-99"></span><div class="highlight python"><div class="codearea" dir="ltr" lang="en">
<script type="text/javascript">
document.write('<a href="#" onclick="return togglenumber(\'CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1\', 1, 1);" \
                class="codenumbers">Toggle line numbers<\/a>');
</script>
<pre dir="ltr" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1" lang="en"><span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_1">   1</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_1"></span><span class="anchor" id="line-1-100"></span><span class="ResWord">import</span> <span class="ID">inspect</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_2">   2</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_2"></span><span class="anchor" id="line-2-50"></span><span class="Comment"># Just in case you want to use the name of the decorator instead of difference calculator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_3">   3</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_3"></span><span class="anchor" id="line-3-50"></span><span class="Comment"># But in that case if the function decorated  more than once the collected difference will be overwritten</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_4">   4</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_4"></span><span class="anchor" id="line-4-49"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_5">   5</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_5"></span><span class="anchor" id="line-5-49"></span><span class="ResWord">import</span> <span class="ID">time</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_6">   6</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_6"></span><span class="anchor" id="line-6-48"></span><span class="Comment"># Demo purposes only, the difference will be generated from time</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_7">   7</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_7"></span><span class="anchor" id="line-7-48"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_8">   8</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_8"></span><span class="anchor" id="line-8-47"></span><span class="ResWord">from</span> <span class="ID">functools</span> <span class="ResWord">import</span> <span class="ID">wraps</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_9">   9</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_9"></span><span class="anchor" id="line-9-47"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_10">  10</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_10"></span><span class="anchor" id="line-10-47"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_11">  11</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_11"></span><span class="anchor" id="line-11-44"></span><span class="ResWord">def</span> <span class="ID">collect_data_and_calculate_difference</span>(<span class="ID">data_collector</span>, <span class="ID">difference_calculator</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_12">  12</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_12"></span><span class="anchor" id="line-12-44"></span>    <span class="String">&quot;&quot;&quot;Returns difference of data collected before and after the decorated function,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_13">  13</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_13"></span><span class="anchor" id="line-13-43"></span><span class="String">    plus the original return value of the decorated function. Return type: dict.</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_14">  14</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_14"></span><span class="anchor" id="line-14-43"></span><span class="String">    Keys:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_15">  15</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_15"></span><span class="anchor" id="line-15-43"></span><span class="String">        - function name of the decorated function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_16">  16</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_16"></span><span class="anchor" id="line-16-42"></span><span class="String">        - name of the difference calculator function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_17">  17</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_17"></span><span class="anchor" id="line-17-41"></span><span class="String">    Values:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_18">  18</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_18"></span><span class="anchor" id="line-18-39"></span><span class="String">        - the original return value of decorated function</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_19">  19</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_19"></span><span class="anchor" id="line-19-38"></span><span class="String">        - difference calculated by difference_calculator functions</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_20">  20</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_20"></span><span class="anchor" id="line-20-37"></span><span class="String">    Parameters: functions to collect data, and create difference from collected data</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_21">  21</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_21"></span><span class="anchor" id="line-21-37"></span><span class="String"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_22">  22</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_22"></span><span class="anchor" id="line-22-37"></span><span class="String">    Created: 2017</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_23">  23</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_23"></span><span class="anchor" id="line-23-36"></span><span class="String">    Author: George Fischhof</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_24">  24</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_24"></span><span class="anchor" id="line-24-33"></span><span class="String">    &quot;&quot;&quot;</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_25">  25</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_25"></span><span class="anchor" id="line-25-33"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_26">  26</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_26"></span><span class="anchor" id="line-26-30"></span>    <span class="ID">current_decorator_function_name</span> = <span class="ID">inspect</span>.<span class="ID">currentframe</span>().<span class="ID">f_code</span>.<span class="ID">co_name</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_27">  27</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_27"></span><span class="anchor" id="line-27-27"></span>    <span class="Comment"># Just in case you want to use it</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_28">  28</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_28"></span><span class="anchor" id="line-28-25"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_29">  29</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_29"></span><span class="anchor" id="line-29-24"></span>    <span class="ResWord">def</span> <span class="ID">function_wrapper_because_of_parameters</span>(<span class="ID">decorated_function</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_30">  30</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_30"></span><span class="anchor" id="line-30-22"></span>        <span class="ID">difference_calculator_name</span> = <span class="ID">difference_calculator</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_31">  31</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_31"></span><span class="anchor" id="line-31-21"></span>        <span class="ID">decorated_function_name</span> = <span class="ID">decorated_function</span>.<span class="ID">__name__</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_32">  32</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_32"></span><span class="anchor" id="line-32-21"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_33">  33</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_33"></span><span class="anchor" id="line-33-21"></span>        <span class="ID">i_am_the_first_decorator</span> = <span class="ResWord">not</span> <span class="ResWord">hasattr</span>(<span class="ID">decorated_function</span>, <span class="String">'</span><span class="String">__wrapped__</span><span class="String">'</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_34">  34</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_34"></span><span class="anchor" id="line-34-20"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_35">  35</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_35"></span><span class="anchor" id="line-35-19"></span>        <span class="ID">@wraps</span>(<span class="ID">decorated_function</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_36">  36</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_36"></span><span class="anchor" id="line-36-19"></span>        <span class="ResWord">def</span> <span class="ID">wrapper</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>) -&gt; <span class="ResWord">dict</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_37">  37</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_37"></span><span class="anchor" id="line-37-19"></span>            <span class="ID">result_dict</span> = <span class="ResWord">dict</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_38">  38</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_38"></span><span class="anchor" id="line-38-17"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_39">  39</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_39"></span><span class="anchor" id="line-39-17"></span>            <span class="ID">before</span> = <span class="ID">data_collector</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_40">  40</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_40"></span><span class="anchor" id="line-40-17"></span>            <span class="ID">original_result</span> = <span class="ID">decorated_function</span>(*<span class="ID">args</span>, **<span class="ID">kwargs</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_41">  41</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_41"></span><span class="anchor" id="line-41-15"></span>            <span class="ID">after</span> = <span class="ID">data_collector</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_42">  42</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_42"></span><span class="anchor" id="line-42-13"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_43">  43</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_43"></span><span class="anchor" id="line-43-13"></span>            <span class="ID">my_collection</span> = <span class="ID">difference_calculator</span>(<span class="ID">before</span>=<span class="ID">before</span>, <span class="ID">after</span>=<span class="ID">after</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_44">  44</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_44"></span><span class="anchor" id="line-44-12"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_45">  45</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_45"></span><span class="anchor" id="line-45-12"></span>            <span class="ID">i_am_not_first_decorator_but_first_is_similar_to_me</span> = (</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_46">  46</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_46"></span><span class="anchor" id="line-46-12"></span>                <span class="ResWord">not</span> <span class="ID">i_am_the_first_decorator</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_47">  47</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_47"></span><span class="anchor" id="line-47-12"></span>                <span class="ResWord">and</span> <span class="ResWord">isinstance</span>(<span class="ID">original_result</span>, <span class="ResWord">dict</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_48">  48</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_48"></span><span class="anchor" id="line-48-11"></span>                <span class="ResWord">and</span> (<span class="ID">decorated_function_name</span> <span class="ResWord">in</span> <span class="ID">original_result</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_49">  49</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_49"></span><span class="anchor" id="line-49-11"></span>            )</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_50">  50</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_50"></span><span class="anchor" id="line-50-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_51">  51</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_51"></span><span class="anchor" id="line-51-10"></span>            <span class="ResWord">if</span> <span class="ID">i_am_not_first_decorator_but_first_is_similar_to_me</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_52">  52</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_52"></span><span class="anchor" id="line-52-10"></span>                <span class="ID">original_result</span>[<span class="ID">difference_calculator_name</span>] = <span class="ID">my_collection</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_53">  53</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_53"></span><span class="anchor" id="line-53-10"></span>                <span class="ResWord">return</span> <span class="ID">original_result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_54">  54</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_54"></span><span class="anchor" id="line-54-10"></span>            <span class="ResWord">else</span>:</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_55">  55</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_55"></span><span class="anchor" id="line-55-10"></span>                <span class="ID">result_dict</span>[<span class="ID">decorated_function_name</span>] = <span class="ID">original_result</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_56">  56</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_56"></span><span class="anchor" id="line-56-10"></span>                <span class="ID">result_dict</span>[<span class="ID">difference_calculator_name</span>] = <span class="ID">my_collection</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_57">  57</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_57"></span><span class="anchor" id="line-57-10"></span>                <span class="ResWord">return</span> <span class="ID">result_dict</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_58">  58</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_58"></span><span class="anchor" id="line-58-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_59">  59</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_59"></span><span class="anchor" id="line-59-10"></span>        <span class="ResWord">return</span> <span class="ID">wrapper</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_60">  60</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_60"></span><span class="anchor" id="line-60-10"></span>    <span class="ResWord">return</span> <span class="ID">function_wrapper_because_of_parameters</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_61">  61</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_61"></span><span class="anchor" id="line-61-10"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_62">  62</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_62"></span><span class="anchor" id="line-62-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_63">  63</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_63"></span><span class="anchor" id="line-63-9"></span><span class="Comment"># Usage</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_64">  64</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_64"></span><span class="anchor" id="line-64-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_65">  65</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_65"></span><span class="anchor" id="line-65-9"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_66">  66</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_66"></span><span class="anchor" id="line-66-9"></span><span class="ResWord">def</span> <span class="ID">collect_data_or_data_series_a</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_67">  67</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_67"></span><span class="anchor" id="line-67-9"></span>    <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">0.5</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_68">  68</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_68"></span><span class="anchor" id="line-68-9"></span>    <span class="ResWord">return</span> <span class="ID">time</span>.<span class="ID">time</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_69">  69</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_69"></span><span class="anchor" id="line-69-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_70">  70</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_70"></span><span class="anchor" id="line-70-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_71">  71</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_71"></span><span class="anchor" id="line-71-8"></span><span class="ResWord">def</span> <span class="ID">collect_data_or_data_series_b</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_72">  72</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_72"></span><span class="anchor" id="line-72-8"></span>    <span class="ID">time</span>.<span class="ID">sleep</span>(<span class="Number">0.5</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_73">  73</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_73"></span><span class="anchor" id="line-73-8"></span>    <span class="ResWord">return</span> <span class="ID">time</span>.<span class="ID">time</span>()</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_74">  74</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_74"></span><span class="anchor" id="line-74-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_75">  75</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_75"></span><span class="anchor" id="line-75-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_76">  76</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_76"></span><span class="anchor" id="line-76-8"></span><span class="ResWord">def</span> <span class="ID">calculate_difference_on_data_series_a</span>(<span class="ID">before</span>, <span class="ID">after</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_77">  77</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_77"></span><span class="anchor" id="line-77-8"></span>    <span class="ResWord">return</span> <span class="ID">after</span> - <span class="ID">before</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_78">  78</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_78"></span><span class="anchor" id="line-78-8"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_79">  79</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_79"></span><span class="anchor" id="line-79-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_80">  80</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_80"></span><span class="anchor" id="line-80-7"></span><span class="ResWord">def</span> <span class="ID">calculate_difference_on_data_series_b</span>(<span class="ID">before</span>, <span class="ID">after</span>):</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_81">  81</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_81"></span><span class="anchor" id="line-81-7"></span>    <span class="ResWord">return</span> <span class="ID">after</span> - <span class="ID">before</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_82">  82</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_82"></span><span class="anchor" id="line-82-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_83">  83</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_83"></span><span class="anchor" id="line-83-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_84">  84</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_84"></span><span class="anchor" id="line-84-7"></span><span class="ID">@collect_data_and_calculate_difference</span>(</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_85">  85</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_85"></span><span class="anchor" id="line-85-7"></span>    <span class="ID">data_collector</span>=<span class="ID">collect_data_or_data_series_a</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_86">  86</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_86"></span><span class="anchor" id="line-86-7"></span>    <span class="ID">difference_calculator</span>=<span class="ID">calculate_difference_on_data_series_a</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_87">  87</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_87"></span><span class="anchor" id="line-87-7"></span><span class="ID">@collect_data_and_calculate_difference</span>(</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_88">  88</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_88"></span><span class="anchor" id="line-88-7"></span>    <span class="ID">data_collector</span>=<span class="ID">collect_data_or_data_series_b</span>,</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_89">  89</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_89"></span><span class="anchor" id="line-89-7"></span>    <span class="ID">difference_calculator</span>=<span class="ID">calculate_difference_on_data_series_b</span>)</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_90">  90</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_90"></span><span class="anchor" id="line-90-7"></span><span class="ResWord">def</span> <span class="ID">do_something_that_changes_the_collected_data</span>():</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_91">  91</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_91"></span><span class="anchor" id="line-91-7"></span>    <span class="ResWord">return</span> <span class="String">'</span><span class="String">result of decorated function...</span><span class="String">'</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_92">  92</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_92"></span><span class="anchor" id="line-92-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_93">  93</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_93"></span><span class="anchor" id="line-93-7"></span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_94">  94</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_94"></span><span class="anchor" id="line-94-7"></span><span class="ResWord">print</span>(<span class="ID">do_something_that_changes_the_collected_data</span>())</span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_95">  95</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_95"></span><span class="anchor" id="line-95-7"></span><span class="Comment"># result dict:</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_96">  96</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_96"></span><span class="anchor" id="line-96-7"></span><span class="Comment"># {'calculate_difference_on_data_series_a': 1.5010299682617188,</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_97">  97</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_97"></span><span class="anchor" id="line-97-7"></span><span class="Comment"># 'do_something_that_changes_the_collected_data': 'result of decorated function...',</span></span>
<span class="line"><span class="LineNumber"><a href="#CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_98">  98</a> </span><span class="LineAnchor" id="CA-e89b72f7e78284f4c2565e57cb6f345f1e7b8bf1_98"></span><span class="anchor" id="line-98-7"></span><span class="Comment"># 'calculate_difference_on_data_series_b': 0.5001623630523682}</span></span>
</pre></div></div><span class="anchor" id="line-2452"></span><p class="line867"><hr /><p class="line874"> <span class="anchor" id="line-2453"></span><a href="/moin/CategoryDocumentation">CategoryDocumentation</a> <span class="anchor" id="line-2454"></span><span class="anchor" id="bottom"></span></div><p id="pageinfo" class="info" lang="en" dir="ltr">PythonDecoratorLibrary  (last edited 2017-07-04 09:44:35 by <span title="mjpieters @ 199.201.66.3[199.201.66.3]"><a class="nonexistent" href="/moin/mjpieters" title="mjpieters @ 199.201.66.3[199.201.66.3]">mjpieters</a></span>)</p>

<div id="pagebottom"></div>
</div>


<div id="footer">
<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>
<p style="text-align: center; font-size: 85%"><a href="/moin/FrontPage#use">Unable to edit the page? See the FrontPage for instructions.</a></p></body>
</html>

